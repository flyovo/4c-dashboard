{"remainingRequest":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/id-repair/Documents/SEOL/4c-dashboard/src/layout/components/Navbar/CountDown.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/src/layout/components/Navbar/CountDown.vue","mtime":1618208154000},{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKaW1wb3J0IGRlZmF1bHRTZXR0aW5ncyBmcm9tICdAL3NldHRpbmdzJwppbXBvcnQgeyBDb21wb25lbnQsIFZ1ZSwgV2F0Y2ggfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJwppbXBvcnQgeyBTZXR0aW5nc01vZHVsZSB9IGZyb20gJ0Avc3RvcmUvbW9kdWxlcy9zZXR0aW5ncy9zdG9yZScKaW1wb3J0IHsgVXNlclN0b3JlTW9kdWxlIH0gZnJvbSAnQC9zdG9yZS9tb2R1bGVzL3VzZXIvc3RvcmUnCmltcG9ydCB7IExvYWRpbmcgfSBmcm9tICdlbGVtZW50LXVpJwpAQ29tcG9uZW50KHsKICBuYW1lOiAnQ291bnREb3duJwp9KQpleHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIFZ1ZSB7CiAgcHJpdmF0ZSBzZWxlY3RlZFRpbWU6IG51bWJlciA9IDAKICBwcml2YXRlIHRpbWVMZWZ0OiBzdHJpbmcgPSAnMDA6MDAnCiAgcHJpdmF0ZSBlbmRUaW1lOiBzdHJpbmcgfCBudW1iZXIgPSAnMCcKICBwcml2YXRlIGludGVydmFsVGltZXI6IGFueQogIHByaXZhdGUgc3RhdHVzOiBib29sZWFuID0gZmFsc2UKCiAgZ2V0IGxvZ2luVGltZSgpIHsKICAgIHJldHVybiBTZXR0aW5nc01vZHVsZS5sb2dpblRpbWUKICB9CgogIGdldCBsb2dpblRpbWVTdGF0dXMoKSB7CiAgICByZXR1cm4gU2V0dGluZ3NNb2R1bGUubG9naW5UaW1lU3RhdHVzCiAgfQoKICBAV2F0Y2goJ2xvZ2luVGltZVN0YXR1cycsIHsgZGVlcDogdHJ1ZSB9KQogIHByaXZhdGUgY2hhbmdlVGltZXIodmFsdWUpIHsKICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkgewogICAgICB0aGlzLnNldFRpbWUoZGVmYXVsdFNldHRpbmdzLmxvZ2luVGltZSkKICAgICAgY29uc3QgdmFsdWUgPSBmYWxzZQogICAgICBTZXR0aW5nc01vZHVsZS5DaGFuZ2VTZXR0aW5nKHsga2V5OiAnbG9naW5UaW1lU3RhdHVzJywgdmFsdWUgfSkKICAgIH0KICB9CgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnNldFRpbWUodGhpcy5sb2dpblRpbWUpCiAgfQogIC8qKiBNZXRob2RzICovCiAgcHVibGljIHJlc2V0QnRuKCkgewogICAgdGhpcy5zZXRUaW1lKHRoaXMubG9naW5UaW1lKQogIH0KICBwcml2YXRlIHNldFRpbWUoc2Vjb25kcykgewogICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsVGltZXIpCiAgICB0aGlzLnRpbWVyKHNlY29uZHMpCiAgfQogIHByaXZhdGUgdGltZXIoc2Vjb25kcykgewogICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKQogICAgY29uc3QgZW5kID0gbm93ICsgc2Vjb25kcyAqIDEwMDAKICAgIHRoaXMuZGlzcGxheVRpbWVMZWZ0KHNlY29uZHMpCiAgICB0aGlzLnNlbGVjdGVkVGltZSA9IHNlY29uZHMKICAgIHRoaXMuZGlzcGxheUVuZFRpbWUoZW5kKQogICAgdGhpcy5jb3VudGRvd24oZW5kKQogIH0KCiAgcHJpdmF0ZSBjb3VudGRvd24oZW5kKSB7CiAgICB0aGlzLmludGVydmFsVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgIGNvbnN0IHNlY29uZHNMZWZ0ID0gTWF0aC5yb3VuZCgoZW5kIC0gRGF0ZS5ub3coKSkgLyAxMDAwKQogICAgICBpZiAoc2Vjb25kc0xlZnQpIHsKICAgICAgICB0aGlzLmVuZFRpbWUgPSAwCiAgICAgIH0KICAgICAgaWYgKHNlY29uZHNMZWZ0IDwgMCkgewogICAgICAgIC8vIFRpbWVvdXQgZW5kCiAgICAgICAgdGhpcy5sb2dvdXQoKQogICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbFRpbWVyKQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICAgIHRoaXMuZGlzcGxheVRpbWVMZWZ0KHNlY29uZHNMZWZ0KQogICAgfSwgMTAwMCkKICB9CiAgcHJpdmF0ZSBkaXNwbGF5VGltZUxlZnQoc2Vjb25kc0xlZnQpIHsKICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKChzZWNvbmRzTGVmdCAlIDM2MDApIC8gNjApCiAgICBjb25zdCBzZWNvbmRzID0gc2Vjb25kc0xlZnQgJSA2MAogICAgdGhpcy50aW1lTGVmdCA9IHRoaXMuemVyb1BhZGRlZChtaW51dGVzKSArICc6JyArIHRoaXMuemVyb1BhZGRlZChzZWNvbmRzKQogIH0KICBwcml2YXRlIGRpc3BsYXlFbmRUaW1lKHRpbWVzdGFtcCkgewogICAgY29uc3QgZW5kID0gbmV3IERhdGUodGltZXN0YW1wKQogICAgY29uc3QgaG91ciA9IGVuZC5nZXRIb3VycygpCiAgICBjb25zdCBtaW51dGVzID0gZW5kLmdldE1pbnV0ZXMoKQogICAgdGhpcy5lbmRUaW1lID0gdGhpcy5ob3VyQ29udmVydChob3VyKSArICc6JyArIHRoaXMuemVyb1BhZGRlZChtaW51dGVzKQogIH0KICBwcml2YXRlIHplcm9QYWRkZWQobnVtKSB7CiAgICByZXR1cm4gbnVtIDwgMTAgPyBgMCR7bnVtfWAgOiBudW0KICB9CiAgcHJpdmF0ZSBob3VyQ29udmVydChob3VyKSB7CiAgICByZXR1cm4gaG91ciAlIDEyIHx8IDEyCiAgfQogIHByaXZhdGUgYXN5bmMgbG9nb3V0KCkgewogICAgYXdhaXQgVXNlclN0b3JlTW9kdWxlLkxvZ291dCgpCgogICAgdGhpcy4kcm91dGVyLnB1c2goYC9sb2dpbj9yZWRpcmVjdD0ke3RoaXMuJHJvdXRlLmZ1bGxQYXRofWApCiAgICBsZXQgbG9hZGluZzogYW55CiAgICBsb2FkaW5nID0gTG9hZGluZy5zZXJ2aWNlKHsKICAgICAgZnVsbHNjcmVlbjogdHJ1ZSwKICAgICAgdGV4dDogJ0xvYWRpbmcnLAogICAgICBzcGlubmVyOiAnZWwtaWNvbi1sb2FkaW5nJywKICAgICAgYmFja2dyb3VuZDogJ3JnYmEoMCwgMCwgMCwgMC43KScKICAgIH0pCiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpCiAgICB9LCAxMDApCiAgfQp9Cg=="},{"version":3,"sources":["CountDown.vue"],"names":[],"mappings":";;;;;;;;;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CountDown.vue","sourceRoot":"src/layout/components/Navbar","sourcesContent":["<template>\n  <div>\n    <el-button type=\"text\" plain icon=\"el-icon-time\" style=\"width: 100px;\" @click.native=\"resetBtn\">\n      {{ timeLeft }}\n    </el-button>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport defaultSettings from '@/settings'\nimport { Component, Vue, Watch } from 'vue-property-decorator'\nimport { SettingsModule } from '@/store/modules/settings/store'\nimport { UserStoreModule } from '@/store/modules/user/store'\nimport { Loading } from 'element-ui'\n@Component({\n  name: 'CountDown'\n})\nexport default class extends Vue {\n  private selectedTime: number = 0\n  private timeLeft: string = '00:00'\n  private endTime: string | number = '0'\n  private intervalTimer: any\n  private status: boolean = false\n\n  get loginTime() {\n    return SettingsModule.loginTime\n  }\n\n  get loginTimeStatus() {\n    return SettingsModule.loginTimeStatus\n  }\n\n  @Watch('loginTimeStatus', { deep: true })\n  private changeTimer(value) {\n    if (value === true) {\n      this.setTime(defaultSettings.loginTime)\n      const value = false\n      SettingsModule.ChangeSetting({ key: 'loginTimeStatus', value })\n    }\n  }\n\n  created() {\n    this.setTime(this.loginTime)\n  }\n  /** Methods */\n  public resetBtn() {\n    this.setTime(this.loginTime)\n  }\n  private setTime(seconds) {\n    clearInterval(this.intervalTimer)\n    this.timer(seconds)\n  }\n  private timer(seconds) {\n    const now = Date.now()\n    const end = now + seconds * 1000\n    this.displayTimeLeft(seconds)\n    this.selectedTime = seconds\n    this.displayEndTime(end)\n    this.countdown(end)\n  }\n\n  private countdown(end) {\n    this.intervalTimer = setInterval(() => {\n      const secondsLeft = Math.round((end - Date.now()) / 1000)\n      if (secondsLeft) {\n        this.endTime = 0\n      }\n      if (secondsLeft < 0) {\n        // Timeout end\n        this.logout()\n        clearInterval(this.intervalTimer)\n        return false\n      }\n      this.displayTimeLeft(secondsLeft)\n    }, 1000)\n  }\n  private displayTimeLeft(secondsLeft) {\n    const minutes = Math.floor((secondsLeft % 3600) / 60)\n    const seconds = secondsLeft % 60\n    this.timeLeft = this.zeroPadded(minutes) + ':' + this.zeroPadded(seconds)\n  }\n  private displayEndTime(timestamp) {\n    const end = new Date(timestamp)\n    const hour = end.getHours()\n    const minutes = end.getMinutes()\n    this.endTime = this.hourConvert(hour) + ':' + this.zeroPadded(minutes)\n  }\n  private zeroPadded(num) {\n    return num < 10 ? `0${num}` : num\n  }\n  private hourConvert(hour) {\n    return hour % 12 || 12\n  }\n  private async logout() {\n    await UserStoreModule.Logout()\n\n    this.$router.push(`/login?redirect=${this.$route.fullPath}`)\n    let loading: any\n    loading = Loading.service({\n      fullscreen: true,\n      text: 'Loading',\n      spinner: 'el-icon-loading',\n      background: 'rgba(0, 0, 0, 0.7)'\n    })\n    setTimeout(() => {\n      window.location.reload()\n    }, 100)\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped></style>\n"]}]}