{"remainingRequest":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/babel-loader/lib/index.js!/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/echarts/lib/util/graphic.js","dependencies":[{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/echarts/lib/util/graphic.js","mtime":499162500000},{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbGwuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiKTsKCi8qCiogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZQoqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQoqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uCiogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQoqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKKiAiTGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoqCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKKgoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywKKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbgoqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQoqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQoqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMKKiB1bmRlciB0aGUgTGljZW5zZS4KKi8KdmFyIHpyVXRpbCA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2NvcmUvdXRpbCIpOwoKdmFyIHBhdGhUb29sID0gcmVxdWlyZSgienJlbmRlci9saWIvdG9vbC9wYXRoIik7Cgp2YXIgY29sb3JUb29sID0gcmVxdWlyZSgienJlbmRlci9saWIvdG9vbC9jb2xvciIpOwoKdmFyIG1hdHJpeCA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2NvcmUvbWF0cml4Iik7Cgp2YXIgdmVjdG9yID0gcmVxdWlyZSgienJlbmRlci9saWIvY29yZS92ZWN0b3IiKTsKCnZhciBQYXRoID0gcmVxdWlyZSgienJlbmRlci9saWIvZ3JhcGhpYy9QYXRoIik7Cgp2YXIgVHJhbnNmb3JtYWJsZSA9IHJlcXVpcmUoInpyZW5kZXIvbGliL21peGluL1RyYW5zZm9ybWFibGUiKTsKCnZhciBaSW1hZ2UgPSByZXF1aXJlKCJ6cmVuZGVyL2xpYi9ncmFwaGljL0ltYWdlIik7CgpleHBvcnRzLkltYWdlID0gWkltYWdlOwoKdmFyIEdyb3VwID0gcmVxdWlyZSgienJlbmRlci9saWIvY29udGFpbmVyL0dyb3VwIik7CgpleHBvcnRzLkdyb3VwID0gR3JvdXA7Cgp2YXIgVGV4dCA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2dyYXBoaWMvVGV4dCIpOwoKZXhwb3J0cy5UZXh0ID0gVGV4dDsKCnZhciBDaXJjbGUgPSByZXF1aXJlKCJ6cmVuZGVyL2xpYi9ncmFwaGljL3NoYXBlL0NpcmNsZSIpOwoKZXhwb3J0cy5DaXJjbGUgPSBDaXJjbGU7Cgp2YXIgU2VjdG9yID0gcmVxdWlyZSgienJlbmRlci9saWIvZ3JhcGhpYy9zaGFwZS9TZWN0b3IiKTsKCmV4cG9ydHMuU2VjdG9yID0gU2VjdG9yOwoKdmFyIFJpbmcgPSByZXF1aXJlKCJ6cmVuZGVyL2xpYi9ncmFwaGljL3NoYXBlL1JpbmciKTsKCmV4cG9ydHMuUmluZyA9IFJpbmc7Cgp2YXIgUG9seWdvbiA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2dyYXBoaWMvc2hhcGUvUG9seWdvbiIpOwoKZXhwb3J0cy5Qb2x5Z29uID0gUG9seWdvbjsKCnZhciBQb2x5bGluZSA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2dyYXBoaWMvc2hhcGUvUG9seWxpbmUiKTsKCmV4cG9ydHMuUG9seWxpbmUgPSBQb2x5bGluZTsKCnZhciBSZWN0ID0gcmVxdWlyZSgienJlbmRlci9saWIvZ3JhcGhpYy9zaGFwZS9SZWN0Iik7CgpleHBvcnRzLlJlY3QgPSBSZWN0OwoKdmFyIExpbmUgPSByZXF1aXJlKCJ6cmVuZGVyL2xpYi9ncmFwaGljL3NoYXBlL0xpbmUiKTsKCmV4cG9ydHMuTGluZSA9IExpbmU7Cgp2YXIgQmV6aWVyQ3VydmUgPSByZXF1aXJlKCJ6cmVuZGVyL2xpYi9ncmFwaGljL3NoYXBlL0JlemllckN1cnZlIik7CgpleHBvcnRzLkJlemllckN1cnZlID0gQmV6aWVyQ3VydmU7Cgp2YXIgQXJjID0gcmVxdWlyZSgienJlbmRlci9saWIvZ3JhcGhpYy9zaGFwZS9BcmMiKTsKCmV4cG9ydHMuQXJjID0gQXJjOwoKdmFyIENvbXBvdW5kUGF0aCA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2dyYXBoaWMvQ29tcG91bmRQYXRoIik7CgpleHBvcnRzLkNvbXBvdW5kUGF0aCA9IENvbXBvdW5kUGF0aDsKCnZhciBMaW5lYXJHcmFkaWVudCA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2dyYXBoaWMvTGluZWFyR3JhZGllbnQiKTsKCmV4cG9ydHMuTGluZWFyR3JhZGllbnQgPSBMaW5lYXJHcmFkaWVudDsKCnZhciBSYWRpYWxHcmFkaWVudCA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2dyYXBoaWMvUmFkaWFsR3JhZGllbnQiKTsKCmV4cG9ydHMuUmFkaWFsR3JhZGllbnQgPSBSYWRpYWxHcmFkaWVudDsKCnZhciBCb3VuZGluZ1JlY3QgPSByZXF1aXJlKCJ6cmVuZGVyL2xpYi9jb3JlL0JvdW5kaW5nUmVjdCIpOwoKZXhwb3J0cy5Cb3VuZGluZ1JlY3QgPSBCb3VuZGluZ1JlY3Q7Cgp2YXIgSW5jcmVtZW50YWxEaXNwbGF5YWJsZSA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2dyYXBoaWMvSW5jcmVtZW50YWxEaXNwbGF5YWJsZSIpOwoKZXhwb3J0cy5JbmNyZW1lbnRhbERpc3BsYXlhYmxlID0gSW5jcmVtZW50YWxEaXNwbGF5YWJsZTsKCnZhciBzdWJQaXhlbE9wdGltaXplVXRpbCA9IHJlcXVpcmUoInpyZW5kZXIvbGliL2dyYXBoaWMvaGVscGVyL3N1YlBpeGVsT3B0aW1pemUiKTsKLyoKKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lCiogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24KKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlCiogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQoqICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UKKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CioKKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoqCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAoqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiogIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucwoqIHVuZGVyIHRoZSBMaWNlbnNlLgoqLwoKCnZhciBtYXRoTWF4ID0gTWF0aC5tYXg7CnZhciBtYXRoTWluID0gTWF0aC5taW47CnZhciBFTVBUWV9PQkogPSB7fTsKdmFyIFoyX0VNUEhBU0lTX0xJRlQgPSAxOyAvLyBrZXk6IGxhYmVsIG1vZGVsIHByb3BlcnR5IG5hbmUsIHZhbHVlOiBzdHlsZSBwcm9wZXJ0eSBuYW1lLgoKdmFyIENBQ0hFRF9MQUJFTF9TVFlMRV9QUk9QRVJUSUVTID0gewogIGNvbG9yOiAndGV4dEZpbGwnLAogIHRleHRCb3JkZXJDb2xvcjogJ3RleHRTdHJva2UnLAogIHRleHRCb3JkZXJXaWR0aDogJ3RleHRTdHJva2VXaWR0aCcKfTsKdmFyIEVNUEhBU0lTID0gJ2VtcGhhc2lzJzsKdmFyIE5PUk1BTCA9ICdub3JtYWwnOyAvLyBSZXNlcnZlIDAgYXMgZGVmYXVsdC4KCnZhciBfaGlnaGxpZ2h0TmV4dERpZ2l0ID0gMTsKdmFyIF9oaWdobGlnaHRLZXlNYXAgPSB7fTsKdmFyIF9jdXN0b21TaGFwZU1hcCA9IHt9OwovKioKICogRXh0ZW5kIHNoYXBlIHdpdGggcGFyYW1ldGVycwogKi8KCmZ1bmN0aW9uIGV4dGVuZFNoYXBlKG9wdHMpIHsKICByZXR1cm4gUGF0aC5leHRlbmQob3B0cyk7Cn0KLyoqCiAqIEV4dGVuZCBwYXRoCiAqLwoKCmZ1bmN0aW9uIGV4dGVuZFBhdGgocGF0aERhdGEsIG9wdHMpIHsKICByZXR1cm4gcGF0aFRvb2wuZXh0ZW5kRnJvbVN0cmluZyhwYXRoRGF0YSwgb3B0cyk7Cn0KLyoqCiAqIFJlZ2lzdGVyIGEgdXNlciBkZWZpbmVkIHNoYXBlLgogKiBUaGUgc2hhcGUgY2xhc3MgY2FuIGJlIGZldGNoZWQgYnkgYGdldFNoYXBlQ2xhc3NgCiAqIFRoaXMgbWV0aG9kIHdpbGwgb3ZlcndyaXRlIHRoZSByZWdpc3RlcmVkIHNoYXBlcywgaW5jbHVkaW5nCiAqIHRoZSByZWdpc3RlcmVkIGJ1aWx0LWluIHNoYXBlcywgaWYgdXNpbmcgdGhlIHNhbWUgYG5hbWVgLgogKiBUaGUgc2hhcGUgY2FuIGJlIHVzZWQgaW4gYGN1c3RvbSBzZXJpZXNgIGFuZAogKiBgZ3JhcGhpYyBjb21wb25lbnRgIGJ5IGRlY2xhcmluZyBge3R5cGU6IG5hbWV9YC4KICoKICogQHBhcmFtIHtzdHJpbmd9IG5hbWUKICogQHBhcmFtIHtPYmplY3R9IFNoYXBlQ2xhc3MgQ2FuIGJlIGdlbmVyYXRlZCBieSBgZXh0ZW5kU2hhcGVgLgogKi8KCgpmdW5jdGlvbiByZWdpc3RlclNoYXBlKG5hbWUsIFNoYXBlQ2xhc3MpIHsKICBfY3VzdG9tU2hhcGVNYXBbbmFtZV0gPSBTaGFwZUNsYXNzOwp9Ci8qKgogKiBGaW5kIHNoYXBlIGNsYXNzIHJlZ2lzdGVyZWQgYnkgYHJlZ2lzdGVyU2hhcGVgLiBVc3VhbGx5IHVzZWQgaW4KICogZmV0Y2hpbmcgdXNlciBkZWZpbmVkIHNoYXBlLgogKgogKiBbQ2F1dGlvbl06CiAqICgxKSBUaGlzIG1ldGhvZCAqKk1VU1QgTk9UIGJlIHVzZWQgaW5zaWRlIGVjaGFydHMgISEhKiosIHVubGVzcyBpdCBpcyBwcmVwYXJlZAogKiB0byB1c2UgdXNlciByZWdpc3RlcmVkIHNoYXBlcy4KICogQmVjYXVzZSB0aGUgYnVpbHQtaW4gc2hhcGUgKHNlZSBgZ2V0QnVpbHRJblNoYXBlYCkgd2lsbCBiZSByZWdpc3RlcmVkIGJ5CiAqIGByZWdpc3RlclNoYXBlYCBieSBkZWZhdWx0LiBUaGF0IGVuYWJsZXMgdXNlcnMgdG8gZ2V0IGJvdGggYnVpbHQtaW4KICogc2hhcGVzIGFzIHdlbGwgYXMgdGhlIHNoYXBlcyBiZWxvbmdpbmcgdG8gdGhlbXNsZXZlcy4gQnV0IHVzZXJzIGNhbiBvdmVyd3JpdGUKICogdGhlIGJ1aWx0LWluIHNoYXBlcyBieSB1c2luZyBuYW1lcyBsaWtlICdjaXJjbGUnLCAncmVjdCcgdmlhIGNhbGxpbmcKICogYHJlZ2lzdGVyU2hhcGVgLiBTbyB0aGUgZWNoYXJ0cyBpbm5lciBmZWF0cnVlcyBzaG91bGQgbm90IGZldGNoIHNoYXBlcyBmcm9tIGhlcmUKICogaW4gY2FzZSB0aGF0IGl0IGlzIG92ZXJ3cml0dGVuIGJ5IHVzZXJzLCBleGNlcHQgdGhhdCBzb21lIGZlYXR1cmVzLCBsaWtlCiAqIGBjdXN0b20gc2VyaWVzYCwgYGdyYXBoaWMgY29tcG9uZW50YCwgZG8gaXQgZGVsaWJlcmF0ZWx5LgogKgogKiAoMikgSW4gdGhlIGZlYXR1cmVzIGxpa2UgYGN1c3RvbSBzZXJpZXNgLCBgZ3JhcGhpYyBjb21wb25lbnRgLCB0aGUgdXNlciBpbnB1dAogKiBge3RweWU6ICd4eHgnfWAgZG9lcyBub3Qgb25seSBzcGVjaWZ5IHNoYXBlcyBidXQgYWxzbyBzcGVjaWZ5IG90aGVyIGdyYXBoaWMKICogZWxlbWVudHMgbGlrZSBgJ2dyb3VwJ2AsIGAndGV4dCdgLCBgJ2ltYWdlJ2Agb3IgZXZlbnQgYCdwYXRoJ2AuIFRob3NlIG5hbWVzCiAqIGFyZSByZXNlcnZlZCBuYW1lcywgdGhhdCBpcywgaWYgc29tZSB1c2VyIHJlZ2lzdGVyIGEgc2hhcGUgbmFtZWQgYCdpbWFnZSdgLAogKiB0aGUgc2hhcGUgd2lsbCBub3QgYmUgdXNlZC4gSWYgd2UgaW50ZW5kaW5nIHRvIGFkZCBzb21lIG1vcmUgcmVzZXJ2ZWQgbmFtZXMKICogaW4gZmVhdHVyZSwgdGhhdCBtaWdodCBicmluZyBicmVhayBjaGFuZ2VzIChkaXNhYmxlIHNvbWUgZXhpc3RpbmcgdXNlciBzaGFwZQogKiBuYW1lcykuIEJ1dCB0aGF0IGNhc2UgcHJvYmFibHkgcmVhcmx5IGhhcHBlbi4gU28gd2UgZG9udCBtYWtlIG1vcmUgbWVjaGFuaXNtCiAqIHRvIHJlc29sdmUgdGhpcyBpc3N1ZSBoZXJlLgogKgogKiBAcGFyYW0ge3N0cmluZ30gbmFtZQogKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBzaGFwZSBjbGFzcy4gSWYgbm90IGZvdW5kLCByZXR1cm4gbm90aGluZy4KICovCgoKZnVuY3Rpb24gZ2V0U2hhcGVDbGFzcyhuYW1lKSB7CiAgaWYgKF9jdXN0b21TaGFwZU1hcC5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgcmV0dXJuIF9jdXN0b21TaGFwZU1hcFtuYW1lXTsKICB9Cn0KLyoqCiAqIENyZWF0ZSBhIHBhdGggZWxlbWVudCBmcm9tIHBhdGggZGF0YSBzdHJpbmcKICogQHBhcmFtIHtzdHJpbmd9IHBhdGhEYXRhCiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzCiAqIEBwYXJhbSB7bW9kdWxlOnpyZW5kZXIvY29yZS9Cb3VuZGluZ1JlY3R9IHJlY3QKICogQHBhcmFtIHtzdHJpbmd9IFtsYXlvdXQ9Y292ZXJdICdjZW50ZXInIG9yICdjb3ZlcicKICovCgoKZnVuY3Rpb24gbWFrZVBhdGgocGF0aERhdGEsIG9wdHMsIHJlY3QsIGxheW91dCkgewogIHZhciBwYXRoID0gcGF0aFRvb2wuY3JlYXRlRnJvbVN0cmluZyhwYXRoRGF0YSwgb3B0cyk7CgogIGlmIChyZWN0KSB7CiAgICBpZiAobGF5b3V0ID09PSAnY2VudGVyJykgewogICAgICByZWN0ID0gY2VudGVyR3JhcGhpYyhyZWN0LCBwYXRoLmdldEJvdW5kaW5nUmVjdCgpKTsKICAgIH0KCiAgICByZXNpemVQYXRoKHBhdGgsIHJlY3QpOwogIH0KCiAgcmV0dXJuIHBhdGg7Cn0KLyoqCiAqIENyZWF0ZSBhIGltYWdlIGVsZW1lbnQgZnJvbSBpbWFnZSB1cmwKICogQHBhcmFtIHtzdHJpbmd9IGltYWdlVXJsIGltYWdlIHVybAogKiBAcGFyYW0ge09iamVjdH0gb3B0cyBvcHRpb25zCiAqIEBwYXJhbSB7bW9kdWxlOnpyZW5kZXIvY29yZS9Cb3VuZGluZ1JlY3R9IHJlY3QgY29uc3RyYWluIHJlY3QKICogQHBhcmFtIHtzdHJpbmd9IFtsYXlvdXQ9Y292ZXJdICdjZW50ZXInIG9yICdjb3ZlcicKICovCgoKZnVuY3Rpb24gbWFrZUltYWdlKGltYWdlVXJsLCByZWN0LCBsYXlvdXQpIHsKICB2YXIgcGF0aCA9IG5ldyBaSW1hZ2UoewogICAgc3R5bGU6IHsKICAgICAgaW1hZ2U6IGltYWdlVXJsLAogICAgICB4OiByZWN0LngsCiAgICAgIHk6IHJlY3QueSwKICAgICAgd2lkdGg6IHJlY3Qud2lkdGgsCiAgICAgIGhlaWdodDogcmVjdC5oZWlnaHQKICAgIH0sCiAgICBvbmxvYWQ6IGZ1bmN0aW9uIG9ubG9hZChpbWcpIHsKICAgICAgaWYgKGxheW91dCA9PT0gJ2NlbnRlcicpIHsKICAgICAgICB2YXIgYm91bmRpbmdSZWN0ID0gewogICAgICAgICAgd2lkdGg6IGltZy53aWR0aCwKICAgICAgICAgIGhlaWdodDogaW1nLmhlaWdodAogICAgICAgIH07CiAgICAgICAgcGF0aC5zZXRTdHlsZShjZW50ZXJHcmFwaGljKHJlY3QsIGJvdW5kaW5nUmVjdCkpOwogICAgICB9CiAgICB9CiAgfSk7CiAgcmV0dXJuIHBhdGg7Cn0KLyoqCiAqIEdldCBwb3NpdGlvbiBvZiBjZW50ZXJlZCBlbGVtZW50IGluIGJvdW5kaW5nIGJveC4KICoKICogQHBhcmFtICB7T2JqZWN0fSByZWN0ICAgICAgICAgZWxlbWVudCBsb2NhbCBib3VuZGluZyBib3gKICogQHBhcmFtICB7T2JqZWN0fSBib3VuZGluZ1JlY3QgY29uc3RyYWludCBib3VuZGluZyBib3gKICogQHJldHVybiB7T2JqZWN0fSBlbGVtZW50IHBvc2l0aW9uIGNvbnRhaW5pbmcgeCwgeSwgd2lkdGgsIGFuZCBoZWlnaHQKICovCgoKZnVuY3Rpb24gY2VudGVyR3JhcGhpYyhyZWN0LCBib3VuZGluZ1JlY3QpIHsKICAvLyBTZXQgcmVjdCB0byBjZW50ZXIsIGtlZXAgd2lkdGggLyBoZWlnaHQgcmF0aW8uCiAgdmFyIGFzcGVjdCA9IGJvdW5kaW5nUmVjdC53aWR0aCAvIGJvdW5kaW5nUmVjdC5oZWlnaHQ7CiAgdmFyIHdpZHRoID0gcmVjdC5oZWlnaHQgKiBhc3BlY3Q7CiAgdmFyIGhlaWdodDsKCiAgaWYgKHdpZHRoIDw9IHJlY3Qud2lkdGgpIHsKICAgIGhlaWdodCA9IHJlY3QuaGVpZ2h0OwogIH0gZWxzZSB7CiAgICB3aWR0aCA9IHJlY3Qud2lkdGg7CiAgICBoZWlnaHQgPSB3aWR0aCAvIGFzcGVjdDsKICB9CgogIHZhciBjeCA9IHJlY3QueCArIHJlY3Qud2lkdGggLyAyOwogIHZhciBjeSA9IHJlY3QueSArIHJlY3QuaGVpZ2h0IC8gMjsKICByZXR1cm4gewogICAgeDogY3ggLSB3aWR0aCAvIDIsCiAgICB5OiBjeSAtIGhlaWdodCAvIDIsCiAgICB3aWR0aDogd2lkdGgsCiAgICBoZWlnaHQ6IGhlaWdodAogIH07Cn0KCnZhciBtZXJnZVBhdGggPSBwYXRoVG9vbC5tZXJnZVBhdGg7Ci8qKgogKiBSZXNpemUgYSBwYXRoIHRvIGZpdCB0aGUgcmVjdAogKiBAcGFyYW0ge21vZHVsZTp6cmVuZGVyL2dyYXBoaWMvUGF0aH0gcGF0aAogKiBAcGFyYW0ge09iamVjdH0gcmVjdAogKi8KCmZ1bmN0aW9uIHJlc2l6ZVBhdGgocGF0aCwgcmVjdCkgewogIGlmICghcGF0aC5hcHBseVRyYW5zZm9ybSkgewogICAgcmV0dXJuOwogIH0KCiAgdmFyIHBhdGhSZWN0ID0gcGF0aC5nZXRCb3VuZGluZ1JlY3QoKTsKICB2YXIgbSA9IHBhdGhSZWN0LmNhbGN1bGF0ZVRyYW5zZm9ybShyZWN0KTsKICBwYXRoLmFwcGx5VHJhbnNmb3JtKG0pOwp9Ci8qKgogKiBTdWIgcGl4ZWwgb3B0aW1pemUgbGluZSBmb3IgY2FudmFzCiAqCiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbQogKiBAcGFyYW0ge09iamVjdH0gW3BhcmFtLnNoYXBlXQogKiBAcGFyYW0ge251bWJlcn0gW3BhcmFtLnNoYXBlLngxXQogKiBAcGFyYW0ge251bWJlcn0gW3BhcmFtLnNoYXBlLnkxXQogKiBAcGFyYW0ge251bWJlcn0gW3BhcmFtLnNoYXBlLngyXQogKiBAcGFyYW0ge251bWJlcn0gW3BhcmFtLnNoYXBlLnkyXQogKiBAcGFyYW0ge09iamVjdH0gW3BhcmFtLnN0eWxlXQogKiBAcGFyYW0ge251bWJlcn0gW3BhcmFtLnN0eWxlLmxpbmVXaWR0aF0KICogQHJldHVybiB7T2JqZWN0fSBNb2RpZmllZCBwYXJhbQogKi8KCgpmdW5jdGlvbiBzdWJQaXhlbE9wdGltaXplTGluZShwYXJhbSkgewogIHN1YlBpeGVsT3B0aW1pemVVdGlsLnN1YlBpeGVsT3B0aW1pemVMaW5lKHBhcmFtLnNoYXBlLCBwYXJhbS5zaGFwZSwgcGFyYW0uc3R5bGUpOwogIHJldHVybiBwYXJhbTsKfQovKioKICogU3ViIHBpeGVsIG9wdGltaXplIHJlY3QgZm9yIGNhbnZhcwogKgogKiBAcGFyYW0ge09iamVjdH0gcGFyYW0KICogQHBhcmFtIHtPYmplY3R9IFtwYXJhbS5zaGFwZV0KICogQHBhcmFtIHtudW1iZXJ9IFtwYXJhbS5zaGFwZS54XQogKiBAcGFyYW0ge251bWJlcn0gW3BhcmFtLnNoYXBlLnldCiAqIEBwYXJhbSB7bnVtYmVyfSBbcGFyYW0uc2hhcGUud2lkdGhdCiAqIEBwYXJhbSB7bnVtYmVyfSBbcGFyYW0uc2hhcGUuaGVpZ2h0XQogKiBAcGFyYW0ge09iamVjdH0gW3BhcmFtLnN0eWxlXQogKiBAcGFyYW0ge251bWJlcn0gW3BhcmFtLnN0eWxlLmxpbmVXaWR0aF0KICogQHJldHVybiB7T2JqZWN0fSBNb2RpZmllZCBwYXJhbQogKi8KCgpmdW5jdGlvbiBzdWJQaXhlbE9wdGltaXplUmVjdChwYXJhbSkgewogIHN1YlBpeGVsT3B0aW1pemVVdGlsLnN1YlBpeGVsT3B0aW1pemVSZWN0KHBhcmFtLnNoYXBlLCBwYXJhbS5zaGFwZSwgcGFyYW0uc3R5bGUpOwogIHJldHVybiBwYXJhbTsKfQovKioKICogU3ViIHBpeGVsIG9wdGltaXplIGZvciBjYW52YXMKICoKICogQHBhcmFtIHtudW1iZXJ9IHBvc2l0aW9uIENvb3JkaW5hdGUsIHN1Y2ggYXMgeCwgeQogKiBAcGFyYW0ge251bWJlcn0gbGluZVdpZHRoIFNob3VsZCBiZSBub25uZWdhdGl2ZSBpbnRlZ2VyLgogKiBAcGFyYW0ge2Jvb2xlYW49fSBwb3NpdGl2ZU9yTmVnYXRpdmUgRGVmYXVsdCBmYWxzZSAobmVnYXRpdmUpLgogKiBAcmV0dXJuIHtudW1iZXJ9IE9wdGltaXplZCBwb3NpdGlvbi4KICovCgoKdmFyIHN1YlBpeGVsT3B0aW1pemUgPSBzdWJQaXhlbE9wdGltaXplVXRpbC5zdWJQaXhlbE9wdGltaXplOwoKZnVuY3Rpb24gaGFzRmlsbE9yU3Ryb2tlKGZpbGxPclN0cm9rZSkgewogIHJldHVybiBmaWxsT3JTdHJva2UgIT0gbnVsbCAmJiBmaWxsT3JTdHJva2UgIT09ICdub25lJzsKfSAvLyBNb3N0IGxpZnRlZCBjb2xvciBhcmUgZHVwbGljYXRlZC4KCgp2YXIgbGlmdGVkQ29sb3JNYXAgPSB6clV0aWwuY3JlYXRlSGFzaE1hcCgpOwp2YXIgbGlmdGVkQ29sb3JDb3VudCA9IDA7CgpmdW5jdGlvbiBsaWZ0Q29sb3IoY29sb3IpIHsKICBpZiAodHlwZW9mIGNvbG9yICE9PSAnc3RyaW5nJykgewogICAgcmV0dXJuIGNvbG9yOwogIH0KCiAgdmFyIGxpZnRlZENvbG9yID0gbGlmdGVkQ29sb3JNYXAuZ2V0KGNvbG9yKTsKCiAgaWYgKCFsaWZ0ZWRDb2xvcikgewogICAgbGlmdGVkQ29sb3IgPSBjb2xvclRvb2wubGlmdChjb2xvciwgLTAuMSk7CgogICAgaWYgKGxpZnRlZENvbG9yQ291bnQgPCAxMDAwMCkgewogICAgICBsaWZ0ZWRDb2xvck1hcC5zZXQoY29sb3IsIGxpZnRlZENvbG9yKTsKICAgICAgbGlmdGVkQ29sb3JDb3VudCsrOwogICAgfQogIH0KCiAgcmV0dXJuIGxpZnRlZENvbG9yOwp9CgpmdW5jdGlvbiBjYWNoZUVsZW1lbnRTdGwoZWwpIHsKICBpZiAoIWVsLl9faG92ZXJTdGxEaXJ0eSkgewogICAgcmV0dXJuOwogIH0KCiAgZWwuX19ob3ZlclN0bERpcnR5ID0gZmFsc2U7CiAgdmFyIGhvdmVyU3R5bGUgPSBlbC5fX2hvdmVyU3RsOwoKICBpZiAoIWhvdmVyU3R5bGUpIHsKICAgIGVsLl9fY2FjaGVkTm9ybWFsU3RsID0gZWwuX19jYWNoZWROb3JtYWxaMiA9IG51bGw7CiAgICByZXR1cm47CiAgfQoKICB2YXIgbm9ybWFsU3R5bGUgPSBlbC5fX2NhY2hlZE5vcm1hbFN0bCA9IHt9OwogIGVsLl9fY2FjaGVkTm9ybWFsWjIgPSBlbC56MjsKICB2YXIgZWxTdHlsZSA9IGVsLnN0eWxlOwoKICBmb3IgKHZhciBuYW1lIGluIGhvdmVyU3R5bGUpIHsKICAgIC8vIFNlZSBjb21tZW50IGluIGBzaW5nbGVFbnRlckVtcGhhc2lzYC4KICAgIGlmIChob3ZlclN0eWxlW25hbWVdICE9IG51bGwpIHsKICAgICAgbm9ybWFsU3R5bGVbbmFtZV0gPSBlbFN0eWxlW25hbWVdOwogICAgfQogIH0gLy8gQWx3YXlzIGNhY2hlIGZpbGwgYW5kIHN0cm9rZSB0byBub3JtYWxTdHlsZSBmb3IgbGlmdGluZyBjb2xvci4KCgogIG5vcm1hbFN0eWxlLmZpbGwgPSBlbFN0eWxlLmZpbGw7CiAgbm9ybWFsU3R5bGUuc3Ryb2tlID0gZWxTdHlsZS5zdHJva2U7Cn0KCmZ1bmN0aW9uIHNpbmdsZUVudGVyRW1waGFzaXMoZWwpIHsKICB2YXIgaG92ZXJTdGwgPSBlbC5fX2hvdmVyU3RsOwoKICBpZiAoIWhvdmVyU3RsIHx8IGVsLl9faGlnaGxpZ2h0ZWQpIHsKICAgIHJldHVybjsKICB9CgogIHZhciB6ciA9IGVsLl9fenI7CiAgdmFyIHVzZUhvdmVyTGF5ZXIgPSBlbC51c2VIb3ZlckxheWVyICYmIHpyICYmIHpyLnBhaW50ZXIudHlwZSA9PT0gJ2NhbnZhcyc7CiAgZWwuX19oaWdobGlnaHRlZCA9IHVzZUhvdmVyTGF5ZXIgPyAnbGF5ZXInIDogJ3BsYWluJzsKCiAgaWYgKGVsLmlzR3JvdXAgfHwgIXpyICYmIGVsLnVzZUhvdmVyTGF5ZXIpIHsKICAgIHJldHVybjsKICB9CgogIHZhciBlbFRhcmdldCA9IGVsOwogIHZhciB0YXJnZXRTdHlsZSA9IGVsLnN0eWxlOwoKICBpZiAodXNlSG92ZXJMYXllcikgewogICAgZWxUYXJnZXQgPSB6ci5hZGRIb3ZlcihlbCk7CiAgICB0YXJnZXRTdHlsZSA9IGVsVGFyZ2V0LnN0eWxlOwogIH0KCiAgcm9sbGJhY2tEZWZhdWx0VGV4dFN0eWxlKHRhcmdldFN0eWxlKTsKCiAgaWYgKCF1c2VIb3ZlckxheWVyKSB7CiAgICBjYWNoZUVsZW1lbnRTdGwoZWxUYXJnZXQpOwogIH0gLy8gc3R5bGVzIGNhbiBiZToKICAvLyB7CiAgLy8gICAgbGFiZWw6IHsKICAvLyAgICAgICAgc2hvdzogZmFsc2UsCiAgLy8gICAgICAgIHBvc2l0aW9uOiAnb3V0c2lkZScsCiAgLy8gICAgICAgIGZvbnRTaXplOiAxOAogIC8vICAgIH0sCiAgLy8gICAgZW1waGFzaXM6IHsKICAvLyAgICAgICAgbGFiZWw6IHsKICAvLyAgICAgICAgICAgIHNob3c6IHRydWUKICAvLyAgICAgICAgfQogIC8vICAgIH0KICAvLyB9LAogIC8vIHdoZXJlIHByb3BlcnRpZXMgb2YgYGVtcGhhc2lzYCBtYXkgbm90IGFwcGVhciBpbiBgbm9ybWFsYC4gV2UgcHJldmlvdXNseSB1c2UKICAvLyBtb2R1bGU6ZWNoYXJ0cy91dGlsL21vZGVsI2RlZmF1bHRFbXBoYXNpcyB0byBtZXJnZSBgbm9ybWFsYCB0byBgZW1waGFzaXNgLgogIC8vIEJ1dCBjb25zaWRlciByaWNoIHRleHQgYW5kIHNldE9wdGlvbiBpbiBtZXJnZSBtb2RlLCBpdCBpcyBpbXBvc3NpYmxlIHRvIGNvdmVyCiAgLy8gYWxsIHByb3BlcnRpZXMgaW4gbWVyZ2UuIFNvIHdlIHVzZSBtZXJnZSBtb2RlIHdoZW4gc2V0dGluZyBzdHlsZSBoZXJlLgogIC8vIEJ1dCB3ZSBjaG9vc2UgdGhlIG1lcmdlIHN0cmF0ZWd5IHRoYXQgb25seSBwcm9wZXJ0aWVzIHRoYXQgaXMgbm90IGBudWxsL3VuZGVmaW5lZGAuCiAgLy8gQmVjYXVzZSB3aGVuIG1ha2luZyBhIHRleHRTdHlsZSAoZXNwYWNpYWxseSByaWNoIHRleHQpLCBpdCBpcyBub3QgZWFzeSB0byBkaXN0aW5ndWlzaAogIC8vIGBoYXNPd25Qcm9wZXJ0eWAgYW5kIGBudWxsL3VuZGVmaW5lZGAgaW4gY29kZSwgc28gd2UgdHJhZGUgdGhlbSBhcyB0aGUgc2FtZSBmb3Igc2ltcGxpY2l0eS4KICAvLyBCdXQgdGhpcyBzdHJhdGVneSBicmluZ3MgYSB0cm91YmxlIHRoYXQgYG51bGwvdW5kZWZpbmVkYCBjYW4gbm90IGJlIHVzZWQgdG8gcmVtb3ZlCiAgLy8gc3R5bGUgYW55IG1vcmUgaW4gYGVtcGhhc2lzYC4gVXNlcnMgY2FuIGJvdGggc2V0IHByb3BlcnRpZXMgZGlyZWN0bHkgb24gbm9ybWFsIGFuZAogIC8vIGVtcGhhc2lzIHRvIGF2b2lkIHRoaXMgaXNzdWUsIG9yIHdlIG1pZ2h0IHN1cHBvcnQgYCdub25lJ2AgZm9yIHRoaXMgY2FzZSBpZiByZXF1aXJlZC4KCgogIHRhcmdldFN0eWxlLmV4dGVuZEZyb20oaG92ZXJTdGwpOwogIHNldERlZmF1bHRIb3ZlckZpbGxTdHJva2UodGFyZ2V0U3R5bGUsIGhvdmVyU3RsLCAnZmlsbCcpOwogIHNldERlZmF1bHRIb3ZlckZpbGxTdHJva2UodGFyZ2V0U3R5bGUsIGhvdmVyU3RsLCAnc3Ryb2tlJyk7CiAgYXBwbHlEZWZhdWx0VGV4dFN0eWxlKHRhcmdldFN0eWxlKTsKCiAgaWYgKCF1c2VIb3ZlckxheWVyKSB7CiAgICBlbC5kaXJ0eShmYWxzZSk7CiAgICBlbC56MiArPSBaMl9FTVBIQVNJU19MSUZUOwogIH0KfQoKZnVuY3Rpb24gc2V0RGVmYXVsdEhvdmVyRmlsbFN0cm9rZSh0YXJnZXRTdHlsZSwgaG92ZXJTdHlsZSwgcHJvcCkgewogIGlmICghaGFzRmlsbE9yU3Ryb2tlKGhvdmVyU3R5bGVbcHJvcF0pICYmIGhhc0ZpbGxPclN0cm9rZSh0YXJnZXRTdHlsZVtwcm9wXSkpIHsKICAgIHRhcmdldFN0eWxlW3Byb3BdID0gbGlmdENvbG9yKHRhcmdldFN0eWxlW3Byb3BdKTsKICB9Cn0KCmZ1bmN0aW9uIHNpbmdsZUVudGVyTm9ybWFsKGVsKSB7CiAgdmFyIGhpZ2hsaWdodGVkID0gZWwuX19oaWdobGlnaHRlZDsKCiAgaWYgKCFoaWdobGlnaHRlZCkgewogICAgcmV0dXJuOwogIH0KCiAgZWwuX19oaWdobGlnaHRlZCA9IGZhbHNlOwoKICBpZiAoZWwuaXNHcm91cCkgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKGhpZ2hsaWdodGVkID09PSAnbGF5ZXInKSB7CiAgICBlbC5fX3pyICYmIGVsLl9fenIucmVtb3ZlSG92ZXIoZWwpOwogIH0gZWxzZSB7CiAgICB2YXIgc3R5bGUgPSBlbC5zdHlsZTsKICAgIHZhciBub3JtYWxTdGwgPSBlbC5fX2NhY2hlZE5vcm1hbFN0bDsKCiAgICBpZiAobm9ybWFsU3RsKSB7CiAgICAgIHJvbGxiYWNrRGVmYXVsdFRleHRTdHlsZShzdHlsZSk7CiAgICAgIGVsLnNldFN0eWxlKG5vcm1hbFN0bCk7CiAgICAgIGFwcGx5RGVmYXVsdFRleHRTdHlsZShzdHlsZSk7CiAgICB9IC8vIGBfX2NhY2hlZE5vcm1hbFoyYCB3aWxsIG5vdCBiZSByZXNldCBpZiBjYWxsaW5nIGBzZXRFbGVtZW50SG92ZXJTdHlsZWAKICAgIC8vIHdoZW4gYGVsYCBpcyBvbiBlbXBoYXNpcyBzdGF0ZS4gU28gaGVyZSBieSBjb21wYXJpbmcgd2l0aCAxLCB3ZSB0cnkKICAgIC8vIGhhcmQgdG8gbWFrZSB0aGUgYnVnIGNhc2UgcmFyZS4KCgogICAgdmFyIG5vcm1hbFoyID0gZWwuX19jYWNoZWROb3JtYWxaMjsKCiAgICBpZiAobm9ybWFsWjIgIT0gbnVsbCAmJiBlbC56MiAtIG5vcm1hbFoyID09PSBaMl9FTVBIQVNJU19MSUZUKSB7CiAgICAgIGVsLnoyID0gbm9ybWFsWjI7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiB0cmF2ZXJzZVVwZGF0ZShlbCwgdXBkYXRlciwgY29tbW9uUGFyYW0pIHsKICAvLyBJZiByb290IGlzIGdyb3VwLCBhbHNvIGVudGVyIHVwZGF0ZXIgZm9yIGBoaWdoRG93bk9uVXBkYXRlYC4KICB2YXIgZnJvbVN0YXRlID0gTk9STUFMOwogIHZhciB0b1N0YXRlID0gTk9STUFMOwogIHZhciB0cmlnZ2VyOyAvLyBTZWUgdGhlIHJ1bGUgb2YgYGhpZ2hEb3duT25VcGRhdGVgIG9uIGBncmFwaGljLnNldEFzSGlnaERvd25EaXNwYXRjaGVyYC4KCiAgZWwuX19oaWdobGlnaHRlZCAmJiAoZnJvbVN0YXRlID0gRU1QSEFTSVMsIHRyaWdnZXIgPSB0cnVlKTsKICB1cGRhdGVyKGVsLCBjb21tb25QYXJhbSk7CiAgZWwuX19oaWdobGlnaHRlZCAmJiAodG9TdGF0ZSA9IEVNUEhBU0lTLCB0cmlnZ2VyID0gdHJ1ZSk7CiAgZWwuaXNHcm91cCAmJiBlbC50cmF2ZXJzZShmdW5jdGlvbiAoY2hpbGQpIHsKICAgICFjaGlsZC5pc0dyb3VwICYmIHVwZGF0ZXIoY2hpbGQsIGNvbW1vblBhcmFtKTsKICB9KTsKICB0cmlnZ2VyICYmIGVsLl9faGlnaERvd25PblVwZGF0ZSAmJiBlbC5fX2hpZ2hEb3duT25VcGRhdGUoZnJvbVN0YXRlLCB0b1N0YXRlKTsKfQovKioKICogU2V0IGhvdmVyIHN0eWxlIChuYW1lbHkgImVtcGhhc2lzIHN0eWxlIikgb2YgZWxlbWVudCwgYmFzZWQgb24gdGhlIGN1cnJlbnQKICogc3R5bGUgb2YgdGhlIGdpdmVuIGBlbGAuCiAqIFRoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgYWxsIG9mIHRoZSBub3JtYWwgc3R5bGVzIGhhdmUgYmVlbiBhZG9wdGVkCiAqIHRvIHRoZSBgZWxgLiBTZWUgdGhlIHJlYXNvbiBvbiBgc2V0SG92ZXJTdHlsZWAuCiAqCiAqIEBwYXJhbSB7bW9kdWxlOnpyZW5kZXIvRWxlbWVudH0gZWwgU2hvdWxkIG5vdCBiZSBgenJlbmRlci9jb250YWluZXIvR3JvdXBgLgogKiBAcGFyYW0ge09iamVjdH0gW2VsLmhvdmVyU3R5bGVdIENhbiBiZSBzZXQgb24gZWwgb3IgaXRzIGRlc2NlbmRhbnRzLAogKiAgICAgICAgZS5nLiwgYGVsLmhvdmVyU3R5bGUgPSAuLi47IGdyYXBoaWMuc2V0SG92ZXJTdHlsZShlbCk7IGAuCiAqICAgICAgICBPZnRlbiB1c2VkIHdoZW4gaXRlbSBncm91cCBoYXMgYSBsYWJlbCBlbGVtZW50IGFuZCBpdCdzIGhvdmVyU3R5bGUgaXMgZGlmZmVyZW50LgogKiBAcGFyYW0ge09iamVjdHxib29sZWFufSBbaG92ZXJTdGxdIFRoZSBzcGVjaWZpZWQgaG92ZXIgc3R5bGUuCiAqICAgICAgICBJZiBzZXQgYXMgYGZhbHNlYCwgZGlzYWJsZSB0aGUgaG92ZXIgc3R5bGUuCiAqICAgICAgICBTaW1pbGFybHksIFRoZSBgZWwuaG92ZXJTdHlsZWAgY2FuIGFsc2UgYmUgc2V0CiAqICAgICAgICBhcyBgZmFsc2VgIHRvIGRpc2FibGUgdGhlIGhvdmVyIHN0eWxlLgogKiAgICAgICAgT3RoZXJ3aXNlLCB1c2UgdGhlIGRlZmF1bHQgaG92ZXIgc3R5bGUgaWYgbm90IHByb3ZpZGVkLgogKi8KCgpmdW5jdGlvbiBzZXRFbGVtZW50SG92ZXJTdHlsZShlbCwgaG92ZXJTdGwpIHsKICAvLyBGb3IgcGVyZm9ybWFuY2UgY29uc2lkZXJhdGlvbiwgaXQgbWlnaHQgYmUgYmV0dGVyIHRvIG1ha2UgdGhlICJob3ZlciBzdHlsZSIgb25seSB0aGUKICAvLyBkaWZmZXJlbmNlIHByb3BlcnRpZXMgZnJvbSB0aGUgIm5vcm1hbCBzdHlsZSIsIGJ1dCBub3QgYSBlbnRpcmUgY29weSBvZiBhbGwgc3R5bGVzLgogIGhvdmVyU3RsID0gZWwuX19ob3ZlclN0bCA9IGhvdmVyU3RsICE9PSBmYWxzZSAmJiAoZWwuaG92ZXJTdHlsZSB8fCBob3ZlclN0bCB8fCB7fSk7CiAgZWwuX19ob3ZlclN0bERpcnR5ID0gdHJ1ZTsgLy8gRklYTUUKICAvLyBJdCBpcyBub3QgY29tcGxldGVseSByaWdodCB0byBzYXZlICJub3JtYWwiLyJlbXBoYXNpcyIgZmxhZyBvbiBlbGVtZW50cy4KICAvLyBJdCBwcm9iYWJseSBzaG91bGQgYmUgc2F2ZWQgb24gYGRhdGFgIG9mIHNlcmllcy4gQ29uc2lkZXIgdGhlIGNhc2VzOgogIC8vICgxKSBBIGhpZ2hsaWdodGVkIGVsZW1lbnRzIGFyZSBtb3ZlZCBvdXQgb2YgdGhlIHZpZXcgcG9ydCBhbmQgcmUtZW50ZXIKICAvLyBhZ2FpbiBieSBkYXRhWm9vbS4KICAvLyAoMikgY2FsbCBgc2V0T3B0aW9uYCBhbmQgcmVwbGFjZSBlbGVtZW50cyB0b3RhbGx5IHdoZW4gdGhleSBhcmUgaGlnaGxpZ2h0ZWQuCgogIGlmIChlbC5fX2hpZ2hsaWdodGVkKSB7CiAgICAvLyBDb25zaWRlciB0aGUgY2FzZToKICAgIC8vIFRoZSBzdHlsZXMgb2YgYSBoaWdobGlnaHRlZCBgZWxgIGlzIGJlaW5nIHVwZGF0ZWQuIFRoZSBuZXcgImVtcGhhc2lzIHN0eWxlIgogICAgLy8gc2hvdWxkIGJlIGFkYXB0ZWQgdG8gdGhlIGBlbGAuIE5vdGljZSBoZXJlIG5ldyAibm9ybWFsIHN0eWxlcyIgc2hvdWxkIGhhdmUKICAgIC8vIGJlZW4gc2V0IG91dHNpZGUgYW5kIHRoZSBjYWNoZWQgIm5vcm1hbCBzdHlsZSIgaXMgb3V0IG9mIGRhdGUuCiAgICBlbC5fX2NhY2hlZE5vcm1hbFN0bCA9IG51bGw7IC8vIERvIG5vdCBjbGVhciBgX19jYWNoZWROb3JtYWxaMmAgaGVyZSwgYmVjYXVzZSBzZXR0aW5nIGB6MmAgaXMgbm90IGEgY29uc3RyYWludAogICAgLy8gb2YgdGhpcyBtZXRob2QuIEluIG1vc3QgY2FzZXMsIGB6MmAgaXMgbm90IHNldCBhbmQgaG92ZXIgc3R5bGUgc2hvdWxkIGJlIGFibGUKICAgIC8vIHRvIHJvbGxiYWNrLiBPZiBjb3Vyc2UsIHRoYXQgd291bGQgYnJpbmcgYnVnLCBidXQgb25seSBpbiBhIHJhcmUgY2FzZSwgc2VlCiAgICAvLyBgZG9TaW5nbGVMZWF2ZUhvdmVyYCBmb3IgZGV0YWlscy4KCiAgICBzaW5nbGVFbnRlck5vcm1hbChlbCk7CiAgICBzaW5nbGVFbnRlckVtcGhhc2lzKGVsKTsKICB9Cn0KCmZ1bmN0aW9uIG9uRWxlbWVudE1vdXNlT3ZlcihlKSB7CiAgIXNob3VsZFNpbGVudCh0aGlzLCBlKSAvLyAiZW1waGFzaXMiIGV2ZW50IGhpZ2hsaWdodCBoYXMgaGlnaGVyIHByaW9yaXR5IHRoYW4gbW91c2UgaGlnaGxpZ2h0LgogICYmICF0aGlzLl9faGlnaEJ5T3V0ZXIgJiYgdHJhdmVyc2VVcGRhdGUodGhpcywgc2luZ2xlRW50ZXJFbXBoYXNpcyk7Cn0KCmZ1bmN0aW9uIG9uRWxlbWVudE1vdXNlT3V0KGUpIHsKICAhc2hvdWxkU2lsZW50KHRoaXMsIGUpIC8vICJlbXBoYXNpcyIgZXZlbnQgaGlnaGxpZ2h0IGhhcyBoaWdoZXIgcHJpb3JpdHkgdGhhbiBtb3VzZSBoaWdobGlnaHQuCiAgJiYgIXRoaXMuX19oaWdoQnlPdXRlciAmJiB0cmF2ZXJzZVVwZGF0ZSh0aGlzLCBzaW5nbGVFbnRlck5vcm1hbCk7Cn0KCmZ1bmN0aW9uIG9uRWxlbWVudEVtcGhhc2lzRXZlbnQoaGlnaGxpZ2h0RGlnaXQpIHsKICB0aGlzLl9faGlnaEJ5T3V0ZXIgfD0gMSA8PCAoaGlnaGxpZ2h0RGlnaXQgfHwgMCk7CiAgdHJhdmVyc2VVcGRhdGUodGhpcywgc2luZ2xlRW50ZXJFbXBoYXNpcyk7Cn0KCmZ1bmN0aW9uIG9uRWxlbWVudE5vcm1hbEV2ZW50KGhpZ2hsaWdodERpZ2l0KSB7CiAgISh0aGlzLl9faGlnaEJ5T3V0ZXIgJj0gfigxIDw8IChoaWdobGlnaHREaWdpdCB8fCAwKSkpICYmIHRyYXZlcnNlVXBkYXRlKHRoaXMsIHNpbmdsZUVudGVyTm9ybWFsKTsKfQoKZnVuY3Rpb24gc2hvdWxkU2lsZW50KGVsLCBlKSB7CiAgcmV0dXJuIGVsLl9faGlnaERvd25TaWxlbnRPblRvdWNoICYmIGUuenJCeVRvdWNoOwp9Ci8qKgogKiBTZXQgaG92ZXIgc3R5bGUgKG5hbWVseSAiZW1waGFzaXMgc3R5bGUiKSBvZiBlbGVtZW50LAogKiBiYXNlZCBvbiB0aGUgY3VycmVudCBzdHlsZSBvZiB0aGUgZ2l2ZW4gYGVsYC4KICoKICogKDEpCiAqICoqQ09OU1RSQUlOVFMqKiBmb3IgdGhpcyBtZXRob2Q6CiAqIDxBPiBUaGlzIG1ldGhvZCBNVVNUIGJlIGNhbGxlZCBhZnRlciBhbGwgb2YgdGhlIG5vcm1hbCBzdHlsZXMgaGF2aW5nIGJlZW4gYWRvcHRlZAogKiB0byB0aGUgYGVsYC4KICogPEI+IFRoZSBpbnB1dCBgaG92ZXJTdHlsZWAgKHRoYXQgaXMsICJlbXBoYXNpcyBzdHlsZSIpIE1VU1QgYmUgdGhlIHN1YnNldCBvZiB0aGUKICogIm5vcm1hbCBzdHlsZSIgaGF2aW5nIGJlZW4gc2V0IHRvIHRoZSBlbC4KICogPEM+IGBjb2xvcmAgTVVTVCBiZSBvbmUgb2YgdGhlICJub3JtYWwgc3R5bGVzIiAoYmVjYXVzZSBjb2xvciBtaWdodCBiZSBsaWZ0ZWQgYXMKICogYSBkZWZhdWx0IGhvdmVyIHN0eWxlKS4KICoKICogVGhlIHJlYXNvbjogdGhpcyBtZXRob2QgdHJlYXQgdGhlIGN1cnJlbnQgc3R5bGUgb2YgdGhlIGBlbGAgYXMgdGhlICJub3JtYWwgc3R5bGUiCiAqIGFuZCBjYWNoZSB0aGVtIHdoZW4gZW50ZXIvdXBkYXRlIHRoZSAiZW1waGFzaXMgc3R5bGUiLiBDb25zaWRlciB0aGUgY2FzZTogdGhlIGBlbGAKICogaXMgaW4gImVtcGhhc2lzIiBzdGF0ZSBhbmQgYHNldE9wdGlvbmAvYGRpc3BhdGNoQWN0aW9uYCB0cmlnZ2VyIHRoZSBzdHlsZSB1cGRhdGluZwogKiBsb2dpYywgd2hlcmUgdGhlIGVsIHNob3VsZCBzaGlmdCBmcm9tIHRoZSBvcmlnaW5hbCBlbXBoYXNpcyBzdHlsZSB0byB0aGUgbmV3CiAqICJlbXBoYXNpcyBzdHlsZSIgYW5kIHNob3VsZCBiZSBhYmxlIHRvICJkb3ducGxheSIgYmFjayB0byB0aGUgbmV3ICJub3JtYWwgc3R5bGUiLgogKgogKiBJbmRlZWQsIGl0IGlzIGVycm9yLXByb25lIHRvIG1ha2UgYSBpbnRlcmZhY2UgaGFzIHNvIG1hbnkgY29uc3RyYWludHMsIGJ1dCBJIGhhdmUKICogbm90IGZvdW5kIGEgYmV0dGVyIHNvbHV0aW9uIHlldCB0byBmaXQgdGhlIGJhY2t3YXJkIGNvbXBhdGliaWxpdHksIHBlcmZvcm1hbmNlIGFuZAogKiB0aGUgY3VycmVudCBwcm9ncmFtbWluZyBzdHlsZS4KICoKICogKDIpCiAqIENhbGwgdGhlIG1ldGhvZCBmb3IgYSAicm9vdCIgZWxlbWVudCBvbmNlLiBEbyBub3QgY2FsbCBpdCBmb3IgZWFjaCBkZXNjZW5kYW50cy4KICogSWYgdGhlIGRlc2NlbmRhbnRzIGVsZW1lbmV0cyBvZiBhIGdyb3VwIGhhcyBpdHNlbGYgaG92ZXIgc3R5bGUgZGlmZmVyZW50IGZyb20gdGhlCiAqIHJvb3QgZ3JvdXAsIHdlIGNhbiBzaW1wbHkgbW91bnQgdGhlIHN0eWxlIG9uIGBlbC5ob3ZlclN0eWxlYCBmb3IgdGhlbSwgYnV0IHNob3VsZAogKiBub3QgY2FsbCB0aGlzIG1ldGhvZCBmb3IgdGhlbS4KICoKICogKDMpIFRoZXNlIGlucHV0IHBhcmFtZXRlcnMgY2FuIGJlIHNldCBkaXJlY3RseSBvbiBgZWxgOgogKgogKiBAcGFyYW0ge21vZHVsZTp6cmVuZGVyL0VsZW1lbnR9IGVsCiAqIEBwYXJhbSB7T2JqZWN0fSBbZWwuaG92ZXJTdHlsZV0gU2VlIGBncmFwaGljLnNldEVsZW1lbnRIb3ZlclN0eWxlYC4KICogQHBhcmFtIHtib29sZWFufSBbZWwuaGlnaERvd25TaWxlbnRPblRvdWNoPWZhbHNlXSBTZWUgYGdyYXBoaWMuc2V0QXNIaWdoRG93bkRpc3BhdGNoZXJgLgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBbZWwuaGlnaERvd25PblVwZGF0ZV0gU2VlIGBncmFwaGljLnNldEFzSGlnaERvd25EaXNwYXRjaGVyYC4KICogQHBhcmFtIHtPYmplY3R8Ym9vbGVhbn0gW2hvdmVyU3R5bGVdIFNlZSBgZ3JhcGhpYy5zZXRFbGVtZW50SG92ZXJTdHlsZWAuCiAqLwoKCmZ1bmN0aW9uIHNldEhvdmVyU3R5bGUoZWwsIGhvdmVyU3R5bGUpIHsKICBzZXRBc0hpZ2hEb3duRGlzcGF0Y2hlcihlbCwgdHJ1ZSk7CiAgdHJhdmVyc2VVcGRhdGUoZWwsIHNldEVsZW1lbnRIb3ZlclN0eWxlLCBob3ZlclN0eWxlKTsKfQovKioKICogQHBhcmFtIHttb2R1bGU6enJlbmRlci9FbGVtZW50fSBlbAogKiBAcGFyYW0ge0Z1bmN0aW9ufSBbZWwuaGlnaERvd25PblVwZGF0ZV0gQ2FsbGVkIHdoZW4gc3RhdGUgdXBkYXRlZC4KICogICAgICAgIFNpbmNlIGBzZXRIb3ZlclN0eWxlYCBoYXMgdGhlIGNvbnN0cmFpbnQgdGhhdCBpdCBtdXN0IGJlIGNhbGxlZCBhZnRlcgogKiAgICAgICAgYWxsIG9mIHRoZSBub3JtYWwgc3R5bGUgdXBkYXRlZCwgYGhpZ2hEb3duT25VcGRhdGVgIGlzIG5vdCBuZWVkZWQgdG8KICogICAgICAgIHRyaWdnZXIgaWYgYm90aCBgZnJvbVN0YXRlYCBhbmQgYHRvU3RhdGVgIGlzICdub3JtYWwnLCBhbmQgbmVlZGVkIHRvCiAqICAgICAgICB0cmlnZ2VyIGlmIGJvdGggYGZyb21TdGF0ZWAgYW5kIGB0b1N0YXRlYCBpcyAnZW1waGFzaXMnLCB3aGljaCBlbmFibGVzCiAqICAgICAgICB0byBzeW5jIG91dHNpZGUgc3R5bGUgc2V0dGluZ3MgdG8gImVtcGhhc2lzIiBzdGF0ZS4KICogICAgICAgIEB0aGlzIHtzdHJpbmd9IFRoaXMgZGlzcGF0Y2hlciBgZWxgLgogKiAgICAgICAgQHBhcmFtIHtzdHJpbmd9IGZyb21TdGF0ZSBDYW4gYmUgIm5vcm1hbCIgb3IgImVtcGhhc2lzIi4KICogICAgICAgICAgICAgICBgZnJvbVN0YXRlYCBtaWdodCBlcXVhbCB0byBgdG9TdGF0ZWAsCiAqICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUsIHdoZW4gdGhpcyBtZXRob2QgaXMgY2FsbGVkIHdoZW4gYGVsYCBpcwogKiAgICAgICAgICAgICAgIG9uICJlbXBoYXNpcyIgc3RhdGUuCiAqICAgICAgICBAcGFyYW0ge3N0cmluZ30gdG9TdGF0ZSBDYW4gYmUgIm5vcm1hbCIgb3IgImVtcGhhc2lzIi4KICoKICogICAgICAgIEZJWE1FCiAqICAgICAgICBDQVVUSU9OOiBEbyBub3QgZXhwb3NlIGBoaWdoRG93bk9uVXBkYXRlYCBvdXRzaWRlIGVjaGFydHMuCiAqICAgICAgICBCZWNhdXNlIGl0IGlzIG5vdCBhIGNvbXBsZXRlIHNvbHV0aW9uLiBUaGUgdXBkYXRlCiAqICAgICAgICBsaXN0ZW5lciBzaG91bGQgbm90IGhhdmUgYmVlbiBtb3VudCBpbiBlbGVtZW50LAogKiAgICAgICAgYW5kIHRoZSBub3JtYWwvZW1waGFzaXMgc3RhdGUgc2hvdWxkIG5vdCBoYXZlCiAqICAgICAgICBtYW50YWluZWQgb24gZWxlbWVudHMuCiAqCiAqIEBwYXJhbSB7Ym9vbGVhbn0gW2VsLmhpZ2hEb3duU2lsZW50T25Ub3VjaD1mYWxzZV0KICogICAgICAgIEluIHRvdWNoIGRldmljZSwgbW91c2VvdmVyIGV2ZW50IHdpbGwgYmUgdHJpZ2dlciBvbiB0b3VjaHN0YXJ0IGV2ZW50CiAqICAgICAgICAoc2VlIG1vZHVsZTp6cmVuZGVyL2RvbS9IYW5kbGVyUHJveHkpLiBCeSB0aGlzIG1lY2hhbmlzbSwgd2UgY2FuCiAqICAgICAgICBjb252ZW5pZW50bHkgdXNlIGhvdmVyU3R5bGUgd2hlbiB0YXAgb24gdG91Y2ggc2NyZWVuIHdpdGhvdXQgYWRkaXRpb25hbAogKiAgICAgICAgY29kZSBmb3IgY29tcGF0aWJpbGl0eS4KICogICAgICAgIEJ1dCBpZiB0aGUgY2hhcnQvY29tcG9uZW50IGhhcyBzZWxlY3QgZmVhdHVyZSwgd2hpY2ggdXN1YWxseSBhbHNvIHVzZQogKiAgICAgICAgaG92ZXJTdHlsZSwgdGhlcmUgbWlnaHQgYmUgY29uZmxpY3QgYmV0d2VlbiAnc2VsZWN0LWhpZ2hsaWdodCcgYW5kCiAqICAgICAgICAnaG92ZXItaGlnaGxpZ2h0JyBlc3BlY2lhbGx5IHdoZW4gcm9hbSBpcyBlbmFibGVkIChzZWUgZ2VvIGZvciBleGFtcGxlKS4KICogICAgICAgIEluIHRoaXMgY2FzZSwgYGhpZ2hEb3duU2lsZW50T25Ub3VjaGAgc2hvdWxkIGJlIHVzZWQgdG8gZGlzYWJsZQogKiAgICAgICAgaG92ZXItaGlnaGxpZ2h0IG9uIHRvdWNoIGRldmljZS4KICogQHBhcmFtIHtib29sZWFufSBbYXNEaXNwYXRjaGVyPXRydWVdIElmIGBmYWxzZWAsIGRvIG5vdCBzZXQgYXMgImhpZ2hEb3duRGlzcGF0Y2hlciIuCiAqLwoKCmZ1bmN0aW9uIHNldEFzSGlnaERvd25EaXNwYXRjaGVyKGVsLCBhc0Rpc3BhdGNoZXIpIHsKICB2YXIgZGlzYWJsZSA9IGFzRGlzcGF0Y2hlciA9PT0gZmFsc2U7IC8vIE1ha2UgYGhpZ2hEb3duU2lsZW50T25Ub3VjaGAgYW5kIGBoaWdoRG93bk9uVXBkYXRlYCBvbmx5IHdvcmsgYWZ0ZXIKICAvLyBgc2V0QXNIaWdoRG93bkRpc3BhdGNoZXJgIGNhbGxlZC4gQXZvaWQgaXQgaXMgbW9kaWZpZWQgYnkgdXNlciB1bmV4cGVjdGVkbHkuCgogIGVsLl9faGlnaERvd25TaWxlbnRPblRvdWNoID0gZWwuaGlnaERvd25TaWxlbnRPblRvdWNoOwogIGVsLl9faGlnaERvd25PblVwZGF0ZSA9IGVsLmhpZ2hEb3duT25VcGRhdGU7IC8vIFNpbXBsZSBvcHRpbWl6ZSwgc2luY2UgdGhpcyBtZXRob2QgbWlnaHQgYmUKICAvLyBjYWxsZWQgZm9yIGVhY2ggZWxlbWVudHMgb2YgYSBncm91cCBpbiBzb21lIGNhc2VzLgoKICBpZiAoIWRpc2FibGUgfHwgZWwuX19oaWdoRG93bkRpc3BhdGNoZXIpIHsKICAgIHZhciBtZXRob2QgPSBkaXNhYmxlID8gJ29mZicgOiAnb24nOyAvLyBEdXBsaWNhdGVkIGZ1bmN0aW9uIHdpbGwgYmUgYXV0by1pZ25vcmVkLCBzZWUgRXZlbnRmdWwuanMuCgogICAgZWxbbWV0aG9kXSgnbW91c2VvdmVyJywgb25FbGVtZW50TW91c2VPdmVyKVttZXRob2RdKCdtb3VzZW91dCcsIG9uRWxlbWVudE1vdXNlT3V0KTsgLy8gRW1waGFzaXMsIG5vcm1hbCBjYW4gYmUgdHJpZ2dlcmVkIG1hbnVhbGx5IGJ5IEFQSSBvciBvdGhlciBjb21wb25lbnRzIGxpa2UgaG92ZXIgbGluay4KCiAgICBlbFttZXRob2RdKCdlbXBoYXNpcycsIG9uRWxlbWVudEVtcGhhc2lzRXZlbnQpW21ldGhvZF0oJ25vcm1hbCcsIG9uRWxlbWVudE5vcm1hbEV2ZW50KTsgLy8gQWxzbyBrZWVwIHByZXZpb3VzIHJlY29yZC4KCiAgICBlbC5fX2hpZ2hCeU91dGVyID0gZWwuX19oaWdoQnlPdXRlciB8fCAwOwogICAgZWwuX19oaWdoRG93bkRpc3BhdGNoZXIgPSAhZGlzYWJsZTsKICB9Cn0KLyoqCiAqIEBwYXJhbSB7bW9kdWxlOnpyZW5kZXIvc3JjL0VsZW1lbnR9IGVsCiAqIEByZXR1cm4ge2Jvb2xlYW59CiAqLwoKCmZ1bmN0aW9uIGlzSGlnaERvd25EaXNwYXRjaGVyKGVsKSB7CiAgcmV0dXJuICEhKGVsICYmIGVsLl9faGlnaERvd25EaXNwYXRjaGVyKTsKfQovKioKICogU3VwcG9ydCBoaWdodGxpZ2h0L2Rvd25wbGF5IHJlY29yZCBvbiBlYWNoIGVsZW1lbnRzLgogKiBGb3IgdGhlIGNhc2U6IGhvdmVyIGhpZ2hsaWdodC9kb3ducGxheSAobGVnZW5kLCB2aXN1YWxNYXAsIC4uLikgYW5kCiAqIHVzZXIgdHJpZ2dlcnJlZCBoaWdodGxpZ2h0L2Rvd25wbGF5IHNob3VsZCBub3QgY29uZmxpY3QuCiAqIE9ubHkgYWxsIG9mIHRoZSBoaWdobGlnaHREaWdpdCBjbGVhcmVkLCByZXR1cm4gdG8gbm9ybWFsLgogKiBAcGFyYW0ge3N0cmluZ30gaGlnaGxpZ2h0S2V5CiAqIEByZXR1cm4ge251bWJlcn0gaGlnaGxpZ2h0RGlnaXQKICovCgoKZnVuY3Rpb24gZ2V0SGlnaGxpZ2h0RGlnaXQoaGlnaGxpZ2h0S2V5KSB7CiAgdmFyIGhpZ2hsaWdodERpZ2l0ID0gX2hpZ2hsaWdodEtleU1hcFtoaWdobGlnaHRLZXldOwoKICBpZiAoaGlnaGxpZ2h0RGlnaXQgPT0gbnVsbCAmJiBfaGlnaGxpZ2h0TmV4dERpZ2l0IDw9IDMyKSB7CiAgICBoaWdobGlnaHREaWdpdCA9IF9oaWdobGlnaHRLZXlNYXBbaGlnaGxpZ2h0S2V5XSA9IF9oaWdobGlnaHROZXh0RGlnaXQrKzsKICB9CgogIHJldHVybiBoaWdobGlnaHREaWdpdDsKfQovKioKICogU2VlIG1vcmUgaW5mbyBpbiBgc2V0VGV4dFN0eWxlQ29tbW9uYC4KICogQHBhcmFtIHtPYmplY3R8bW9kdWxlOnpyZW5kZXIvZ3JhcGhpYy9TdHlsZX0gbm9ybWFsU3R5bGUKICogQHBhcmFtIHtPYmplY3R9IGVtcGhhc2lzU3R5bGUKICogQHBhcmFtIHttb2R1bGU6ZWNoYXJ0cy9tb2RlbC9Nb2RlbH0gbm9ybWFsTW9kZWwKICogQHBhcmFtIHttb2R1bGU6ZWNoYXJ0cy9tb2RlbC9Nb2RlbH0gZW1waGFzaXNNb2RlbAogKiBAcGFyYW0ge09iamVjdH0gb3B0IENoZWNrIGBvcHRgIG9mIGBzZXRUZXh0U3R5bGVDb21tb25gIHRvIGZpbmQgb3RoZXIgcHJvcHMuCiAqIEBwYXJhbSB7c3RyaW5nfEZ1bmN0aW9ufSBbb3B0LmRlZmF1bHRUZXh0XQogKiBAcGFyYW0ge21vZHVsZTplY2hhcnRzL21vZGVsL01vZGVsfSBbb3B0LmxhYmVsRmV0Y2hlcl0gRmV0Y2ggdGV4dCBieQogKiAgICAgIGBvcHQubGFiZWxGZXRjaGVyLmdldEZvcm1hdHRlZExhYmVsKG9wdC5sYWJlbERhdGFJbmRleCwgJ25vcm1hbCcvJ2VtcGhhc2lzJywgbnVsbCwgb3B0LmxhYmVsRGltSW5kZXgsIG9wdC5sYWJlbFByb3ApYAogKiBAcGFyYW0ge251bWJlcn0gW29wdC5sYWJlbERhdGFJbmRleF0gRmV0Y2ggdGV4dCBieQogKiAgICAgIGBvcHQudGV4dEZldGNoZXIuZ2V0Rm9ybWF0dGVkTGFiZWwob3B0LmxhYmVsRGF0YUluZGV4LCAnbm9ybWFsJy8nZW1waGFzaXMnLCBudWxsLCBvcHQubGFiZWxEaW1JbmRleCwgb3B0LmxhYmVsUHJvcClgCiAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0LmxhYmVsRGltSW5kZXhdIEZldGNoIHRleHQgYnkKICogICAgICBgb3B0LnRleHRGZXRjaGVyLmdldEZvcm1hdHRlZExhYmVsKG9wdC5sYWJlbERhdGFJbmRleCwgJ25vcm1hbCcvJ2VtcGhhc2lzJywgbnVsbCwgb3B0LmxhYmVsRGltSW5kZXgsIG9wdC5sYWJlbFByb3ApYAogKiBAcGFyYW0ge3N0cmluZ30gW29wdC5sYWJlbFByb3BdIEZldGNoIHRleHQgYnkKICogICAgICBgb3B0LnRleHRGZXRjaGVyLmdldEZvcm1hdHRlZExhYmVsKG9wdC5sYWJlbERhdGFJbmRleCwgJ25vcm1hbCcvJ2VtcGhhc2lzJywgbnVsbCwgb3B0LmxhYmVsRGltSW5kZXgsIG9wdC5sYWJlbFByb3ApYAogKiBAcGFyYW0ge09iamVjdH0gW25vcm1hbFNwZWNpZmllZF0KICogQHBhcmFtIHtPYmplY3R9IFtlbXBoYXNpc1NwZWNpZmllZF0KICovCgoKZnVuY3Rpb24gc2V0TGFiZWxTdHlsZShub3JtYWxTdHlsZSwgZW1waGFzaXNTdHlsZSwgbm9ybWFsTW9kZWwsIGVtcGhhc2lzTW9kZWwsIG9wdCwgbm9ybWFsU3BlY2lmaWVkLCBlbXBoYXNpc1NwZWNpZmllZCkgewogIG9wdCA9IG9wdCB8fCBFTVBUWV9PQko7CiAgdmFyIGxhYmVsRmV0Y2hlciA9IG9wdC5sYWJlbEZldGNoZXI7CiAgdmFyIGxhYmVsRGF0YUluZGV4ID0gb3B0LmxhYmVsRGF0YUluZGV4OwogIHZhciBsYWJlbERpbUluZGV4ID0gb3B0LmxhYmVsRGltSW5kZXg7CiAgdmFyIGxhYmVsUHJvcCA9IG9wdC5sYWJlbFByb3A7IC8vIFRoaXMgc2NlbmFyaW8sIGBsYWJlbC5ub3JtYWwuc2hvdyA9IHRydWU7IGxhYmVsLmVtcGhhc2lzLnNob3cgPSBmYWxzZWAsCiAgLy8gaXMgbm90IHN1cHBvcnRlZCB1dGlsIHNvbWVvbmUgcmVxdWVzdHMuCgogIHZhciBzaG93Tm9ybWFsID0gbm9ybWFsTW9kZWwuZ2V0U2hhbGxvdygnc2hvdycpOwogIHZhciBzaG93RW1waGFzaXMgPSBlbXBoYXNpc01vZGVsLmdldFNoYWxsb3coJ3Nob3cnKTsgLy8gQ29uc2lkZXIgcGVyZm9ybWFuY2UsIG9ubHkgZmV0Y2ggbGFiZWwgd2hlbiBuZWNlc3NhcnkuCiAgLy8gSWYgYG5vcm1hbC5zaG93YCBpcyBgZmFsc2VgIGFuZCBgZW1waGFzaXMuc2hvd2AgaXMgYHRydWVgIGFuZCBgZW1waGFzaXMuZm9ybWF0dGVyYCBpcyBub3Qgc2V0LAogIC8vIGxhYmVsIHNob3VsZCBiZSBkaXNwbGF5ZWQsIHdoZXJlIHRleHQgaXMgZmV0Y2hlZCBieSBgbm9ybWFsLmZvcm1hdHRlcmAgb3IgYG9wdC5kZWZhdWx0VGV4dGAuCgogIHZhciBiYXNlVGV4dDsKCiAgaWYgKHNob3dOb3JtYWwgfHwgc2hvd0VtcGhhc2lzKSB7CiAgICBpZiAobGFiZWxGZXRjaGVyKSB7CiAgICAgIGJhc2VUZXh0ID0gbGFiZWxGZXRjaGVyLmdldEZvcm1hdHRlZExhYmVsKGxhYmVsRGF0YUluZGV4LCAnbm9ybWFsJywgbnVsbCwgbGFiZWxEaW1JbmRleCwgbGFiZWxQcm9wKTsKICAgIH0KCiAgICBpZiAoYmFzZVRleHQgPT0gbnVsbCkgewogICAgICBiYXNlVGV4dCA9IHpyVXRpbC5pc0Z1bmN0aW9uKG9wdC5kZWZhdWx0VGV4dCkgPyBvcHQuZGVmYXVsdFRleHQobGFiZWxEYXRhSW5kZXgsIG9wdCkgOiBvcHQuZGVmYXVsdFRleHQ7CiAgICB9CiAgfQoKICB2YXIgbm9ybWFsU3R5bGVUZXh0ID0gc2hvd05vcm1hbCA/IGJhc2VUZXh0IDogbnVsbDsKICB2YXIgZW1waGFzaXNTdHlsZVRleHQgPSBzaG93RW1waGFzaXMgPyB6clV0aWwucmV0cmlldmUyKGxhYmVsRmV0Y2hlciA/IGxhYmVsRmV0Y2hlci5nZXRGb3JtYXR0ZWRMYWJlbChsYWJlbERhdGFJbmRleCwgJ2VtcGhhc2lzJywgbnVsbCwgbGFiZWxEaW1JbmRleCwgbGFiZWxQcm9wKSA6IG51bGwsIGJhc2VUZXh0KSA6IG51bGw7IC8vIE9wdGltaXplOiBJZiBzdHlsZS50ZXh0IGlzIG51bGwsIHRleHQgd2lsbCBub3QgYmUgZHJhd24uCgogIGlmIChub3JtYWxTdHlsZVRleHQgIT0gbnVsbCB8fCBlbXBoYXNpc1N0eWxlVGV4dCAhPSBudWxsKSB7CiAgICAvLyBBbHdheXMgc2V0IGB0ZXh0U3R5bGVgIGV2ZW4gaWYgYG5vcm1hbFN0eWxlLnRleHRgIGlzIG51bGwsIGJlY2F1c2UgZGVmYXVsdAogICAgLy8gdmFsdWVzIGhhdmUgdG8gYmUgc2V0IG9uIGBub3JtYWxTdHlsZWAuCiAgICAvLyBJZiB3ZSBzZXQgZGVmYXVsdCB2YWx1ZXMgb24gYGVtcGhhc2lzU3R5bGVgLCBjb25zaWRlciBjYXNlOgogICAgLy8gRmlyc3RseSwgYHNldE9wdGlvbiguLi4gbGFiZWw6IHtub3JtYWw6IHt0ZXh0OiBudWxsfSwgZW1waGFzaXM6IHtzaG93OiB0cnVlfX0gLi4uKTtgCiAgICAvLyBTZWNvbmRseSwgYHNldE9wdGlvbiguLi4gbGFiZWw6IHtub3JhbWw6IHtzaG93OiB0cnVlLCB0ZXh0OiAnYWJjJywgY29sb3I6ICdyZWQnfSAuLi4pO2AKICAgIC8vIFRoZW4gdGhlICdyZWQnIHdpbGwgbm90IHdvcmsgb24gZW1waGFzaXMuCiAgICBzZXRUZXh0U3R5bGUobm9ybWFsU3R5bGUsIG5vcm1hbE1vZGVsLCBub3JtYWxTcGVjaWZpZWQsIG9wdCk7CiAgICBzZXRUZXh0U3R5bGUoZW1waGFzaXNTdHlsZSwgZW1waGFzaXNNb2RlbCwgZW1waGFzaXNTcGVjaWZpZWQsIG9wdCwgdHJ1ZSk7CiAgfQoKICBub3JtYWxTdHlsZS50ZXh0ID0gbm9ybWFsU3R5bGVUZXh0OwogIGVtcGhhc2lzU3R5bGUudGV4dCA9IGVtcGhhc2lzU3R5bGVUZXh0Owp9Ci8qKgogKiBNb2RpZnkgbGFiZWwgc3R5bGUgbWFudWFsbHkuCiAqIE9ubHkgd29ya3MgYWZ0ZXIgYHNldExhYmVsU3R5bGVgIGFuZCBgc2V0RWxlbWVudEhvdmVyU3R5bGVgIGNhbGxlZC4KICoKICogQHBhcmFtIHttb2R1bGU6enJlbmRlci9zcmMvRWxlbWVudH0gZWwKICogQHBhcmFtIHtPYmplY3R9IFtub3JtYWxTdHlsZVByb3BzXSBvcHRpb25hbAogKiBAcGFyYW0ge09iamVjdH0gW2VtcGhhc2lzU3R5bGVQcm9wc10gb3B0aW9uYWwKICovCgoKZnVuY3Rpb24gbW9kaWZ5TGFiZWxTdHlsZShlbCwgbm9ybWFsU3R5bGVQcm9wcywgZW1waGFzaXNTdHlsZVByb3BzKSB7CiAgdmFyIGVsU3R5bGUgPSBlbC5zdHlsZTsKCiAgaWYgKG5vcm1hbFN0eWxlUHJvcHMpIHsKICAgIHJvbGxiYWNrRGVmYXVsdFRleHRTdHlsZShlbFN0eWxlKTsKICAgIGVsLnNldFN0eWxlKG5vcm1hbFN0eWxlUHJvcHMpOwogICAgYXBwbHlEZWZhdWx0VGV4dFN0eWxlKGVsU3R5bGUpOwogIH0KCiAgZWxTdHlsZSA9IGVsLl9faG92ZXJTdGw7CgogIGlmIChlbXBoYXNpc1N0eWxlUHJvcHMgJiYgZWxTdHlsZSkgewogICAgcm9sbGJhY2tEZWZhdWx0VGV4dFN0eWxlKGVsU3R5bGUpOwogICAgenJVdGlsLmV4dGVuZChlbFN0eWxlLCBlbXBoYXNpc1N0eWxlUHJvcHMpOwogICAgYXBwbHlEZWZhdWx0VGV4dFN0eWxlKGVsU3R5bGUpOwogIH0KfQovKioKICogU2V0IGJhc2ljIHRleHRTdHlsZSBwcm9wZXJ0aWVzLgogKiBTZWUgbW9yZSBpbmZvIGluIGBzZXRUZXh0U3R5bGVDb21tb25gLgogKiBAcGFyYW0ge09iamVjdHxtb2R1bGU6enJlbmRlci9ncmFwaGljL1N0eWxlfSB0ZXh0U3R5bGUKICogQHBhcmFtIHttb2R1bGU6ZWNoYXJ0cy9tb2RlbC9Nb2RlbH0gbW9kZWwKICogQHBhcmFtIHtPYmplY3R9IFtzcGVjaWZpZWRUZXh0U3R5bGVdIENhbiBiZSBvdmVycmlkZWQgYnkgc2V0dGluZ3MgaW4gbW9kZWwuCiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0XSBTZWUgYG9wdGAgb2YgYHNldFRleHRTdHlsZUNvbW1vbmAuCiAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzRW1waGFzaXNdCiAqLwoKCmZ1bmN0aW9uIHNldFRleHRTdHlsZSh0ZXh0U3R5bGUsIHRleHRTdHlsZU1vZGVsLCBzcGVjaWZpZWRUZXh0U3R5bGUsIG9wdCwgaXNFbXBoYXNpcykgewogIHNldFRleHRTdHlsZUNvbW1vbih0ZXh0U3R5bGUsIHRleHRTdHlsZU1vZGVsLCBvcHQsIGlzRW1waGFzaXMpOwogIHNwZWNpZmllZFRleHRTdHlsZSAmJiB6clV0aWwuZXh0ZW5kKHRleHRTdHlsZSwgc3BlY2lmaWVkVGV4dFN0eWxlKTsgLy8gdGV4dFN0eWxlLmhvc3QgJiYgdGV4dFN0eWxlLmhvc3QuZGlydHkgJiYgdGV4dFN0eWxlLmhvc3QuZGlydHkoZmFsc2UpOwoKICByZXR1cm4gdGV4dFN0eWxlOwp9Ci8qKgogKiBTZXQgdGV4dCBvcHRpb24gaW4gdGhlIHN0eWxlLgogKiBTZWUgbW9yZSBpbmZvIGluIGBzZXRUZXh0U3R5bGVDb21tb25gLgogKiBAZGVwcmVjYXRlZAogKiBAcGFyYW0ge09iamVjdH0gdGV4dFN0eWxlCiAqIEBwYXJhbSB7bW9kdWxlOmVjaGFydHMvbW9kZWwvTW9kZWx9IGxhYmVsTW9kZWwKICogQHBhcmFtIHtzdHJpbmd8Ym9vbGVhbn0gZGVmYXVsdENvbG9yIERlZmF1bHQgdGV4dCBjb2xvci4KICogICAgICAgIElmIHNldCBhcyBmYWxzZSwgaXQgd2lsbCBiZSBwcm9jZXNzZWQgYXMgYSBlbXBoYXNpcyBzdHlsZS4KICovCgoKZnVuY3Rpb24gc2V0VGV4dCh0ZXh0U3R5bGUsIGxhYmVsTW9kZWwsIGRlZmF1bHRDb2xvcikgewogIHZhciBvcHQgPSB7CiAgICBpc1JlY3RUZXh0OiB0cnVlCiAgfTsKICB2YXIgaXNFbXBoYXNpczsKCiAgaWYgKGRlZmF1bHRDb2xvciA9PT0gZmFsc2UpIHsKICAgIGlzRW1waGFzaXMgPSB0cnVlOwogIH0gZWxzZSB7CiAgICAvLyBTdXBwb3J0IHNldHRpbmcgY29sb3IgYXMgJ2F1dG8nIHRvIGdldCB2aXN1YWwgY29sb3IuCiAgICBvcHQuYXV0b0NvbG9yID0gZGVmYXVsdENvbG9yOwogIH0KCiAgc2V0VGV4dFN0eWxlQ29tbW9uKHRleHRTdHlsZSwgbGFiZWxNb2RlbCwgb3B0LCBpc0VtcGhhc2lzKTsgLy8gdGV4dFN0eWxlLmhvc3QgJiYgdGV4dFN0eWxlLmhvc3QuZGlydHkgJiYgdGV4dFN0eWxlLmhvc3QuZGlydHkoZmFsc2UpOwp9Ci8qKgogKiBUaGUgdW5pZm9ybSBlbnRyeSBvZiBzZXQgdGV4dCBzdHlsZSwgdGhhdCBpcywgcmV0cmlldmUgc3R5bGUgZGVmaW5pdGlvbnMKICogZnJvbSBgbW9kZWxgIGFuZCBzZXQgdG8gYHRleHRTdHlsZWAgb2JqZWN0LgogKgogKiBOZXZlciBpbiBtZXJnZSBtb2RlLCBidXQgaW4gb3ZlcndyaXRlIG1vZGUsIHRoYXQgaXMsIGFsbCBvZiB0aGUgdGV4dCBzdHlsZQogKiBwcm9wZXJ0aWVzIHdpbGwgYmUgc2V0LiAoQ29uc2lkZXIgdGhlIHN0YXRlcyBvZiBub3JtYWwgYW5kIGVtcGhhc2lzIGFuZAogKiBkZWZhdWx0IHZhbHVlIGNhbiBiZSBhZG9wdGVkLCBtZXJnZSB3b3VsZCBtYWtlIHRoZSBsb2dpYyB0b28gY29tcGxpY2F0ZWQKICogdG8gbWFuYWdlLikKICoKICogVGhlIGB0ZXh0U3R5bGVgIG9iamVjdCBjYW4gZWl0aGVyIGJlIGEgcGxhaW4gb2JqZWN0IG9yIGFuIGluc3RhbmNlIG9mCiAqIGB6cmVuZGVyL3NyYy9ncmFwaGljL1N0eWxlYCwgYW5kIGVpdGhlciBiZSB0aGUgc3R5bGUgb2Ygbm9ybWFsIG9yIGVtcGhhc2lzLgogKiBBZnRlciB0aGlzIG1vdGhvZCBjYWxsZWQsIHRoZSBgdGV4dFN0eWxlYCBvYmplY3QgY2FuIHRoZW4gYmUgdXNlZCBpbgogKiBgZWwuc2V0U3R5bGUodGV4dFN0eWxlKWAgb3IgYGVsLmhvdmVyU3R5bGUgPSB0ZXh0U3R5bGVgLgogKgogKiBEZWZhdWx0IHZhbHVlIHdpbGwgYmUgYWRvcHRlZCBhbmQgYGluc2lkZVJvbGxiYWNrT3B0YCB3aWxsIGJlIGNyZWF0ZWQuCiAqIFNlZSBgYXBwbHlEZWZhdWx0VGV4dFN0eWxlYCBgcm9sbGJhY2tEZWZhdWx0VGV4dFN0eWxlYCBmb3IgbW9yZSBkZXRhaWxzLgogKgogKiBvcHQ6IHsKICogICAgICBkaXNhYmxlQm94OiBib29sZWFuLCBXaGV0aGVyIGRpYWJsZSBkcmF3aW5nIGJveCBvZiBibG9jayAob3V0ZXIgbW9zdCkuCiAqICAgICAgaXNSZWN0VGV4dDogYm9vbGVhbiwKICogICAgICBhdXRvQ29sb3I6IHN0cmluZywgc3BlY2lmeSBhIGNvbG9yIHdoZW4gY29sb3IgaXMgJ2F1dG8nLAogKiAgICAgICAgICAgICAgZm9yIHRleHRGaWxsLCB0ZXh0U3Ryb2tlLCB0ZXh0QmFja2dyb3VuZENvbG9yLCBhbmQgdGV4dEJvcmRlckNvbG9yLgogKiAgICAgICAgICAgICAgSWYgYXV0b0NvbG9yIHNwZWNpZmllZCwgaXQgaXMgdXNlZCBhcyBkZWZhdWx0IHRleHRGaWxsLgogKiAgICAgIHVzZUluc2lkZVN0eWxlOgogKiAgICAgICAgICAgICAgYHRydWVgOiBVc2UgaW5zaWRlIHN0eWxlICh0ZXh0RmlsbCwgdGV4dFN0cm9rZSwgdGV4dFN0cm9rZVdpZHRoKQogKiAgICAgICAgICAgICAgICAgIGlmIGB0ZXh0RmlsbGAgaXMgbm90IHNwZWNpZmllZC4KICogICAgICAgICAgICAgIGBmYWxzZWA6IERvIG5vdCB1c2UgaW5zaWRlIHN0eWxlLgogKiAgICAgICAgICAgICAgYG51bGwvdW5kZWZpbmVkYDogdXNlIGluc2lkZSBzdHlsZSBpZiBgaXNSZWN0VGV4dGAgaXMgdHJ1ZSBhbmQKICogICAgICAgICAgICAgICAgICBgdGV4dEZpbGxgIGlzIG5vdCBzcGVjaWZpZWQgYW5kIHRleHRQb3NpdGlvbiBjb250YWlucyBgJ2luc2lkZSdgLgogKiAgICAgIGZvcmNlUmljaDogYm9vbGVhbgogKiB9CiAqLwoKCmZ1bmN0aW9uIHNldFRleHRTdHlsZUNvbW1vbih0ZXh0U3R5bGUsIHRleHRTdHlsZU1vZGVsLCBvcHQsIGlzRW1waGFzaXMpIHsKICAvLyBDb25zaWRlciB0aGVyZSB3aWxsIGJlIGFibm9ybWFsIHdoZW4gbWVyZ2UgaG92ZXIgc3R5bGUgdG8gbm9ybWFsIHN0eWxlIGlmIGdpdmVuIGRlZmF1bHQgdmFsdWUuCiAgb3B0ID0gb3B0IHx8IEVNUFRZX09CSjsKCiAgaWYgKG9wdC5pc1JlY3RUZXh0KSB7CiAgICB2YXIgdGV4dFBvc2l0aW9uOwoKICAgIGlmIChvcHQuZ2V0VGV4dFBvc2l0aW9uKSB7CiAgICAgIHRleHRQb3NpdGlvbiA9IG9wdC5nZXRUZXh0UG9zaXRpb24odGV4dFN0eWxlTW9kZWwsIGlzRW1waGFzaXMpOwogICAgfSBlbHNlIHsKICAgICAgdGV4dFBvc2l0aW9uID0gdGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygncG9zaXRpb24nKSB8fCAoaXNFbXBoYXNpcyA/IG51bGwgOiAnaW5zaWRlJyk7IC8vICdvdXRzaWRlJyBpcyBub3QgYSB2YWxpZCB6ciB0ZXh0UG9zdGlvbiB2YWx1ZSwgYnV0IHVzZWQKICAgICAgLy8gaW4gYmFyIHNlcmllcywgYW5kIG1hZ3JpYyB0eXBlIHNob3VsZCBiZSBjb25zaWRlcmVkLgoKICAgICAgdGV4dFBvc2l0aW9uID09PSAnb3V0c2lkZScgJiYgKHRleHRQb3NpdGlvbiA9ICd0b3AnKTsKICAgIH0KCiAgICB0ZXh0U3R5bGUudGV4dFBvc2l0aW9uID0gdGV4dFBvc2l0aW9uOwogICAgdGV4dFN0eWxlLnRleHRPZmZzZXQgPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdvZmZzZXQnKTsKICAgIHZhciBsYWJlbFJvdGF0ZSA9IHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ3JvdGF0ZScpOwogICAgbGFiZWxSb3RhdGUgIT0gbnVsbCAmJiAobGFiZWxSb3RhdGUgKj0gTWF0aC5QSSAvIDE4MCk7CiAgICB0ZXh0U3R5bGUudGV4dFJvdGF0aW9uID0gbGFiZWxSb3RhdGU7CiAgICB0ZXh0U3R5bGUudGV4dERpc3RhbmNlID0genJVdGlsLnJldHJpZXZlMih0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdkaXN0YW5jZScpLCBpc0VtcGhhc2lzID8gbnVsbCA6IDUpOwogIH0KCiAgdmFyIGVjTW9kZWwgPSB0ZXh0U3R5bGVNb2RlbC5lY01vZGVsOwogIHZhciBnbG9iYWxUZXh0U3R5bGUgPSBlY01vZGVsICYmIGVjTW9kZWwub3B0aW9uLnRleHRTdHlsZTsgLy8gQ29uc2lkZXIgY2FzZToKICAvLyB7CiAgLy8gICAgIGRhdGE6IFt7CiAgLy8gICAgICAgICB2YWx1ZTogMTIsCiAgLy8gICAgICAgICBsYWJlbDogewogIC8vICAgICAgICAgICAgIHJpY2g6IHsKICAvLyAgICAgICAgICAgICAgICAgLy8gbm8gJ2EnIGhlcmUgYnV0IHVzaW5nIHBhcmVudCAnYScuCiAgLy8gICAgICAgICAgICAgfQogIC8vICAgICAgICAgfQogIC8vICAgICB9XSwKICAvLyAgICAgcmljaDogewogIC8vICAgICAgICAgYTogeyAuLi4gfQogIC8vICAgICB9CiAgLy8gfQoKICB2YXIgcmljaEl0ZW1OYW1lcyA9IGdldFJpY2hJdGVtTmFtZXModGV4dFN0eWxlTW9kZWwpOwogIHZhciByaWNoUmVzdWx0OwoKICBpZiAocmljaEl0ZW1OYW1lcykgewogICAgcmljaFJlc3VsdCA9IHt9OwoKICAgIGZvciAodmFyIG5hbWUgaW4gcmljaEl0ZW1OYW1lcykgewogICAgICBpZiAocmljaEl0ZW1OYW1lcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICAgIC8vIENhc2NhZGUgaXMgc3VwcG9ydGVkIGluIHJpY2guCiAgICAgICAgdmFyIHJpY2hUZXh0U3R5bGUgPSB0ZXh0U3R5bGVNb2RlbC5nZXRNb2RlbChbJ3JpY2gnLCBuYW1lXSk7IC8vIEluIHJpY2gsIG5ldmVyIGBkaXNhYmxlQm94YC4KICAgICAgICAvLyBGSVhNRTogY29uc2lkZXIgYGxhYmVsOiB7Zm9ybWF0dGVyOiAne2F8eHh9JywgY29sb3I6ICdibHVlJywgcmljaDoge2E6IHt9fX1gLAogICAgICAgIC8vIHRoZSBkZWZhdWx0IGNvbG9yIGAnYmx1ZSdgIHdpbGwgbm90IGJlIGFkb3B0ZWQgaWYgbm8gY29sb3IgZGVjbGFyZWQgaW4gYHJpY2hgLgogICAgICAgIC8vIFRoYXQgbWlnaHQgY29uZnVzZXMgdXNlcnMuIFNvIHByb2JhYmx5IHdlIHNob3VsZCBwdXQgYHRleHRTdHlsZU1vZGVsYCBhcyB0aGUKICAgICAgICAvLyByb290IGFuY2VzdG9yIG9mIHRoZSBgcmljaFRleHRTdHlsZWAuIEJ1dCB0aGF0IHdvdWxkIGJlIGEgYnJlYWsgY2hhbmdlLgoKICAgICAgICBzZXRUb2tlblRleHRTdHlsZShyaWNoUmVzdWx0W25hbWVdID0ge30sIHJpY2hUZXh0U3R5bGUsIGdsb2JhbFRleHRTdHlsZSwgb3B0LCBpc0VtcGhhc2lzKTsKICAgICAgfQogICAgfQogIH0KCiAgdGV4dFN0eWxlLnJpY2ggPSByaWNoUmVzdWx0OwogIHNldFRva2VuVGV4dFN0eWxlKHRleHRTdHlsZSwgdGV4dFN0eWxlTW9kZWwsIGdsb2JhbFRleHRTdHlsZSwgb3B0LCBpc0VtcGhhc2lzLCB0cnVlKTsKCiAgaWYgKG9wdC5mb3JjZVJpY2ggJiYgIW9wdC50ZXh0U3R5bGUpIHsKICAgIG9wdC50ZXh0U3R5bGUgPSB7fTsKICB9CgogIHJldHVybiB0ZXh0U3R5bGU7Cn0gLy8gQ29uc2lkZXIgY2FzZToKLy8gewovLyAgICAgZGF0YTogW3sKLy8gICAgICAgICB2YWx1ZTogMTIsCi8vICAgICAgICAgbGFiZWw6IHsKLy8gICAgICAgICAgICAgcmljaDogewovLyAgICAgICAgICAgICAgICAgLy8gbm8gJ2EnIGhlcmUgYnV0IHVzaW5nIHBhcmVudCAnYScuCi8vICAgICAgICAgICAgIH0KLy8gICAgICAgICB9Ci8vICAgICB9XSwKLy8gICAgIHJpY2g6IHsKLy8gICAgICAgICBhOiB7IC4uLiB9Ci8vICAgICB9Ci8vIH0KCgpmdW5jdGlvbiBnZXRSaWNoSXRlbU5hbWVzKHRleHRTdHlsZU1vZGVsKSB7CiAgLy8gVXNlIG9iamVjdCB0byByZW1vdmUgZHVwbGljYXRlZCBuYW1lcy4KICB2YXIgcmljaEl0ZW1OYW1lTWFwOwoKICB3aGlsZSAodGV4dFN0eWxlTW9kZWwgJiYgdGV4dFN0eWxlTW9kZWwgIT09IHRleHRTdHlsZU1vZGVsLmVjTW9kZWwpIHsKICAgIHZhciByaWNoID0gKHRleHRTdHlsZU1vZGVsLm9wdGlvbiB8fCBFTVBUWV9PQkopLnJpY2g7CgogICAgaWYgKHJpY2gpIHsKICAgICAgcmljaEl0ZW1OYW1lTWFwID0gcmljaEl0ZW1OYW1lTWFwIHx8IHt9OwoKICAgICAgZm9yICh2YXIgbmFtZSBpbiByaWNoKSB7CiAgICAgICAgaWYgKHJpY2guaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgICAgIHJpY2hJdGVtTmFtZU1hcFtuYW1lXSA9IDE7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdGV4dFN0eWxlTW9kZWwgPSB0ZXh0U3R5bGVNb2RlbC5wYXJlbnRNb2RlbDsKICB9CgogIHJldHVybiByaWNoSXRlbU5hbWVNYXA7Cn0KCmZ1bmN0aW9uIHNldFRva2VuVGV4dFN0eWxlKHRleHRTdHlsZSwgdGV4dFN0eWxlTW9kZWwsIGdsb2JhbFRleHRTdHlsZSwgb3B0LCBpc0VtcGhhc2lzLCBpc0Jsb2NrKSB7CiAgLy8gSW4gbWVyZ2UgbW9kZSwgZGVmYXVsdCB2YWx1ZSBzaG91bGQgbm90IGJlIGdpdmVuLgogIGdsb2JhbFRleHRTdHlsZSA9ICFpc0VtcGhhc2lzICYmIGdsb2JhbFRleHRTdHlsZSB8fCBFTVBUWV9PQko7CiAgdGV4dFN0eWxlLnRleHRGaWxsID0gZ2V0QXV0b0NvbG9yKHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ2NvbG9yJyksIG9wdCkgfHwgZ2xvYmFsVGV4dFN0eWxlLmNvbG9yOwogIHRleHRTdHlsZS50ZXh0U3Ryb2tlID0gZ2V0QXV0b0NvbG9yKHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ3RleHRCb3JkZXJDb2xvcicpLCBvcHQpIHx8IGdsb2JhbFRleHRTdHlsZS50ZXh0Qm9yZGVyQ29sb3I7CiAgdGV4dFN0eWxlLnRleHRTdHJva2VXaWR0aCA9IHpyVXRpbC5yZXRyaWV2ZTIodGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygndGV4dEJvcmRlcldpZHRoJyksIGdsb2JhbFRleHRTdHlsZS50ZXh0Qm9yZGVyV2lkdGgpOwoKICBpZiAoIWlzRW1waGFzaXMpIHsKICAgIGlmIChpc0Jsb2NrKSB7CiAgICAgIHRleHRTdHlsZS5pbnNpZGVSb2xsYmFja09wdCA9IG9wdDsKICAgICAgYXBwbHlEZWZhdWx0VGV4dFN0eWxlKHRleHRTdHlsZSk7CiAgICB9IC8vIFNldCBkZWZhdWx0IGZpbmFsbHkuCgoKICAgIGlmICh0ZXh0U3R5bGUudGV4dEZpbGwgPT0gbnVsbCkgewogICAgICB0ZXh0U3R5bGUudGV4dEZpbGwgPSBvcHQuYXV0b0NvbG9yOwogICAgfQogIH0gLy8gRG8gbm90IHVzZSBgZ2V0Rm9udGAgaGVyZSwgYmVjYXVzZSBtZXJnZSBzaG91bGQgYmUgc3VwcG9ydGVkLCB3aGVyZQogIC8vIHBhcnQgb2YgdGhlc2UgcHJvcGVydGllcyBtYXkgYmUgY2hhbmdlZCBpbiBlbXBoYXNpcyBzdHlsZSwgYW5kIHRoZQogIC8vIG90aGVycyBzaG91bGQgcmVtYWluIHRoZWlyIG9yaWdpbmFsIHZhbHVlIGdvdCBmcm9tIG5vcm1hbCBzdHlsZS4KCgogIHRleHRTdHlsZS5mb250U3R5bGUgPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdmb250U3R5bGUnKSB8fCBnbG9iYWxUZXh0U3R5bGUuZm9udFN0eWxlOwogIHRleHRTdHlsZS5mb250V2VpZ2h0ID0gdGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygnZm9udFdlaWdodCcpIHx8IGdsb2JhbFRleHRTdHlsZS5mb250V2VpZ2h0OwogIHRleHRTdHlsZS5mb250U2l6ZSA9IHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ2ZvbnRTaXplJykgfHwgZ2xvYmFsVGV4dFN0eWxlLmZvbnRTaXplOwogIHRleHRTdHlsZS5mb250RmFtaWx5ID0gdGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygnZm9udEZhbWlseScpIHx8IGdsb2JhbFRleHRTdHlsZS5mb250RmFtaWx5OwogIHRleHRTdHlsZS50ZXh0QWxpZ24gPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdhbGlnbicpOwogIHRleHRTdHlsZS50ZXh0VmVydGljYWxBbGlnbiA9IHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ3ZlcnRpY2FsQWxpZ24nKSB8fCB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdiYXNlbGluZScpOwogIHRleHRTdHlsZS50ZXh0TGluZUhlaWdodCA9IHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ2xpbmVIZWlnaHQnKTsKICB0ZXh0U3R5bGUudGV4dFdpZHRoID0gdGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygnd2lkdGgnKTsKICB0ZXh0U3R5bGUudGV4dEhlaWdodCA9IHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ2hlaWdodCcpOwogIHRleHRTdHlsZS50ZXh0VGFnID0gdGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygndGFnJyk7CgogIGlmICghaXNCbG9jayB8fCAhb3B0LmRpc2FibGVCb3gpIHsKICAgIHRleHRTdHlsZS50ZXh0QmFja2dyb3VuZENvbG9yID0gZ2V0QXV0b0NvbG9yKHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ2JhY2tncm91bmRDb2xvcicpLCBvcHQpOwogICAgdGV4dFN0eWxlLnRleHRQYWRkaW5nID0gdGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygncGFkZGluZycpOwogICAgdGV4dFN0eWxlLnRleHRCb3JkZXJDb2xvciA9IGdldEF1dG9Db2xvcih0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdib3JkZXJDb2xvcicpLCBvcHQpOwogICAgdGV4dFN0eWxlLnRleHRCb3JkZXJXaWR0aCA9IHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ2JvcmRlcldpZHRoJyk7CiAgICB0ZXh0U3R5bGUudGV4dEJvcmRlclJhZGl1cyA9IHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ2JvcmRlclJhZGl1cycpOwogICAgdGV4dFN0eWxlLnRleHRCb3hTaGFkb3dDb2xvciA9IHRleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ3NoYWRvd0NvbG9yJyk7CiAgICB0ZXh0U3R5bGUudGV4dEJveFNoYWRvd0JsdXIgPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdzaGFkb3dCbHVyJyk7CiAgICB0ZXh0U3R5bGUudGV4dEJveFNoYWRvd09mZnNldFggPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdzaGFkb3dPZmZzZXRYJyk7CiAgICB0ZXh0U3R5bGUudGV4dEJveFNoYWRvd09mZnNldFkgPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCdzaGFkb3dPZmZzZXRZJyk7CiAgfQoKICB0ZXh0U3R5bGUudGV4dFNoYWRvd0NvbG9yID0gdGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygndGV4dFNoYWRvd0NvbG9yJykgfHwgZ2xvYmFsVGV4dFN0eWxlLnRleHRTaGFkb3dDb2xvcjsKICB0ZXh0U3R5bGUudGV4dFNoYWRvd0JsdXIgPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCd0ZXh0U2hhZG93Qmx1cicpIHx8IGdsb2JhbFRleHRTdHlsZS50ZXh0U2hhZG93Qmx1cjsKICB0ZXh0U3R5bGUudGV4dFNoYWRvd09mZnNldFggPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCd0ZXh0U2hhZG93T2Zmc2V0WCcpIHx8IGdsb2JhbFRleHRTdHlsZS50ZXh0U2hhZG93T2Zmc2V0WDsKICB0ZXh0U3R5bGUudGV4dFNoYWRvd09mZnNldFkgPSB0ZXh0U3R5bGVNb2RlbC5nZXRTaGFsbG93KCd0ZXh0U2hhZG93T2Zmc2V0WScpIHx8IGdsb2JhbFRleHRTdHlsZS50ZXh0U2hhZG93T2Zmc2V0WTsKfQoKZnVuY3Rpb24gZ2V0QXV0b0NvbG9yKGNvbG9yLCBvcHQpIHsKICByZXR1cm4gY29sb3IgIT09ICdhdXRvJyA/IGNvbG9yIDogb3B0ICYmIG9wdC5hdXRvQ29sb3IgPyBvcHQuYXV0b0NvbG9yIDogbnVsbDsKfQovKioKICogR2l2ZSBzb21lIGRlZmF1bHQgdmFsdWUgdG8gdGhlIGlucHV0IGB0ZXh0U3R5bGVgIG9iamVjdCwgYmFzZWQgb24gdGhlIGN1cnJlbnQgc2V0dGluZ3MKICogaW4gdGhpcyBgdGV4dFN0eWxlYCBvYmplY3QuCiAqCiAqIFRoZSBTY2VuYXJpbzoKICogd2hlbiB0ZXh0IHBvc2l0aW9uIGlzIGBpbnNpZGVgIGFuZCBgdGV4dEZpbGxgIGlzIG5vdCBzcGVjaWZpZWQsIHdlIHNob3cKICogdGV4dCBib3JkZXIgYnkgZGVmYXVsdCBmb3IgYmV0dGVyIHZpZXcuIEJ1dCBpdCBzaG91bGQgYmUgY29uc2lkZXJlZCB0aGF0IHRleHQgcG9zaXRpb24KICogbWlnaHQgYmUgY2hhbmdlZCB3aGVuIGhvdmVyaW5nIG9yIGJlaW5nIGVtcGhhc2lzLCB3aGVyZSB0aGUgYGluc2lkZVJvbGxiYWNrYCBpcyB1c2VkIHRvCiAqIHJlc3RvcmUgdGhlIHN0eWxlLgogKgogKiBVc2FnZSAoJiBOT1RJQ0UpOgogKiBXaGVuIGEgc3R5bGUgb2JqZWN0IChlaXRob3IgcGxhaW4gb2JqZWN0IG9yIGluc3RhbmNlIG9mIGB6cmVuZGVyL3NyYy9ncmFwaGljL1N0eWxlYCkgaXMKICogYWJvdXQgdG8gYmUgbW9kaWZpZWQgb24gaXRzIHRleHQgcmVsYXRlZCBwcm9wZXJ0aWVzLCBgcm9sbGJhY2tEZWZhdWx0VGV4dFN0eWxlYCBzaG91bGQKICogYmUgY2FsbGVkIGJlZm9yZSB0aGUgbW9kaWZpY2F0aW9uIGFuZCBgYXBwbHlEZWZhdWx0VGV4dFN0eWxlYCBzaG91bGQgYmUgY2FsbGVkIGFmdGVyIHRoYXQuCiAqIChGb3IgdGhlIGNhc2UgdGhhdCBhbGwgb2YgdGhlIHRleHQgcmVsYXRlZCBwcm9wZXJ0aWVzIGlzIHJlc2V0LCBsaWtlIGBzZXRUZXh0U3R5bGVDb21tb25gCiAqIGRvZXMsIGByb2xsYmFja0RlZmF1bHRUZXh0U3R5bGVgIGlzIG5vdCBuZWVkZWQgdG8gYmUgY2FsbGVkKS4KICovCgoKZnVuY3Rpb24gYXBwbHlEZWZhdWx0VGV4dFN0eWxlKHRleHRTdHlsZSkgewogIHZhciB0ZXh0UG9zaXRpb24gPSB0ZXh0U3R5bGUudGV4dFBvc2l0aW9uOwogIHZhciBvcHQgPSB0ZXh0U3R5bGUuaW5zaWRlUm9sbGJhY2tPcHQ7CiAgdmFyIGluc2lkZVJvbGxiYWNrOwoKICBpZiAob3B0ICYmIHRleHRTdHlsZS50ZXh0RmlsbCA9PSBudWxsKSB7CiAgICB2YXIgYXV0b0NvbG9yID0gb3B0LmF1dG9Db2xvcjsKICAgIHZhciBpc1JlY3RUZXh0ID0gb3B0LmlzUmVjdFRleHQ7CiAgICB2YXIgdXNlSW5zaWRlU3R5bGUgPSBvcHQudXNlSW5zaWRlU3R5bGU7CiAgICB2YXIgdXNlSW5zaWRlU3R5bGVDYWNoZSA9IHVzZUluc2lkZVN0eWxlICE9PSBmYWxzZSAmJiAodXNlSW5zaWRlU3R5bGUgPT09IHRydWUgfHwgaXNSZWN0VGV4dCAmJiB0ZXh0UG9zaXRpb24gLy8gdGV4dFBvc2l0aW9uIGNhbiBiZSBbMTAsIDMwXQogICAgJiYgdHlwZW9mIHRleHRQb3NpdGlvbiA9PT0gJ3N0cmluZycgJiYgdGV4dFBvc2l0aW9uLmluZGV4T2YoJ2luc2lkZScpID49IDApOwogICAgdmFyIHVzZUF1dG9Db2xvckNhY2hlID0gIXVzZUluc2lkZVN0eWxlQ2FjaGUgJiYgYXV0b0NvbG9yICE9IG51bGw7IC8vIEFsbCBvZiB0aGUgcHJvcHMgZGVjbGFyZWQgaW4gYENBQ0hFRF9MQUJFTF9TVFlMRV9QUk9QRVJUSUVTYCBhcmUgdG8gYmUgY2FjaGVkLgoKICAgIGlmICh1c2VJbnNpZGVTdHlsZUNhY2hlIHx8IHVzZUF1dG9Db2xvckNhY2hlKSB7CiAgICAgIGluc2lkZVJvbGxiYWNrID0gewogICAgICAgIHRleHRGaWxsOiB0ZXh0U3R5bGUudGV4dEZpbGwsCiAgICAgICAgdGV4dFN0cm9rZTogdGV4dFN0eWxlLnRleHRTdHJva2UsCiAgICAgICAgdGV4dFN0cm9rZVdpZHRoOiB0ZXh0U3R5bGUudGV4dFN0cm9rZVdpZHRoCiAgICAgIH07CiAgICB9CgogICAgaWYgKHVzZUluc2lkZVN0eWxlQ2FjaGUpIHsKICAgICAgdGV4dFN0eWxlLnRleHRGaWxsID0gJyNmZmYnOyAvLyBDb25zaWRlciB0ZXh0IHdpdGggI2ZmZiBvdmVyZmxvdyBpdHMgY29udGFpbmVyLgoKICAgICAgaWYgKHRleHRTdHlsZS50ZXh0U3Ryb2tlID09IG51bGwpIHsKICAgICAgICB0ZXh0U3R5bGUudGV4dFN0cm9rZSA9IGF1dG9Db2xvcjsKICAgICAgICB0ZXh0U3R5bGUudGV4dFN0cm9rZVdpZHRoID09IG51bGwgJiYgKHRleHRTdHlsZS50ZXh0U3Ryb2tlV2lkdGggPSAyKTsKICAgICAgfQogICAgfQoKICAgIGlmICh1c2VBdXRvQ29sb3JDYWNoZSkgewogICAgICB0ZXh0U3R5bGUudGV4dEZpbGwgPSBhdXRvQ29sb3I7CiAgICB9CiAgfSAvLyBBbHdheXMgc2V0IGBpbnNpZGVSb2xsYmFja2AsIHNvIHRoYXQgdGhlIHByZXZpb3VzIG9uZSBjYW4gYmUgY2xlYXJlZC4KCgogIHRleHRTdHlsZS5pbnNpZGVSb2xsYmFjayA9IGluc2lkZVJvbGxiYWNrOwp9Ci8qKgogKiBDb25zaWRlciB0aGUgY2FzZTogaW4gYSBzY2F0dGVyLAogKiBsYWJlbDogewogKiAgICAgbm9ybWFsOiB7cG9zaXRpb246ICdpbnNpZGUnfSwKICogICAgIGVtcGhhc2lzOiB7cG9zaXRpb246ICd0b3AnfQogKiB9CiAqIEluIHRoZSBub3JtYWwgc3RhdGUsIHRoZSBgdGV4dEZpbGxgIHdpbGwgYmUgc2V0IGFzICcjZmZmJyBmb3IgcHJldHR5IHZpZXcgKHNlZQogKiBgYXBwbHlEZWZhdWx0VGV4dFN0eWxlYCksIGJ1dCB3aGVuIHN3aXRjaGluZyB0byBlbXBoYXNpcyBzdGF0ZSwgdGhlIGB0ZXh0RmlsbGAKICogc2hvdWxkIGJlIHJldHVyZWQgdG8gJ2F1dG9Db2xvcicsIGJ1dCBub3Qga2VlcCAnI2ZmZicuCiAqLwoKCmZ1bmN0aW9uIHJvbGxiYWNrRGVmYXVsdFRleHRTdHlsZShzdHlsZSkgewogIHZhciBpbnNpZGVSb2xsYmFjayA9IHN0eWxlLmluc2lkZVJvbGxiYWNrOwoKICBpZiAoaW5zaWRlUm9sbGJhY2spIHsKICAgIC8vIFJlc2V0IGFsbCBvZiB0aGUgcHJvcHMgaW4gYENBQ0hFRF9MQUJFTF9TVFlMRV9QUk9QRVJUSUVTYC4KICAgIHN0eWxlLnRleHRGaWxsID0gaW5zaWRlUm9sbGJhY2sudGV4dEZpbGw7CiAgICBzdHlsZS50ZXh0U3Ryb2tlID0gaW5zaWRlUm9sbGJhY2sudGV4dFN0cm9rZTsKICAgIHN0eWxlLnRleHRTdHJva2VXaWR0aCA9IGluc2lkZVJvbGxiYWNrLnRleHRTdHJva2VXaWR0aDsKICAgIHN0eWxlLmluc2lkZVJvbGxiYWNrID0gbnVsbDsKICB9Cn0KCmZ1bmN0aW9uIGdldEZvbnQob3B0LCBlY01vZGVsKSB7CiAgdmFyIGdUZXh0U3R5bGVNb2RlbCA9IGVjTW9kZWwgJiYgZWNNb2RlbC5nZXRNb2RlbCgndGV4dFN0eWxlJyk7CiAgcmV0dXJuIHpyVXRpbC50cmltKFsvLyBGSVhNRSBpbiBub2RlLWNhbnZhcyBmb250V2VpZ2h0IGlzIGJlZm9yZSBmb250U3R5bGUKICBvcHQuZm9udFN0eWxlIHx8IGdUZXh0U3R5bGVNb2RlbCAmJiBnVGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygnZm9udFN0eWxlJykgfHwgJycsIG9wdC5mb250V2VpZ2h0IHx8IGdUZXh0U3R5bGVNb2RlbCAmJiBnVGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygnZm9udFdlaWdodCcpIHx8ICcnLCAob3B0LmZvbnRTaXplIHx8IGdUZXh0U3R5bGVNb2RlbCAmJiBnVGV4dFN0eWxlTW9kZWwuZ2V0U2hhbGxvdygnZm9udFNpemUnKSB8fCAxMikgKyAncHgnLCBvcHQuZm9udEZhbWlseSB8fCBnVGV4dFN0eWxlTW9kZWwgJiYgZ1RleHRTdHlsZU1vZGVsLmdldFNoYWxsb3coJ2ZvbnRGYW1pbHknKSB8fCAnc2Fucy1zZXJpZiddLmpvaW4oJyAnKSk7Cn0KCmZ1bmN0aW9uIGFuaW1hdGVPclNldFByb3BzKGlzVXBkYXRlLCBlbCwgcHJvcHMsIGFuaW1hdGFibGVNb2RlbCwgZGF0YUluZGV4LCBjYikgewogIGlmICh0eXBlb2YgZGF0YUluZGV4ID09PSAnZnVuY3Rpb24nKSB7CiAgICBjYiA9IGRhdGFJbmRleDsKICAgIGRhdGFJbmRleCA9IG51bGw7CiAgfSAvLyBEbyBub3QgY2hlY2sgJ2FuaW1hdGlvbicgcHJvcGVydHkgZGlyZWN0bHkgaGVyZS4gQ29uc2lkZXIgdGhpcyBjYXNlOgogIC8vIGFuaW1hdGlvbiBtb2RlbCBpcyBhbiBgaXRlbU1vZGVsYCwgd2hvc2UgZG9lcyBub3QgaGF2ZSBgaXNBbmltYXRpb25FbmFibGVkYAogIC8vIGJ1dCBpdHMgcGFyZW50IG1vZGVsIChgc2VyaWVzTW9kZWxgKSBkb2VzLgoKCiAgdmFyIGFuaW1hdGlvbkVuYWJsZWQgPSBhbmltYXRhYmxlTW9kZWwgJiYgYW5pbWF0YWJsZU1vZGVsLmlzQW5pbWF0aW9uRW5hYmxlZCgpOwoKICBpZiAoYW5pbWF0aW9uRW5hYmxlZCkgewogICAgdmFyIHBvc3RmaXggPSBpc1VwZGF0ZSA/ICdVcGRhdGUnIDogJyc7CiAgICB2YXIgZHVyYXRpb24gPSBhbmltYXRhYmxlTW9kZWwuZ2V0U2hhbGxvdygnYW5pbWF0aW9uRHVyYXRpb24nICsgcG9zdGZpeCk7CiAgICB2YXIgYW5pbWF0aW9uRWFzaW5nID0gYW5pbWF0YWJsZU1vZGVsLmdldFNoYWxsb3coJ2FuaW1hdGlvbkVhc2luZycgKyBwb3N0Zml4KTsKICAgIHZhciBhbmltYXRpb25EZWxheSA9IGFuaW1hdGFibGVNb2RlbC5nZXRTaGFsbG93KCdhbmltYXRpb25EZWxheScgKyBwb3N0Zml4KTsKCiAgICBpZiAodHlwZW9mIGFuaW1hdGlvbkRlbGF5ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGFuaW1hdGlvbkRlbGF5ID0gYW5pbWF0aW9uRGVsYXkoZGF0YUluZGV4LCBhbmltYXRhYmxlTW9kZWwuZ2V0QW5pbWF0aW9uRGVsYXlQYXJhbXMgPyBhbmltYXRhYmxlTW9kZWwuZ2V0QW5pbWF0aW9uRGVsYXlQYXJhbXMoZWwsIGRhdGFJbmRleCkgOiBudWxsKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGR1cmF0aW9uID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24oZGF0YUluZGV4KTsKICAgIH0KCiAgICBkdXJhdGlvbiA+IDAgPyBlbC5hbmltYXRlVG8ocHJvcHMsIGR1cmF0aW9uLCBhbmltYXRpb25EZWxheSB8fCAwLCBhbmltYXRpb25FYXNpbmcsIGNiLCAhIWNiKSA6IChlbC5zdG9wQW5pbWF0aW9uKCksIGVsLmF0dHIocHJvcHMpLCBjYiAmJiBjYigpKTsKICB9IGVsc2UgewogICAgZWwuc3RvcEFuaW1hdGlvbigpOwogICAgZWwuYXR0cihwcm9wcyk7CiAgICBjYiAmJiBjYigpOwogIH0KfQovKioKICogVXBkYXRlIGdyYXBoaWMgZWxlbWVudCBwcm9wZXJ0aWVzIHdpdGggb3Igd2l0aG91dCBhbmltYXRpb24gYWNjb3JkaW5nIHRvIHRoZQogKiBjb25maWd1cmF0aW9uIGluIHNlcmllcy4KICoKICogQ2F1dGlvbjogdGhpcyBtZXRob2Qgd2lsbCBzdG9wIHByZXZpb3VzIGFuaW1hdGlvbi4KICogU28gZG8gbm90IHVzZSB0aGlzIG1ldGhvZCB0byBvbmUgZWxlbWVudCB0d2ljZSBiZWZvcmUKICogYW5pbWF0aW9uIHN0YXJ0cywgdW5sZXNzIHlvdSBrbm93IHdoYXQgeW91IGFyZSBkb2luZy4KICoKICogQHBhcmFtIHttb2R1bGU6enJlbmRlci9FbGVtZW50fSBlbAogKiBAcGFyYW0ge09iamVjdH0gcHJvcHMKICogQHBhcmFtIHttb2R1bGU6ZWNoYXJ0cy9tb2RlbC9Nb2RlbH0gW2FuaW1hdGFibGVNb2RlbF0KICogQHBhcmFtIHtudW1iZXJ9IFtkYXRhSW5kZXhdCiAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYl0KICogQGV4YW1wbGUKICogICAgIGdyYXBoaWMudXBkYXRlUHJvcHMoZWwsIHsKICogICAgICAgICBwb3NpdGlvbjogWzEwMCwgMTAwXQogKiAgICAgfSwgc2VyaWVzTW9kZWwsIGRhdGFJbmRleCwgZnVuY3Rpb24gKCkgeyBjb25zb2xlLmxvZygnQW5pbWF0aW9uIGRvbmUhJyk7IH0pOwogKiAgICAgLy8gT3IKICogICAgIGdyYXBoaWMudXBkYXRlUHJvcHMoZWwsIHsKICogICAgICAgICBwb3NpdGlvbjogWzEwMCwgMTAwXQogKiAgICAgfSwgc2VyaWVzTW9kZWwsIGZ1bmN0aW9uICgpIHsgY29uc29sZS5sb2coJ0FuaW1hdGlvbiBkb25lIScpOyB9KTsKICovCgoKZnVuY3Rpb24gdXBkYXRlUHJvcHMoZWwsIHByb3BzLCBhbmltYXRhYmxlTW9kZWwsIGRhdGFJbmRleCwgY2IpIHsKICBhbmltYXRlT3JTZXRQcm9wcyh0cnVlLCBlbCwgcHJvcHMsIGFuaW1hdGFibGVNb2RlbCwgZGF0YUluZGV4LCBjYik7Cn0KLyoqCiAqIEluaXQgZ3JhcGhpYyBlbGVtZW50IHByb3BlcnRpZXMgd2l0aCBvciB3aXRob3V0IGFuaW1hdGlvbiBhY2NvcmRpbmcgdG8gdGhlCiAqIGNvbmZpZ3VyYXRpb24gaW4gc2VyaWVzLgogKgogKiBDYXV0aW9uOiB0aGlzIG1ldGhvZCB3aWxsIHN0b3AgcHJldmlvdXMgYW5pbWF0aW9uLgogKiBTbyBkbyBub3QgdXNlIHRoaXMgbWV0aG9kIHRvIG9uZSBlbGVtZW50IHR3aWNlIGJlZm9yZQogKiBhbmltYXRpb24gc3RhcnRzLCB1bmxlc3MgeW91IGtub3cgd2hhdCB5b3UgYXJlIGRvaW5nLgogKgogKiBAcGFyYW0ge21vZHVsZTp6cmVuZGVyL0VsZW1lbnR9IGVsCiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wcwogKiBAcGFyYW0ge21vZHVsZTplY2hhcnRzL21vZGVsL01vZGVsfSBbYW5pbWF0YWJsZU1vZGVsXQogKiBAcGFyYW0ge251bWJlcn0gW2RhdGFJbmRleF0KICogQHBhcmFtIHtGdW5jdGlvbn0gY2IKICovCgoKZnVuY3Rpb24gaW5pdFByb3BzKGVsLCBwcm9wcywgYW5pbWF0YWJsZU1vZGVsLCBkYXRhSW5kZXgsIGNiKSB7CiAgYW5pbWF0ZU9yU2V0UHJvcHMoZmFsc2UsIGVsLCBwcm9wcywgYW5pbWF0YWJsZU1vZGVsLCBkYXRhSW5kZXgsIGNiKTsKfQovKioKICogR2V0IHRyYW5zZm9ybSBtYXRyaXggb2YgdGFyZ2V0IChwYXJhbSB0YXJnZXQpLAogKiBpbiBjb29yZGluYXRlIG9mIGl0cyBhbmNlc3RvciAocGFyYW0gYW5jZXN0b3IpCiAqCiAqIEBwYXJhbSB7bW9kdWxlOnpyZW5kZXIvbWl4aW4vVHJhbnNmb3JtYWJsZX0gdGFyZ2V0CiAqIEBwYXJhbSB7bW9kdWxlOnpyZW5kZXIvbWl4aW4vVHJhbnNmb3JtYWJsZX0gW2FuY2VzdG9yXQogKi8KCgpmdW5jdGlvbiBnZXRUcmFuc2Zvcm0odGFyZ2V0LCBhbmNlc3RvcikgewogIHZhciBtYXQgPSBtYXRyaXguaWRlbnRpdHkoW10pOwoKICB3aGlsZSAodGFyZ2V0ICYmIHRhcmdldCAhPT0gYW5jZXN0b3IpIHsKICAgIG1hdHJpeC5tdWwobWF0LCB0YXJnZXQuZ2V0TG9jYWxUcmFuc2Zvcm0oKSwgbWF0KTsKICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnQ7CiAgfQoKICByZXR1cm4gbWF0Owp9Ci8qKgogKiBBcHBseSB0cmFuc2Zvcm0gdG8gYW4gdmVydGV4LgogKiBAcGFyYW0ge0FycmF5LjxudW1iZXI+fSB0YXJnZXQgW3gsIHldCiAqIEBwYXJhbSB7QXJyYXkuPG51bWJlcj58VHlwZWRBcnJheS48bnVtYmVyPnxPYmplY3R9IHRyYW5zZm9ybSBDYW4gYmU6CiAqICAgICAgKyBUcmFuc2Zvcm0gbWF0cml4OiBsaWtlIFsxLCAwLCAwLCAxLCAwLCAwXQogKiAgICAgICsge3Bvc2l0aW9uLCByb3RhdGlvbiwgc2NhbGV9LCB0aGUgc2FtZSBhcyBgenJlbmRlci9UcmFuc2Zvcm1hYmxlYC4KICogQHBhcmFtIHtib29sZWFuPX0gaW52ZXJ0IFdoZXRoZXIgdXNlIGludmVydCBtYXRyaXguCiAqIEByZXR1cm4ge0FycmF5LjxudW1iZXI+fSBbeCwgeV0KICovCgoKZnVuY3Rpb24gYXBwbHlUcmFuc2Zvcm0odGFyZ2V0LCB0cmFuc2Zvcm0sIGludmVydCkgewogIGlmICh0cmFuc2Zvcm0gJiYgIXpyVXRpbC5pc0FycmF5TGlrZSh0cmFuc2Zvcm0pKSB7CiAgICB0cmFuc2Zvcm0gPSBUcmFuc2Zvcm1hYmxlLmdldExvY2FsVHJhbnNmb3JtKHRyYW5zZm9ybSk7CiAgfQoKICBpZiAoaW52ZXJ0KSB7CiAgICB0cmFuc2Zvcm0gPSBtYXRyaXguaW52ZXJ0KFtdLCB0cmFuc2Zvcm0pOwogIH0KCiAgcmV0dXJuIHZlY3Rvci5hcHBseVRyYW5zZm9ybShbXSwgdGFyZ2V0LCB0cmFuc2Zvcm0pOwp9Ci8qKgogKiBAcGFyYW0ge3N0cmluZ30gZGlyZWN0aW9uICdsZWZ0JyAncmlnaHQnICd0b3AnICdib3R0b20nCiAqIEBwYXJhbSB7QXJyYXkuPG51bWJlcj59IHRyYW5zZm9ybSBUcmFuc2Zvcm0gbWF0cml4OiBsaWtlIFsxLCAwLCAwLCAxLCAwLCAwXQogKiBAcGFyYW0ge2Jvb2xlYW49fSBpbnZlcnQgV2hldGhlciB1c2UgaW52ZXJ0IG1hdHJpeC4KICogQHJldHVybiB7c3RyaW5nfSBUcmFuc2Zvcm1lZCBkaXJlY3Rpb24uICdsZWZ0JyAncmlnaHQnICd0b3AnICdib3R0b20nCiAqLwoKCmZ1bmN0aW9uIHRyYW5zZm9ybURpcmVjdGlvbihkaXJlY3Rpb24sIHRyYW5zZm9ybSwgaW52ZXJ0KSB7CiAgLy8gUGljayBhIGJhc2UsIGVuc3VyZSB0aGF0IHRyYW5zZm9ybSByZXN1bHQgd2lsbCBub3QgYmUgKDAsIDApLgogIHZhciBoQmFzZSA9IHRyYW5zZm9ybVs0XSA9PT0gMCB8fCB0cmFuc2Zvcm1bNV0gPT09IDAgfHwgdHJhbnNmb3JtWzBdID09PSAwID8gMSA6IE1hdGguYWJzKDIgKiB0cmFuc2Zvcm1bNF0gLyB0cmFuc2Zvcm1bMF0pOwogIHZhciB2QmFzZSA9IHRyYW5zZm9ybVs0XSA9PT0gMCB8fCB0cmFuc2Zvcm1bNV0gPT09IDAgfHwgdHJhbnNmb3JtWzJdID09PSAwID8gMSA6IE1hdGguYWJzKDIgKiB0cmFuc2Zvcm1bNF0gLyB0cmFuc2Zvcm1bMl0pOwogIHZhciB2ZXJ0ZXggPSBbZGlyZWN0aW9uID09PSAnbGVmdCcgPyAtaEJhc2UgOiBkaXJlY3Rpb24gPT09ICdyaWdodCcgPyBoQmFzZSA6IDAsIGRpcmVjdGlvbiA9PT0gJ3RvcCcgPyAtdkJhc2UgOiBkaXJlY3Rpb24gPT09ICdib3R0b20nID8gdkJhc2UgOiAwXTsKICB2ZXJ0ZXggPSBhcHBseVRyYW5zZm9ybSh2ZXJ0ZXgsIHRyYW5zZm9ybSwgaW52ZXJ0KTsKICByZXR1cm4gTWF0aC5hYnModmVydGV4WzBdKSA+IE1hdGguYWJzKHZlcnRleFsxXSkgPyB2ZXJ0ZXhbMF0gPiAwID8gJ3JpZ2h0JyA6ICdsZWZ0JyA6IHZlcnRleFsxXSA+IDAgPyAnYm90dG9tJyA6ICd0b3AnOwp9Ci8qKgogKiBBcHBseSBncm91cCB0cmFuc2l0aW9uIGFuaW1hdGlvbiBmcm9tIGcxIHRvIGcyLgogKiBJZiBubyBhbmltYXRhYmxlTW9kZWwsIG5vIGFuaW1hdGlvbi4KICovCgoKZnVuY3Rpb24gZ3JvdXBUcmFuc2l0aW9uKGcxLCBnMiwgYW5pbWF0YWJsZU1vZGVsLCBjYikgewogIGlmICghZzEgfHwgIWcyKSB7CiAgICByZXR1cm47CiAgfQoKICBmdW5jdGlvbiBnZXRFbE1hcChnKSB7CiAgICB2YXIgZWxNYXAgPSB7fTsKICAgIGcudHJhdmVyc2UoZnVuY3Rpb24gKGVsKSB7CiAgICAgIGlmICghZWwuaXNHcm91cCAmJiBlbC5hbmlkKSB7CiAgICAgICAgZWxNYXBbZWwuYW5pZF0gPSBlbDsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gZWxNYXA7CiAgfQoKICBmdW5jdGlvbiBnZXRBbmltYXRhYmxlUHJvcHMoZWwpIHsKICAgIHZhciBvYmogPSB7CiAgICAgIHBvc2l0aW9uOiB2ZWN0b3IuY2xvbmUoZWwucG9zaXRpb24pLAogICAgICByb3RhdGlvbjogZWwucm90YXRpb24KICAgIH07CgogICAgaWYgKGVsLnNoYXBlKSB7CiAgICAgIG9iai5zaGFwZSA9IHpyVXRpbC5leHRlbmQoe30sIGVsLnNoYXBlKTsKICAgIH0KCiAgICByZXR1cm4gb2JqOwogIH0KCiAgdmFyIGVsTWFwMSA9IGdldEVsTWFwKGcxKTsKICBnMi50cmF2ZXJzZShmdW5jdGlvbiAoZWwpIHsKICAgIGlmICghZWwuaXNHcm91cCAmJiBlbC5hbmlkKSB7CiAgICAgIHZhciBvbGRFbCA9IGVsTWFwMVtlbC5hbmlkXTsKCiAgICAgIGlmIChvbGRFbCkgewogICAgICAgIHZhciBuZXdQcm9wID0gZ2V0QW5pbWF0YWJsZVByb3BzKGVsKTsKICAgICAgICBlbC5hdHRyKGdldEFuaW1hdGFibGVQcm9wcyhvbGRFbCkpOwogICAgICAgIHVwZGF0ZVByb3BzKGVsLCBuZXdQcm9wLCBhbmltYXRhYmxlTW9kZWwsIGVsLmRhdGFJbmRleCk7CiAgICAgIH0gLy8gZWxzZSB7CiAgICAgIC8vICAgICBpZiAoZWwucHJldmlvdXNQcm9wcykgewogICAgICAvLyAgICAgICAgIGdyYXBoaWMudXBkYXRlUHJvcHMKICAgICAgLy8gICAgIH0KICAgICAgLy8gfQoKICAgIH0KICB9KTsKfQovKioKICogQHBhcmFtIHtBcnJheS48QXJyYXkuPG51bWJlcj4+fSBwb2ludHMgTGlrZTogW1syMywgNDRdLCBbNTMsIDY2XSwgLi4uXQogKiBAcGFyYW0ge09iamVjdH0gcmVjdCB7eCwgeSwgd2lkdGgsIGhlaWdodH0KICogQHJldHVybiB7QXJyYXkuPEFycmF5LjxudW1iZXI+Pn0gQSBuZXcgY2xpcHBlZCBwb2ludHMuCiAqLwoKCmZ1bmN0aW9uIGNsaXBQb2ludHNCeVJlY3QocG9pbnRzLCByZWN0KSB7CiAgLy8gRklYTUU6IHRoaXMgd2F5IG1pZ3RoIGJlIGluY29ycmVjdCB3aGVuIGdycGFoaWMgY2xpcHBlZCBieSBhIGNvcm5lci4KICAvLyBhbmQgd2hlbiBlbGVtZW50IGhhdmUgYm9yZGVyLgogIHJldHVybiB6clV0aWwubWFwKHBvaW50cywgZnVuY3Rpb24gKHBvaW50KSB7CiAgICB2YXIgeCA9IHBvaW50WzBdOwogICAgeCA9IG1hdGhNYXgoeCwgcmVjdC54KTsKICAgIHggPSBtYXRoTWluKHgsIHJlY3QueCArIHJlY3Qud2lkdGgpOwogICAgdmFyIHkgPSBwb2ludFsxXTsKICAgIHkgPSBtYXRoTWF4KHksIHJlY3QueSk7CiAgICB5ID0gbWF0aE1pbih5LCByZWN0LnkgKyByZWN0LmhlaWdodCk7CiAgICByZXR1cm4gW3gsIHldOwogIH0pOwp9Ci8qKgogKiBAcGFyYW0ge09iamVjdH0gdGFyZ2V0UmVjdCB7eCwgeSwgd2lkdGgsIGhlaWdodH0KICogQHBhcmFtIHtPYmplY3R9IHJlY3Qge3gsIHksIHdpZHRoLCBoZWlnaHR9CiAqIEByZXR1cm4ge09iamVjdH0gQSBuZXcgY2xpcHBlZCByZWN0LiBJZiByZWN0IHNpemUgYXJlIG5lZ2F0aXZlLCByZXR1cm4gdW5kZWZpbmVkLgogKi8KCgpmdW5jdGlvbiBjbGlwUmVjdEJ5UmVjdCh0YXJnZXRSZWN0LCByZWN0KSB7CiAgdmFyIHggPSBtYXRoTWF4KHRhcmdldFJlY3QueCwgcmVjdC54KTsKICB2YXIgeDIgPSBtYXRoTWluKHRhcmdldFJlY3QueCArIHRhcmdldFJlY3Qud2lkdGgsIHJlY3QueCArIHJlY3Qud2lkdGgpOwogIHZhciB5ID0gbWF0aE1heCh0YXJnZXRSZWN0LnksIHJlY3QueSk7CiAgdmFyIHkyID0gbWF0aE1pbih0YXJnZXRSZWN0LnkgKyB0YXJnZXRSZWN0LmhlaWdodCwgcmVjdC55ICsgcmVjdC5oZWlnaHQpOyAvLyBJZiB0aGUgdG90YWwgcmVjdCBpcyBjbGlwZWQsIG5vdGhpbmcsIGluY2x1ZGluZyB0aGUgYm9yZGVyLAogIC8vIHNob3VsZCBiZSBwYWludGVkLiBTbyByZXR1cm4gdW5kZWZpbmVkLgoKICBpZiAoeDIgPj0geCAmJiB5MiA+PSB5KSB7CiAgICByZXR1cm4gewogICAgICB4OiB4LAogICAgICB5OiB5LAogICAgICB3aWR0aDogeDIgLSB4LAogICAgICBoZWlnaHQ6IHkyIC0geQogICAgfTsKICB9Cn0KLyoqCiAqIEBwYXJhbSB7c3RyaW5nfSBpY29uU3RyIFN1cHBvcnQgJ2ltYWdlOi8vJyBvciAncGF0aDovLycgb3IgZGlyZWN0IHN2ZyBwYXRoLgogKiBAcGFyYW0ge09iamVjdH0gW29wdF0gUHJvcGVydGllcyBvZiBgbW9kdWxlOnpyZW5kZXIvRWxlbWVudGAsIGV4Y2VwdCBgc3R5bGVgLgogKiBAcGFyYW0ge09iamVjdH0gW3JlY3RdIHt4LCB5LCB3aWR0aCwgaGVpZ2h0fQogKiBAcmV0dXJuIHttb2R1bGU6enJlbmRlci9FbGVtZW50fSBJY29uIHBhdGggb3IgaW1hZ2UgZWxlbWVudC4KICovCgoKZnVuY3Rpb24gY3JlYXRlSWNvbihpY29uU3RyLCBvcHQsIHJlY3QpIHsKICBvcHQgPSB6clV0aWwuZXh0ZW5kKHsKICAgIHJlY3RIb3ZlcjogdHJ1ZQogIH0sIG9wdCk7CiAgdmFyIHN0eWxlID0gb3B0LnN0eWxlID0gewogICAgc3Ryb2tlTm9TY2FsZTogdHJ1ZQogIH07CiAgcmVjdCA9IHJlY3QgfHwgewogICAgeDogLTEsCiAgICB5OiAtMSwKICAgIHdpZHRoOiAyLAogICAgaGVpZ2h0OiAyCiAgfTsKCiAgaWYgKGljb25TdHIpIHsKICAgIHJldHVybiBpY29uU3RyLmluZGV4T2YoJ2ltYWdlOi8vJykgPT09IDAgPyAoc3R5bGUuaW1hZ2UgPSBpY29uU3RyLnNsaWNlKDgpLCB6clV0aWwuZGVmYXVsdHMoc3R5bGUsIHJlY3QpLCBuZXcgWkltYWdlKG9wdCkpIDogbWFrZVBhdGgoaWNvblN0ci5yZXBsYWNlKCdwYXRoOi8vJywgJycpLCBvcHQsIHJlY3QsICdjZW50ZXInKTsKICB9Cn0KLyoqCiAqIFJldHVybiBgdHJ1ZWAgaWYgdGhlIGdpdmVuIGxpbmUgKGxpbmUgYGFgKSBhbmQgdGhlIGdpdmVuIHBvbHlnb24KICogYXJlIGludGVyc2VjdC4KICogTm90ZSB0aGF0IHdlIGRvIG5vdCBjb3VudCBjb2xpbmVhciBhcyBpbnRlcnNlY3QgaGVyZSBiZWNhdXNlIG5vCiAqIHJlcXVpcmVtZW50IGZvciB0aGF0LiBXZSBjb3VsZCBkbyB0aGF0IGlmIHJlcXVpcmVkIGluIGZ1dHVyZS4KICoKICogQHBhcmFtIHtudW1iZXJ9IGExeAogKiBAcGFyYW0ge251bWJlcn0gYTF5CiAqIEBwYXJhbSB7bnVtYmVyfSBhMngKICogQHBhcmFtIHtudW1iZXJ9IGEyeQogKiBAcGFyYW0ge0FycmF5LjxBcnJheS48bnVtYmVyPj59IHBvaW50cyBQb2ludHMgb2YgdGhlIHBvbHlnb24uCiAqIEByZXR1cm4ge2Jvb2xlYW59CiAqLwoKCmZ1bmN0aW9uIGxpbmVQb2x5Z29uSW50ZXJzZWN0KGExeCwgYTF5LCBhMngsIGEyeSwgcG9pbnRzKSB7CiAgZm9yICh2YXIgaSA9IDAsIHAyID0gcG9pbnRzW3BvaW50cy5sZW5ndGggLSAxXTsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHAgPSBwb2ludHNbaV07CgogICAgaWYgKGxpbmVMaW5lSW50ZXJzZWN0KGExeCwgYTF5LCBhMngsIGEyeSwgcFswXSwgcFsxXSwgcDJbMF0sIHAyWzFdKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwMiA9IHA7CiAgfQp9Ci8qKgogKiBSZXR1cm4gYHRydWVgIGlmIHRoZSBnaXZlbiB0d28gbGluZXMgKGxpbmUgYGFgIGFuZCBsaW5lIGBiYCkKICogYXJlIGludGVyc2VjdC4KICogTm90ZSB0aGF0IHdlIGRvIG5vdCBjb3VudCBjb2xpbmVhciBhcyBpbnRlcnNlY3QgaGVyZSBiZWNhdXNlIG5vCiAqIHJlcXVpcmVtZW50IGZvciB0aGF0LiBXZSBjb3VsZCBkbyB0aGF0IGlmIHJlcXVpcmVkIGluIGZ1dHVyZS4KICoKICogQHBhcmFtIHtudW1iZXJ9IGExeAogKiBAcGFyYW0ge251bWJlcn0gYTF5CiAqIEBwYXJhbSB7bnVtYmVyfSBhMngKICogQHBhcmFtIHtudW1iZXJ9IGEyeQogKiBAcGFyYW0ge251bWJlcn0gYjF4CiAqIEBwYXJhbSB7bnVtYmVyfSBiMXkKICogQHBhcmFtIHtudW1iZXJ9IGIyeAogKiBAcGFyYW0ge251bWJlcn0gYjJ5CiAqIEByZXR1cm4ge2Jvb2xlYW59CiAqLwoKCmZ1bmN0aW9uIGxpbmVMaW5lSW50ZXJzZWN0KGExeCwgYTF5LCBhMngsIGEyeSwgYjF4LCBiMXksIGIyeCwgYjJ5KSB7CiAgLy8gbGV0IGB2ZWNfbWAgdG8gYmUgYHZlY19hMiAtIHZlY19hMWAgYW5kIGB2ZWNfbmAgdG8gYmUgYHZlY19iMiAtIHZlY19iMWAuCiAgdmFyIG14ID0gYTJ4IC0gYTF4OwogIHZhciBteSA9IGEyeSAtIGExeTsKICB2YXIgbnggPSBiMnggLSBiMXg7CiAgdmFyIG55ID0gYjJ5IC0gYjF5OyAvLyBgdmVjX21gIGFuZCBgdmVjX25gIGFyZSBwYXJhbGxlbCBpZmYKICAvLyAgICAgZXhpc2luZyBga2Agc3VjaCB0aGF0IGB2ZWNfbSA9IGsgwrcgdmVjX25gLCBlcXVpdmFsZW50IHRvIGB2ZWNfbSBYIHZlY19uID0gMGAuCgogIHZhciBubUNyb3NzUHJvZHVjdCA9IGNyb3NzUHJvZHVjdDJkKG54LCBueSwgbXgsIG15KTsKCiAgaWYgKG5lYXJaZXJvKG5tQ3Jvc3NQcm9kdWN0KSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0gLy8gYHZlY19tYCBhbmQgYHZlY19uYCBhcmUgaW50ZXJzZWN0IGlmZgogIC8vICAgICBleGlzdGluZyBgcGAgYW5kIGBxYCBpbiBbMCwgMV0gc3VjaCB0aGF0IGB2ZWNfYTEgKyBwICogdmVjX20gPSB2ZWNfYjEgKyBxICogdmVjX25gLAogIC8vICAgICBzdWNoIHRoYXQgYHEgPSAoKHZlY19hMSAtIHZlY19iMSkgWCB2ZWNfbSkgLyAodmVjX24gWCB2ZWNfbSlgCiAgLy8gICAgICAgICAgIGFuZCBgcCA9ICgodmVjX2ExIC0gdmVjX2IxKSBYIHZlY19uKSAvICh2ZWNfbiBYIHZlY19tKWAuCgoKICB2YXIgYjFhMXggPSBhMXggLSBiMXg7CiAgdmFyIGIxYTF5ID0gYTF5IC0gYjF5OwogIHZhciBxID0gY3Jvc3NQcm9kdWN0MmQoYjFhMXgsIGIxYTF5LCBteCwgbXkpIC8gbm1Dcm9zc1Byb2R1Y3Q7CgogIGlmIChxIDwgMCB8fCBxID4gMSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgdmFyIHAgPSBjcm9zc1Byb2R1Y3QyZChiMWExeCwgYjFhMXksIG54LCBueSkgLyBubUNyb3NzUHJvZHVjdDsKCiAgaWYgKHAgPCAwIHx8IHAgPiAxKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICByZXR1cm4gdHJ1ZTsKfQovKioKICogQ3Jvc3MgcHJvZHVjdCBvZiAyLWRpbWVuc2lvbiB2ZWN0b3IuCiAqLwoKCmZ1bmN0aW9uIGNyb3NzUHJvZHVjdDJkKHgxLCB5MSwgeDIsIHkyKSB7CiAgcmV0dXJuIHgxICogeTIgLSB4MiAqIHkxOwp9CgpmdW5jdGlvbiBuZWFyWmVybyh2YWwpIHsKICByZXR1cm4gdmFsIDw9IDFlLTYgJiYgdmFsID49IC0xZS02Owp9IC8vIFJlZ2lzdGVyIGJ1aWx0LWluIHNoYXBlcy4gVGhlc2Ugc2hhcGVzIG1pZ2h0IGJlIG92ZXJ3aXJ0dGVuCi8vIGJ5IHVzZXJzLCBhbHRob3VnaCB3ZSBkbyBub3QgcmVjb21tZW5kIHRoYXQuCgoKcmVnaXN0ZXJTaGFwZSgnY2lyY2xlJywgQ2lyY2xlKTsKcmVnaXN0ZXJTaGFwZSgnc2VjdG9yJywgU2VjdG9yKTsKcmVnaXN0ZXJTaGFwZSgncmluZycsIFJpbmcpOwpyZWdpc3RlclNoYXBlKCdwb2x5Z29uJywgUG9seWdvbik7CnJlZ2lzdGVyU2hhcGUoJ3BvbHlsaW5lJywgUG9seWxpbmUpOwpyZWdpc3RlclNoYXBlKCdyZWN0JywgUmVjdCk7CnJlZ2lzdGVyU2hhcGUoJ2xpbmUnLCBMaW5lKTsKcmVnaXN0ZXJTaGFwZSgnYmV6aWVyQ3VydmUnLCBCZXppZXJDdXJ2ZSk7CnJlZ2lzdGVyU2hhcGUoJ2FyYycsIEFyYyk7CmV4cG9ydHMuWjJfRU1QSEFTSVNfTElGVCA9IFoyX0VNUEhBU0lTX0xJRlQ7CmV4cG9ydHMuQ0FDSEVEX0xBQkVMX1NUWUxFX1BST1BFUlRJRVMgPSBDQUNIRURfTEFCRUxfU1RZTEVfUFJPUEVSVElFUzsKZXhwb3J0cy5leHRlbmRTaGFwZSA9IGV4dGVuZFNoYXBlOwpleHBvcnRzLmV4dGVuZFBhdGggPSBleHRlbmRQYXRoOwpleHBvcnRzLnJlZ2lzdGVyU2hhcGUgPSByZWdpc3RlclNoYXBlOwpleHBvcnRzLmdldFNoYXBlQ2xhc3MgPSBnZXRTaGFwZUNsYXNzOwpleHBvcnRzLm1ha2VQYXRoID0gbWFrZVBhdGg7CmV4cG9ydHMubWFrZUltYWdlID0gbWFrZUltYWdlOwpleHBvcnRzLm1lcmdlUGF0aCA9IG1lcmdlUGF0aDsKZXhwb3J0cy5yZXNpemVQYXRoID0gcmVzaXplUGF0aDsKZXhwb3J0cy5zdWJQaXhlbE9wdGltaXplTGluZSA9IHN1YlBpeGVsT3B0aW1pemVMaW5lOwpleHBvcnRzLnN1YlBpeGVsT3B0aW1pemVSZWN0ID0gc3ViUGl4ZWxPcHRpbWl6ZVJlY3Q7CmV4cG9ydHMuc3ViUGl4ZWxPcHRpbWl6ZSA9IHN1YlBpeGVsT3B0aW1pemU7CmV4cG9ydHMuc2V0RWxlbWVudEhvdmVyU3R5bGUgPSBzZXRFbGVtZW50SG92ZXJTdHlsZTsKZXhwb3J0cy5zZXRIb3ZlclN0eWxlID0gc2V0SG92ZXJTdHlsZTsKZXhwb3J0cy5zZXRBc0hpZ2hEb3duRGlzcGF0Y2hlciA9IHNldEFzSGlnaERvd25EaXNwYXRjaGVyOwpleHBvcnRzLmlzSGlnaERvd25EaXNwYXRjaGVyID0gaXNIaWdoRG93bkRpc3BhdGNoZXI7CmV4cG9ydHMuZ2V0SGlnaGxpZ2h0RGlnaXQgPSBnZXRIaWdobGlnaHREaWdpdDsKZXhwb3J0cy5zZXRMYWJlbFN0eWxlID0gc2V0TGFiZWxTdHlsZTsKZXhwb3J0cy5tb2RpZnlMYWJlbFN0eWxlID0gbW9kaWZ5TGFiZWxTdHlsZTsKZXhwb3J0cy5zZXRUZXh0U3R5bGUgPSBzZXRUZXh0U3R5bGU7CmV4cG9ydHMuc2V0VGV4dCA9IHNldFRleHQ7CmV4cG9ydHMuZ2V0Rm9udCA9IGdldEZvbnQ7CmV4cG9ydHMudXBkYXRlUHJvcHMgPSB1cGRhdGVQcm9wczsKZXhwb3J0cy5pbml0UHJvcHMgPSBpbml0UHJvcHM7CmV4cG9ydHMuZ2V0VHJhbnNmb3JtID0gZ2V0VHJhbnNmb3JtOwpleHBvcnRzLmFwcGx5VHJhbnNmb3JtID0gYXBwbHlUcmFuc2Zvcm07CmV4cG9ydHMudHJhbnNmb3JtRGlyZWN0aW9uID0gdHJhbnNmb3JtRGlyZWN0aW9uOwpleHBvcnRzLmdyb3VwVHJhbnNpdGlvbiA9IGdyb3VwVHJhbnNpdGlvbjsKZXhwb3J0cy5jbGlwUG9pbnRzQnlSZWN0ID0gY2xpcFBvaW50c0J5UmVjdDsKZXhwb3J0cy5jbGlwUmVjdEJ5UmVjdCA9IGNsaXBSZWN0QnlSZWN0OwpleHBvcnRzLmNyZWF0ZUljb24gPSBjcmVhdGVJY29uOwpleHBvcnRzLmxpbmVQb2x5Z29uSW50ZXJzZWN0ID0gbGluZVBvbHlnb25JbnRlcnNlY3Q7CmV4cG9ydHMubGluZUxpbmVJbnRlcnNlY3QgPSBsaW5lTGluZUludGVyc2VjdDs="},{"version":3,"sources":["/Users/id-repair/Documents/SEOL/4c-dashboard/node_modules/echarts/lib/util/graphic.js"],"names":["zrUtil","require","pathTool","colorTool","matrix","vector","Path","Transformable","ZImage","exports","Image","Group","Text","Circle","Sector","Ring","Polygon","Polyline","Rect","Line","BezierCurve","Arc","CompoundPath","LinearGradient","RadialGradient","BoundingRect","IncrementalDisplayable","subPixelOptimizeUtil","mathMax","Math","max","mathMin","min","EMPTY_OBJ","Z2_EMPHASIS_LIFT","CACHED_LABEL_STYLE_PROPERTIES","color","textBorderColor","textBorderWidth","EMPHASIS","NORMAL","_highlightNextDigit","_highlightKeyMap","_customShapeMap","extendShape","opts","extend","extendPath","pathData","extendFromString","registerShape","name","ShapeClass","getShapeClass","hasOwnProperty","makePath","rect","layout","path","createFromString","centerGraphic","getBoundingRect","resizePath","makeImage","imageUrl","style","image","x","y","width","height","onload","img","boundingRect","setStyle","aspect","cx","cy","mergePath","applyTransform","pathRect","m","calculateTransform","subPixelOptimizeLine","param","shape","subPixelOptimizeRect","subPixelOptimize","hasFillOrStroke","fillOrStroke","liftedColorMap","createHashMap","liftedColorCount","liftColor","liftedColor","get","lift","set","cacheElementStl","el","__hoverStlDirty","hoverStyle","__hoverStl","__cachedNormalStl","__cachedNormalZ2","normalStyle","z2","elStyle","fill","stroke","singleEnterEmphasis","hoverStl","__highlighted","zr","__zr","useHoverLayer","painter","type","isGroup","elTarget","targetStyle","addHover","rollbackDefaultTextStyle","extendFrom","setDefaultHoverFillStroke","applyDefaultTextStyle","dirty","prop","singleEnterNormal","highlighted","removeHover","normalStl","normalZ2","traverseUpdate","updater","commonParam","fromState","toState","trigger","traverse","child","__highDownOnUpdate","setElementHoverStyle","onElementMouseOver","e","shouldSilent","__highByOuter","onElementMouseOut","onElementEmphasisEvent","highlightDigit","onElementNormalEvent","__highDownSilentOnTouch","zrByTouch","setHoverStyle","setAsHighDownDispatcher","asDispatcher","disable","highDownSilentOnTouch","highDownOnUpdate","__highDownDispatcher","method","isHighDownDispatcher","getHighlightDigit","highlightKey","setLabelStyle","emphasisStyle","normalModel","emphasisModel","opt","normalSpecified","emphasisSpecified","labelFetcher","labelDataIndex","labelDimIndex","labelProp","showNormal","getShallow","showEmphasis","baseText","getFormattedLabel","isFunction","defaultText","normalStyleText","emphasisStyleText","retrieve2","setTextStyle","text","modifyLabelStyle","normalStyleProps","emphasisStyleProps","textStyle","textStyleModel","specifiedTextStyle","isEmphasis","setTextStyleCommon","setText","labelModel","defaultColor","isRectText","autoColor","textPosition","getTextPosition","textOffset","labelRotate","PI","textRotation","textDistance","ecModel","globalTextStyle","option","richItemNames","getRichItemNames","richResult","richTextStyle","getModel","setTokenTextStyle","rich","forceRich","richItemNameMap","parentModel","isBlock","textFill","getAutoColor","textStroke","textStrokeWidth","insideRollbackOpt","fontStyle","fontWeight","fontSize","fontFamily","textAlign","textVerticalAlign","textLineHeight","textWidth","textHeight","textTag","disableBox","textBackgroundColor","textPadding","textBorderRadius","textBoxShadowColor","textBoxShadowBlur","textBoxShadowOffsetX","textBoxShadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","insideRollback","useInsideStyle","useInsideStyleCache","indexOf","useAutoColorCache","getFont","gTextStyleModel","trim","join","animateOrSetProps","isUpdate","props","animatableModel","dataIndex","cb","animationEnabled","isAnimationEnabled","postfix","duration","animationEasing","animationDelay","getAnimationDelayParams","animateTo","stopAnimation","attr","updateProps","initProps","getTransform","target","ancestor","mat","identity","mul","getLocalTransform","parent","transform","invert","isArrayLike","transformDirection","direction","hBase","abs","vBase","vertex","groupTransition","g1","g2","getElMap","g","elMap","anid","getAnimatableProps","obj","position","clone","rotation","elMap1","oldEl","newProp","clipPointsByRect","points","map","point","clipRectByRect","targetRect","x2","y2","createIcon","iconStr","rectHover","strokeNoScale","slice","defaults","replace","linePolygonIntersect","a1x","a1y","a2x","a2y","i","p2","length","p","lineLineIntersect","b1x","b1y","b2x","b2y","mx","my","nx","ny","nmCrossProduct","crossProduct2d","nearZero","b1a1x","b1a1y","q","x1","y1","val"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar pathTool = require(\"zrender/lib/tool/path\");\n\nvar colorTool = require(\"zrender/lib/tool/color\");\n\nvar matrix = require(\"zrender/lib/core/matrix\");\n\nvar vector = require(\"zrender/lib/core/vector\");\n\nvar Path = require(\"zrender/lib/graphic/Path\");\n\nvar Transformable = require(\"zrender/lib/mixin/Transformable\");\n\nvar ZImage = require(\"zrender/lib/graphic/Image\");\n\nexports.Image = ZImage;\n\nvar Group = require(\"zrender/lib/container/Group\");\n\nexports.Group = Group;\n\nvar Text = require(\"zrender/lib/graphic/Text\");\n\nexports.Text = Text;\n\nvar Circle = require(\"zrender/lib/graphic/shape/Circle\");\n\nexports.Circle = Circle;\n\nvar Sector = require(\"zrender/lib/graphic/shape/Sector\");\n\nexports.Sector = Sector;\n\nvar Ring = require(\"zrender/lib/graphic/shape/Ring\");\n\nexports.Ring = Ring;\n\nvar Polygon = require(\"zrender/lib/graphic/shape/Polygon\");\n\nexports.Polygon = Polygon;\n\nvar Polyline = require(\"zrender/lib/graphic/shape/Polyline\");\n\nexports.Polyline = Polyline;\n\nvar Rect = require(\"zrender/lib/graphic/shape/Rect\");\n\nexports.Rect = Rect;\n\nvar Line = require(\"zrender/lib/graphic/shape/Line\");\n\nexports.Line = Line;\n\nvar BezierCurve = require(\"zrender/lib/graphic/shape/BezierCurve\");\n\nexports.BezierCurve = BezierCurve;\n\nvar Arc = require(\"zrender/lib/graphic/shape/Arc\");\n\nexports.Arc = Arc;\n\nvar CompoundPath = require(\"zrender/lib/graphic/CompoundPath\");\n\nexports.CompoundPath = CompoundPath;\n\nvar LinearGradient = require(\"zrender/lib/graphic/LinearGradient\");\n\nexports.LinearGradient = LinearGradient;\n\nvar RadialGradient = require(\"zrender/lib/graphic/RadialGradient\");\n\nexports.RadialGradient = RadialGradient;\n\nvar BoundingRect = require(\"zrender/lib/core/BoundingRect\");\n\nexports.BoundingRect = BoundingRect;\n\nvar IncrementalDisplayable = require(\"zrender/lib/graphic/IncrementalDisplayable\");\n\nexports.IncrementalDisplayable = IncrementalDisplayable;\n\nvar subPixelOptimizeUtil = require(\"zrender/lib/graphic/helper/subPixelOptimize\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar mathMax = Math.max;\nvar mathMin = Math.min;\nvar EMPTY_OBJ = {};\nvar Z2_EMPHASIS_LIFT = 1; // key: label model property nane, value: style property name.\n\nvar CACHED_LABEL_STYLE_PROPERTIES = {\n  color: 'textFill',\n  textBorderColor: 'textStroke',\n  textBorderWidth: 'textStrokeWidth'\n};\nvar EMPHASIS = 'emphasis';\nvar NORMAL = 'normal'; // Reserve 0 as default.\n\nvar _highlightNextDigit = 1;\nvar _highlightKeyMap = {};\nvar _customShapeMap = {};\n/**\n * Extend shape with parameters\n */\n\nfunction extendShape(opts) {\n  return Path.extend(opts);\n}\n/**\n * Extend path\n */\n\n\nfunction extendPath(pathData, opts) {\n  return pathTool.extendFromString(pathData, opts);\n}\n/**\n * Register a user defined shape.\n * The shape class can be fetched by `getShapeClass`\n * This method will overwrite the registered shapes, including\n * the registered built-in shapes, if using the same `name`.\n * The shape can be used in `custom series` and\n * `graphic component` by declaring `{type: name}`.\n *\n * @param {string} name\n * @param {Object} ShapeClass Can be generated by `extendShape`.\n */\n\n\nfunction registerShape(name, ShapeClass) {\n  _customShapeMap[name] = ShapeClass;\n}\n/**\n * Find shape class registered by `registerShape`. Usually used in\n * fetching user defined shape.\n *\n * [Caution]:\n * (1) This method **MUST NOT be used inside echarts !!!**, unless it is prepared\n * to use user registered shapes.\n * Because the built-in shape (see `getBuiltInShape`) will be registered by\n * `registerShape` by default. That enables users to get both built-in\n * shapes as well as the shapes belonging to themsleves. But users can overwrite\n * the built-in shapes by using names like 'circle', 'rect' via calling\n * `registerShape`. So the echarts inner featrues should not fetch shapes from here\n * in case that it is overwritten by users, except that some features, like\n * `custom series`, `graphic component`, do it deliberately.\n *\n * (2) In the features like `custom series`, `graphic component`, the user input\n * `{tpye: 'xxx'}` does not only specify shapes but also specify other graphic\n * elements like `'group'`, `'text'`, `'image'` or event `'path'`. Those names\n * are reserved names, that is, if some user register a shape named `'image'`,\n * the shape will not be used. If we intending to add some more reserved names\n * in feature, that might bring break changes (disable some existing user shape\n * names). But that case probably rearly happen. So we dont make more mechanism\n * to resolve this issue here.\n *\n * @param {string} name\n * @return {Object} The shape class. If not found, return nothing.\n */\n\n\nfunction getShapeClass(name) {\n  if (_customShapeMap.hasOwnProperty(name)) {\n    return _customShapeMap[name];\n  }\n}\n/**\n * Create a path element from path data string\n * @param {string} pathData\n * @param {Object} opts\n * @param {module:zrender/core/BoundingRect} rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\n\n\nfunction makePath(pathData, opts, rect, layout) {\n  var path = pathTool.createFromString(pathData, opts);\n\n  if (rect) {\n    if (layout === 'center') {\n      rect = centerGraphic(rect, path.getBoundingRect());\n    }\n\n    resizePath(path, rect);\n  }\n\n  return path;\n}\n/**\n * Create a image element from image url\n * @param {string} imageUrl image url\n * @param {Object} opts options\n * @param {module:zrender/core/BoundingRect} rect constrain rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\n\n\nfunction makeImage(imageUrl, rect, layout) {\n  var path = new ZImage({\n    style: {\n      image: imageUrl,\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height\n    },\n    onload: function (img) {\n      if (layout === 'center') {\n        var boundingRect = {\n          width: img.width,\n          height: img.height\n        };\n        path.setStyle(centerGraphic(rect, boundingRect));\n      }\n    }\n  });\n  return path;\n}\n/**\n * Get position of centered element in bounding box.\n *\n * @param  {Object} rect         element local bounding box\n * @param  {Object} boundingRect constraint bounding box\n * @return {Object} element position containing x, y, width, and height\n */\n\n\nfunction centerGraphic(rect, boundingRect) {\n  // Set rect to center, keep width / height ratio.\n  var aspect = boundingRect.width / boundingRect.height;\n  var width = rect.height * aspect;\n  var height;\n\n  if (width <= rect.width) {\n    height = rect.height;\n  } else {\n    width = rect.width;\n    height = width / aspect;\n  }\n\n  var cx = rect.x + rect.width / 2;\n  var cy = rect.y + rect.height / 2;\n  return {\n    x: cx - width / 2,\n    y: cy - height / 2,\n    width: width,\n    height: height\n  };\n}\n\nvar mergePath = pathTool.mergePath;\n/**\n * Resize a path to fit the rect\n * @param {module:zrender/graphic/Path} path\n * @param {Object} rect\n */\n\nfunction resizePath(path, rect) {\n  if (!path.applyTransform) {\n    return;\n  }\n\n  var pathRect = path.getBoundingRect();\n  var m = pathRect.calculateTransform(rect);\n  path.applyTransform(m);\n}\n/**\n * Sub pixel optimize line for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x1]\n * @param {number} [param.shape.y1]\n * @param {number} [param.shape.x2]\n * @param {number} [param.shape.y2]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\n\n\nfunction subPixelOptimizeLine(param) {\n  subPixelOptimizeUtil.subPixelOptimizeLine(param.shape, param.shape, param.style);\n  return param;\n}\n/**\n * Sub pixel optimize rect for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x]\n * @param {number} [param.shape.y]\n * @param {number} [param.shape.width]\n * @param {number} [param.shape.height]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\n\n\nfunction subPixelOptimizeRect(param) {\n  subPixelOptimizeUtil.subPixelOptimizeRect(param.shape, param.shape, param.style);\n  return param;\n}\n/**\n * Sub pixel optimize for canvas\n *\n * @param {number} position Coordinate, such as x, y\n * @param {number} lineWidth Should be nonnegative integer.\n * @param {boolean=} positiveOrNegative Default false (negative).\n * @return {number} Optimized position.\n */\n\n\nvar subPixelOptimize = subPixelOptimizeUtil.subPixelOptimize;\n\nfunction hasFillOrStroke(fillOrStroke) {\n  return fillOrStroke != null && fillOrStroke !== 'none';\n} // Most lifted color are duplicated.\n\n\nvar liftedColorMap = zrUtil.createHashMap();\nvar liftedColorCount = 0;\n\nfunction liftColor(color) {\n  if (typeof color !== 'string') {\n    return color;\n  }\n\n  var liftedColor = liftedColorMap.get(color);\n\n  if (!liftedColor) {\n    liftedColor = colorTool.lift(color, -0.1);\n\n    if (liftedColorCount < 10000) {\n      liftedColorMap.set(color, liftedColor);\n      liftedColorCount++;\n    }\n  }\n\n  return liftedColor;\n}\n\nfunction cacheElementStl(el) {\n  if (!el.__hoverStlDirty) {\n    return;\n  }\n\n  el.__hoverStlDirty = false;\n  var hoverStyle = el.__hoverStl;\n\n  if (!hoverStyle) {\n    el.__cachedNormalStl = el.__cachedNormalZ2 = null;\n    return;\n  }\n\n  var normalStyle = el.__cachedNormalStl = {};\n  el.__cachedNormalZ2 = el.z2;\n  var elStyle = el.style;\n\n  for (var name in hoverStyle) {\n    // See comment in `singleEnterEmphasis`.\n    if (hoverStyle[name] != null) {\n      normalStyle[name] = elStyle[name];\n    }\n  } // Always cache fill and stroke to normalStyle for lifting color.\n\n\n  normalStyle.fill = elStyle.fill;\n  normalStyle.stroke = elStyle.stroke;\n}\n\nfunction singleEnterEmphasis(el) {\n  var hoverStl = el.__hoverStl;\n\n  if (!hoverStl || el.__highlighted) {\n    return;\n  }\n\n  var zr = el.__zr;\n  var useHoverLayer = el.useHoverLayer && zr && zr.painter.type === 'canvas';\n  el.__highlighted = useHoverLayer ? 'layer' : 'plain';\n\n  if (el.isGroup || !zr && el.useHoverLayer) {\n    return;\n  }\n\n  var elTarget = el;\n  var targetStyle = el.style;\n\n  if (useHoverLayer) {\n    elTarget = zr.addHover(el);\n    targetStyle = elTarget.style;\n  }\n\n  rollbackDefaultTextStyle(targetStyle);\n\n  if (!useHoverLayer) {\n    cacheElementStl(elTarget);\n  } // styles can be:\n  // {\n  //    label: {\n  //        show: false,\n  //        position: 'outside',\n  //        fontSize: 18\n  //    },\n  //    emphasis: {\n  //        label: {\n  //            show: true\n  //        }\n  //    }\n  // },\n  // where properties of `emphasis` may not appear in `normal`. We previously use\n  // module:echarts/util/model#defaultEmphasis to merge `normal` to `emphasis`.\n  // But consider rich text and setOption in merge mode, it is impossible to cover\n  // all properties in merge. So we use merge mode when setting style here.\n  // But we choose the merge strategy that only properties that is not `null/undefined`.\n  // Because when making a textStyle (espacially rich text), it is not easy to distinguish\n  // `hasOwnProperty` and `null/undefined` in code, so we trade them as the same for simplicity.\n  // But this strategy brings a trouble that `null/undefined` can not be used to remove\n  // style any more in `emphasis`. Users can both set properties directly on normal and\n  // emphasis to avoid this issue, or we might support `'none'` for this case if required.\n\n\n  targetStyle.extendFrom(hoverStl);\n  setDefaultHoverFillStroke(targetStyle, hoverStl, 'fill');\n  setDefaultHoverFillStroke(targetStyle, hoverStl, 'stroke');\n  applyDefaultTextStyle(targetStyle);\n\n  if (!useHoverLayer) {\n    el.dirty(false);\n    el.z2 += Z2_EMPHASIS_LIFT;\n  }\n}\n\nfunction setDefaultHoverFillStroke(targetStyle, hoverStyle, prop) {\n  if (!hasFillOrStroke(hoverStyle[prop]) && hasFillOrStroke(targetStyle[prop])) {\n    targetStyle[prop] = liftColor(targetStyle[prop]);\n  }\n}\n\nfunction singleEnterNormal(el) {\n  var highlighted = el.__highlighted;\n\n  if (!highlighted) {\n    return;\n  }\n\n  el.__highlighted = false;\n\n  if (el.isGroup) {\n    return;\n  }\n\n  if (highlighted === 'layer') {\n    el.__zr && el.__zr.removeHover(el);\n  } else {\n    var style = el.style;\n    var normalStl = el.__cachedNormalStl;\n\n    if (normalStl) {\n      rollbackDefaultTextStyle(style);\n      el.setStyle(normalStl);\n      applyDefaultTextStyle(style);\n    } // `__cachedNormalZ2` will not be reset if calling `setElementHoverStyle`\n    // when `el` is on emphasis state. So here by comparing with 1, we try\n    // hard to make the bug case rare.\n\n\n    var normalZ2 = el.__cachedNormalZ2;\n\n    if (normalZ2 != null && el.z2 - normalZ2 === Z2_EMPHASIS_LIFT) {\n      el.z2 = normalZ2;\n    }\n  }\n}\n\nfunction traverseUpdate(el, updater, commonParam) {\n  // If root is group, also enter updater for `highDownOnUpdate`.\n  var fromState = NORMAL;\n  var toState = NORMAL;\n  var trigger; // See the rule of `highDownOnUpdate` on `graphic.setAsHighDownDispatcher`.\n\n  el.__highlighted && (fromState = EMPHASIS, trigger = true);\n  updater(el, commonParam);\n  el.__highlighted && (toState = EMPHASIS, trigger = true);\n  el.isGroup && el.traverse(function (child) {\n    !child.isGroup && updater(child, commonParam);\n  });\n  trigger && el.__highDownOnUpdate && el.__highDownOnUpdate(fromState, toState);\n}\n/**\n * Set hover style (namely \"emphasis style\") of element, based on the current\n * style of the given `el`.\n * This method should be called after all of the normal styles have been adopted\n * to the `el`. See the reason on `setHoverStyle`.\n *\n * @param {module:zrender/Element} el Should not be `zrender/container/Group`.\n * @param {Object} [el.hoverStyle] Can be set on el or its descendants,\n *        e.g., `el.hoverStyle = ...; graphic.setHoverStyle(el); `.\n *        Often used when item group has a label element and it's hoverStyle is different.\n * @param {Object|boolean} [hoverStl] The specified hover style.\n *        If set as `false`, disable the hover style.\n *        Similarly, The `el.hoverStyle` can alse be set\n *        as `false` to disable the hover style.\n *        Otherwise, use the default hover style if not provided.\n */\n\n\nfunction setElementHoverStyle(el, hoverStl) {\n  // For performance consideration, it might be better to make the \"hover style\" only the\n  // difference properties from the \"normal style\", but not a entire copy of all styles.\n  hoverStl = el.__hoverStl = hoverStl !== false && (el.hoverStyle || hoverStl || {});\n  el.__hoverStlDirty = true; // FIXME\n  // It is not completely right to save \"normal\"/\"emphasis\" flag on elements.\n  // It probably should be saved on `data` of series. Consider the cases:\n  // (1) A highlighted elements are moved out of the view port and re-enter\n  // again by dataZoom.\n  // (2) call `setOption` and replace elements totally when they are highlighted.\n\n  if (el.__highlighted) {\n    // Consider the case:\n    // The styles of a highlighted `el` is being updated. The new \"emphasis style\"\n    // should be adapted to the `el`. Notice here new \"normal styles\" should have\n    // been set outside and the cached \"normal style\" is out of date.\n    el.__cachedNormalStl = null; // Do not clear `__cachedNormalZ2` here, because setting `z2` is not a constraint\n    // of this method. In most cases, `z2` is not set and hover style should be able\n    // to rollback. Of course, that would bring bug, but only in a rare case, see\n    // `doSingleLeaveHover` for details.\n\n    singleEnterNormal(el);\n    singleEnterEmphasis(el);\n  }\n}\n\nfunction onElementMouseOver(e) {\n  !shouldSilent(this, e) // \"emphasis\" event highlight has higher priority than mouse highlight.\n  && !this.__highByOuter && traverseUpdate(this, singleEnterEmphasis);\n}\n\nfunction onElementMouseOut(e) {\n  !shouldSilent(this, e) // \"emphasis\" event highlight has higher priority than mouse highlight.\n  && !this.__highByOuter && traverseUpdate(this, singleEnterNormal);\n}\n\nfunction onElementEmphasisEvent(highlightDigit) {\n  this.__highByOuter |= 1 << (highlightDigit || 0);\n  traverseUpdate(this, singleEnterEmphasis);\n}\n\nfunction onElementNormalEvent(highlightDigit) {\n  !(this.__highByOuter &= ~(1 << (highlightDigit || 0))) && traverseUpdate(this, singleEnterNormal);\n}\n\nfunction shouldSilent(el, e) {\n  return el.__highDownSilentOnTouch && e.zrByTouch;\n}\n/**\n * Set hover style (namely \"emphasis style\") of element,\n * based on the current style of the given `el`.\n *\n * (1)\n * **CONSTRAINTS** for this method:\n * <A> This method MUST be called after all of the normal styles having been adopted\n * to the `el`.\n * <B> The input `hoverStyle` (that is, \"emphasis style\") MUST be the subset of the\n * \"normal style\" having been set to the el.\n * <C> `color` MUST be one of the \"normal styles\" (because color might be lifted as\n * a default hover style).\n *\n * The reason: this method treat the current style of the `el` as the \"normal style\"\n * and cache them when enter/update the \"emphasis style\". Consider the case: the `el`\n * is in \"emphasis\" state and `setOption`/`dispatchAction` trigger the style updating\n * logic, where the el should shift from the original emphasis style to the new\n * \"emphasis style\" and should be able to \"downplay\" back to the new \"normal style\".\n *\n * Indeed, it is error-prone to make a interface has so many constraints, but I have\n * not found a better solution yet to fit the backward compatibility, performance and\n * the current programming style.\n *\n * (2)\n * Call the method for a \"root\" element once. Do not call it for each descendants.\n * If the descendants elemenets of a group has itself hover style different from the\n * root group, we can simply mount the style on `el.hoverStyle` for them, but should\n * not call this method for them.\n *\n * (3) These input parameters can be set directly on `el`:\n *\n * @param {module:zrender/Element} el\n * @param {Object} [el.hoverStyle] See `graphic.setElementHoverStyle`.\n * @param {boolean} [el.highDownSilentOnTouch=false] See `graphic.setAsHighDownDispatcher`.\n * @param {Function} [el.highDownOnUpdate] See `graphic.setAsHighDownDispatcher`.\n * @param {Object|boolean} [hoverStyle] See `graphic.setElementHoverStyle`.\n */\n\n\nfunction setHoverStyle(el, hoverStyle) {\n  setAsHighDownDispatcher(el, true);\n  traverseUpdate(el, setElementHoverStyle, hoverStyle);\n}\n/**\n * @param {module:zrender/Element} el\n * @param {Function} [el.highDownOnUpdate] Called when state updated.\n *        Since `setHoverStyle` has the constraint that it must be called after\n *        all of the normal style updated, `highDownOnUpdate` is not needed to\n *        trigger if both `fromState` and `toState` is 'normal', and needed to\n *        trigger if both `fromState` and `toState` is 'emphasis', which enables\n *        to sync outside style settings to \"emphasis\" state.\n *        @this {string} This dispatcher `el`.\n *        @param {string} fromState Can be \"normal\" or \"emphasis\".\n *               `fromState` might equal to `toState`,\n *               for example, when this method is called when `el` is\n *               on \"emphasis\" state.\n *        @param {string} toState Can be \"normal\" or \"emphasis\".\n *\n *        FIXME\n *        CAUTION: Do not expose `highDownOnUpdate` outside echarts.\n *        Because it is not a complete solution. The update\n *        listener should not have been mount in element,\n *        and the normal/emphasis state should not have\n *        mantained on elements.\n *\n * @param {boolean} [el.highDownSilentOnTouch=false]\n *        In touch device, mouseover event will be trigger on touchstart event\n *        (see module:zrender/dom/HandlerProxy). By this mechanism, we can\n *        conveniently use hoverStyle when tap on touch screen without additional\n *        code for compatibility.\n *        But if the chart/component has select feature, which usually also use\n *        hoverStyle, there might be conflict between 'select-highlight' and\n *        'hover-highlight' especially when roam is enabled (see geo for example).\n *        In this case, `highDownSilentOnTouch` should be used to disable\n *        hover-highlight on touch device.\n * @param {boolean} [asDispatcher=true] If `false`, do not set as \"highDownDispatcher\".\n */\n\n\nfunction setAsHighDownDispatcher(el, asDispatcher) {\n  var disable = asDispatcher === false; // Make `highDownSilentOnTouch` and `highDownOnUpdate` only work after\n  // `setAsHighDownDispatcher` called. Avoid it is modified by user unexpectedly.\n\n  el.__highDownSilentOnTouch = el.highDownSilentOnTouch;\n  el.__highDownOnUpdate = el.highDownOnUpdate; // Simple optimize, since this method might be\n  // called for each elements of a group in some cases.\n\n  if (!disable || el.__highDownDispatcher) {\n    var method = disable ? 'off' : 'on'; // Duplicated function will be auto-ignored, see Eventful.js.\n\n    el[method]('mouseover', onElementMouseOver)[method]('mouseout', onElementMouseOut); // Emphasis, normal can be triggered manually by API or other components like hover link.\n\n    el[method]('emphasis', onElementEmphasisEvent)[method]('normal', onElementNormalEvent); // Also keep previous record.\n\n    el.__highByOuter = el.__highByOuter || 0;\n    el.__highDownDispatcher = !disable;\n  }\n}\n/**\n * @param {module:zrender/src/Element} el\n * @return {boolean}\n */\n\n\nfunction isHighDownDispatcher(el) {\n  return !!(el && el.__highDownDispatcher);\n}\n/**\n * Support hightlight/downplay record on each elements.\n * For the case: hover highlight/downplay (legend, visualMap, ...) and\n * user triggerred hightlight/downplay should not conflict.\n * Only all of the highlightDigit cleared, return to normal.\n * @param {string} highlightKey\n * @return {number} highlightDigit\n */\n\n\nfunction getHighlightDigit(highlightKey) {\n  var highlightDigit = _highlightKeyMap[highlightKey];\n\n  if (highlightDigit == null && _highlightNextDigit <= 32) {\n    highlightDigit = _highlightKeyMap[highlightKey] = _highlightNextDigit++;\n  }\n\n  return highlightDigit;\n}\n/**\n * See more info in `setTextStyleCommon`.\n * @param {Object|module:zrender/graphic/Style} normalStyle\n * @param {Object} emphasisStyle\n * @param {module:echarts/model/Model} normalModel\n * @param {module:echarts/model/Model} emphasisModel\n * @param {Object} opt Check `opt` of `setTextStyleCommon` to find other props.\n * @param {string|Function} [opt.defaultText]\n * @param {module:echarts/model/Model} [opt.labelFetcher] Fetch text by\n *      `opt.labelFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {number} [opt.labelDataIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {number} [opt.labelDimIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {string} [opt.labelProp] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex, opt.labelProp)`\n * @param {Object} [normalSpecified]\n * @param {Object} [emphasisSpecified]\n */\n\n\nfunction setLabelStyle(normalStyle, emphasisStyle, normalModel, emphasisModel, opt, normalSpecified, emphasisSpecified) {\n  opt = opt || EMPTY_OBJ;\n  var labelFetcher = opt.labelFetcher;\n  var labelDataIndex = opt.labelDataIndex;\n  var labelDimIndex = opt.labelDimIndex;\n  var labelProp = opt.labelProp; // This scenario, `label.normal.show = true; label.emphasis.show = false`,\n  // is not supported util someone requests.\n\n  var showNormal = normalModel.getShallow('show');\n  var showEmphasis = emphasisModel.getShallow('show'); // Consider performance, only fetch label when necessary.\n  // If `normal.show` is `false` and `emphasis.show` is `true` and `emphasis.formatter` is not set,\n  // label should be displayed, where text is fetched by `normal.formatter` or `opt.defaultText`.\n\n  var baseText;\n\n  if (showNormal || showEmphasis) {\n    if (labelFetcher) {\n      baseText = labelFetcher.getFormattedLabel(labelDataIndex, 'normal', null, labelDimIndex, labelProp);\n    }\n\n    if (baseText == null) {\n      baseText = zrUtil.isFunction(opt.defaultText) ? opt.defaultText(labelDataIndex, opt) : opt.defaultText;\n    }\n  }\n\n  var normalStyleText = showNormal ? baseText : null;\n  var emphasisStyleText = showEmphasis ? zrUtil.retrieve2(labelFetcher ? labelFetcher.getFormattedLabel(labelDataIndex, 'emphasis', null, labelDimIndex, labelProp) : null, baseText) : null; // Optimize: If style.text is null, text will not be drawn.\n\n  if (normalStyleText != null || emphasisStyleText != null) {\n    // Always set `textStyle` even if `normalStyle.text` is null, because default\n    // values have to be set on `normalStyle`.\n    // If we set default values on `emphasisStyle`, consider case:\n    // Firstly, `setOption(... label: {normal: {text: null}, emphasis: {show: true}} ...);`\n    // Secondly, `setOption(... label: {noraml: {show: true, text: 'abc', color: 'red'} ...);`\n    // Then the 'red' will not work on emphasis.\n    setTextStyle(normalStyle, normalModel, normalSpecified, opt);\n    setTextStyle(emphasisStyle, emphasisModel, emphasisSpecified, opt, true);\n  }\n\n  normalStyle.text = normalStyleText;\n  emphasisStyle.text = emphasisStyleText;\n}\n/**\n * Modify label style manually.\n * Only works after `setLabelStyle` and `setElementHoverStyle` called.\n *\n * @param {module:zrender/src/Element} el\n * @param {Object} [normalStyleProps] optional\n * @param {Object} [emphasisStyleProps] optional\n */\n\n\nfunction modifyLabelStyle(el, normalStyleProps, emphasisStyleProps) {\n  var elStyle = el.style;\n\n  if (normalStyleProps) {\n    rollbackDefaultTextStyle(elStyle);\n    el.setStyle(normalStyleProps);\n    applyDefaultTextStyle(elStyle);\n  }\n\n  elStyle = el.__hoverStl;\n\n  if (emphasisStyleProps && elStyle) {\n    rollbackDefaultTextStyle(elStyle);\n    zrUtil.extend(elStyle, emphasisStyleProps);\n    applyDefaultTextStyle(elStyle);\n  }\n}\n/**\n * Set basic textStyle properties.\n * See more info in `setTextStyleCommon`.\n * @param {Object|module:zrender/graphic/Style} textStyle\n * @param {module:echarts/model/Model} model\n * @param {Object} [specifiedTextStyle] Can be overrided by settings in model.\n * @param {Object} [opt] See `opt` of `setTextStyleCommon`.\n * @param {boolean} [isEmphasis]\n */\n\n\nfunction setTextStyle(textStyle, textStyleModel, specifiedTextStyle, opt, isEmphasis) {\n  setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis);\n  specifiedTextStyle && zrUtil.extend(textStyle, specifiedTextStyle); // textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n\n  return textStyle;\n}\n/**\n * Set text option in the style.\n * See more info in `setTextStyleCommon`.\n * @deprecated\n * @param {Object} textStyle\n * @param {module:echarts/model/Model} labelModel\n * @param {string|boolean} defaultColor Default text color.\n *        If set as false, it will be processed as a emphasis style.\n */\n\n\nfunction setText(textStyle, labelModel, defaultColor) {\n  var opt = {\n    isRectText: true\n  };\n  var isEmphasis;\n\n  if (defaultColor === false) {\n    isEmphasis = true;\n  } else {\n    // Support setting color as 'auto' to get visual color.\n    opt.autoColor = defaultColor;\n  }\n\n  setTextStyleCommon(textStyle, labelModel, opt, isEmphasis); // textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n}\n/**\n * The uniform entry of set text style, that is, retrieve style definitions\n * from `model` and set to `textStyle` object.\n *\n * Never in merge mode, but in overwrite mode, that is, all of the text style\n * properties will be set. (Consider the states of normal and emphasis and\n * default value can be adopted, merge would make the logic too complicated\n * to manage.)\n *\n * The `textStyle` object can either be a plain object or an instance of\n * `zrender/src/graphic/Style`, and either be the style of normal or emphasis.\n * After this mothod called, the `textStyle` object can then be used in\n * `el.setStyle(textStyle)` or `el.hoverStyle = textStyle`.\n *\n * Default value will be adopted and `insideRollbackOpt` will be created.\n * See `applyDefaultTextStyle` `rollbackDefaultTextStyle` for more details.\n *\n * opt: {\n *      disableBox: boolean, Whether diable drawing box of block (outer most).\n *      isRectText: boolean,\n *      autoColor: string, specify a color when color is 'auto',\n *              for textFill, textStroke, textBackgroundColor, and textBorderColor.\n *              If autoColor specified, it is used as default textFill.\n *      useInsideStyle:\n *              `true`: Use inside style (textFill, textStroke, textStrokeWidth)\n *                  if `textFill` is not specified.\n *              `false`: Do not use inside style.\n *              `null/undefined`: use inside style if `isRectText` is true and\n *                  `textFill` is not specified and textPosition contains `'inside'`.\n *      forceRich: boolean\n * }\n */\n\n\nfunction setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis) {\n  // Consider there will be abnormal when merge hover style to normal style if given default value.\n  opt = opt || EMPTY_OBJ;\n\n  if (opt.isRectText) {\n    var textPosition;\n\n    if (opt.getTextPosition) {\n      textPosition = opt.getTextPosition(textStyleModel, isEmphasis);\n    } else {\n      textPosition = textStyleModel.getShallow('position') || (isEmphasis ? null : 'inside'); // 'outside' is not a valid zr textPostion value, but used\n      // in bar series, and magric type should be considered.\n\n      textPosition === 'outside' && (textPosition = 'top');\n    }\n\n    textStyle.textPosition = textPosition;\n    textStyle.textOffset = textStyleModel.getShallow('offset');\n    var labelRotate = textStyleModel.getShallow('rotate');\n    labelRotate != null && (labelRotate *= Math.PI / 180);\n    textStyle.textRotation = labelRotate;\n    textStyle.textDistance = zrUtil.retrieve2(textStyleModel.getShallow('distance'), isEmphasis ? null : 5);\n  }\n\n  var ecModel = textStyleModel.ecModel;\n  var globalTextStyle = ecModel && ecModel.option.textStyle; // Consider case:\n  // {\n  //     data: [{\n  //         value: 12,\n  //         label: {\n  //             rich: {\n  //                 // no 'a' here but using parent 'a'.\n  //             }\n  //         }\n  //     }],\n  //     rich: {\n  //         a: { ... }\n  //     }\n  // }\n\n  var richItemNames = getRichItemNames(textStyleModel);\n  var richResult;\n\n  if (richItemNames) {\n    richResult = {};\n\n    for (var name in richItemNames) {\n      if (richItemNames.hasOwnProperty(name)) {\n        // Cascade is supported in rich.\n        var richTextStyle = textStyleModel.getModel(['rich', name]); // In rich, never `disableBox`.\n        // FIXME: consider `label: {formatter: '{a|xx}', color: 'blue', rich: {a: {}}}`,\n        // the default color `'blue'` will not be adopted if no color declared in `rich`.\n        // That might confuses users. So probably we should put `textStyleModel` as the\n        // root ancestor of the `richTextStyle`. But that would be a break change.\n\n        setTokenTextStyle(richResult[name] = {}, richTextStyle, globalTextStyle, opt, isEmphasis);\n      }\n    }\n  }\n\n  textStyle.rich = richResult;\n  setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, true);\n\n  if (opt.forceRich && !opt.textStyle) {\n    opt.textStyle = {};\n  }\n\n  return textStyle;\n} // Consider case:\n// {\n//     data: [{\n//         value: 12,\n//         label: {\n//             rich: {\n//                 // no 'a' here but using parent 'a'.\n//             }\n//         }\n//     }],\n//     rich: {\n//         a: { ... }\n//     }\n// }\n\n\nfunction getRichItemNames(textStyleModel) {\n  // Use object to remove duplicated names.\n  var richItemNameMap;\n\n  while (textStyleModel && textStyleModel !== textStyleModel.ecModel) {\n    var rich = (textStyleModel.option || EMPTY_OBJ).rich;\n\n    if (rich) {\n      richItemNameMap = richItemNameMap || {};\n\n      for (var name in rich) {\n        if (rich.hasOwnProperty(name)) {\n          richItemNameMap[name] = 1;\n        }\n      }\n    }\n\n    textStyleModel = textStyleModel.parentModel;\n  }\n\n  return richItemNameMap;\n}\n\nfunction setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, isBlock) {\n  // In merge mode, default value should not be given.\n  globalTextStyle = !isEmphasis && globalTextStyle || EMPTY_OBJ;\n  textStyle.textFill = getAutoColor(textStyleModel.getShallow('color'), opt) || globalTextStyle.color;\n  textStyle.textStroke = getAutoColor(textStyleModel.getShallow('textBorderColor'), opt) || globalTextStyle.textBorderColor;\n  textStyle.textStrokeWidth = zrUtil.retrieve2(textStyleModel.getShallow('textBorderWidth'), globalTextStyle.textBorderWidth);\n\n  if (!isEmphasis) {\n    if (isBlock) {\n      textStyle.insideRollbackOpt = opt;\n      applyDefaultTextStyle(textStyle);\n    } // Set default finally.\n\n\n    if (textStyle.textFill == null) {\n      textStyle.textFill = opt.autoColor;\n    }\n  } // Do not use `getFont` here, because merge should be supported, where\n  // part of these properties may be changed in emphasis style, and the\n  // others should remain their original value got from normal style.\n\n\n  textStyle.fontStyle = textStyleModel.getShallow('fontStyle') || globalTextStyle.fontStyle;\n  textStyle.fontWeight = textStyleModel.getShallow('fontWeight') || globalTextStyle.fontWeight;\n  textStyle.fontSize = textStyleModel.getShallow('fontSize') || globalTextStyle.fontSize;\n  textStyle.fontFamily = textStyleModel.getShallow('fontFamily') || globalTextStyle.fontFamily;\n  textStyle.textAlign = textStyleModel.getShallow('align');\n  textStyle.textVerticalAlign = textStyleModel.getShallow('verticalAlign') || textStyleModel.getShallow('baseline');\n  textStyle.textLineHeight = textStyleModel.getShallow('lineHeight');\n  textStyle.textWidth = textStyleModel.getShallow('width');\n  textStyle.textHeight = textStyleModel.getShallow('height');\n  textStyle.textTag = textStyleModel.getShallow('tag');\n\n  if (!isBlock || !opt.disableBox) {\n    textStyle.textBackgroundColor = getAutoColor(textStyleModel.getShallow('backgroundColor'), opt);\n    textStyle.textPadding = textStyleModel.getShallow('padding');\n    textStyle.textBorderColor = getAutoColor(textStyleModel.getShallow('borderColor'), opt);\n    textStyle.textBorderWidth = textStyleModel.getShallow('borderWidth');\n    textStyle.textBorderRadius = textStyleModel.getShallow('borderRadius');\n    textStyle.textBoxShadowColor = textStyleModel.getShallow('shadowColor');\n    textStyle.textBoxShadowBlur = textStyleModel.getShallow('shadowBlur');\n    textStyle.textBoxShadowOffsetX = textStyleModel.getShallow('shadowOffsetX');\n    textStyle.textBoxShadowOffsetY = textStyleModel.getShallow('shadowOffsetY');\n  }\n\n  textStyle.textShadowColor = textStyleModel.getShallow('textShadowColor') || globalTextStyle.textShadowColor;\n  textStyle.textShadowBlur = textStyleModel.getShallow('textShadowBlur') || globalTextStyle.textShadowBlur;\n  textStyle.textShadowOffsetX = textStyleModel.getShallow('textShadowOffsetX') || globalTextStyle.textShadowOffsetX;\n  textStyle.textShadowOffsetY = textStyleModel.getShallow('textShadowOffsetY') || globalTextStyle.textShadowOffsetY;\n}\n\nfunction getAutoColor(color, opt) {\n  return color !== 'auto' ? color : opt && opt.autoColor ? opt.autoColor : null;\n}\n/**\n * Give some default value to the input `textStyle` object, based on the current settings\n * in this `textStyle` object.\n *\n * The Scenario:\n * when text position is `inside` and `textFill` is not specified, we show\n * text border by default for better view. But it should be considered that text position\n * might be changed when hovering or being emphasis, where the `insideRollback` is used to\n * restore the style.\n *\n * Usage (& NOTICE):\n * When a style object (eithor plain object or instance of `zrender/src/graphic/Style`) is\n * about to be modified on its text related properties, `rollbackDefaultTextStyle` should\n * be called before the modification and `applyDefaultTextStyle` should be called after that.\n * (For the case that all of the text related properties is reset, like `setTextStyleCommon`\n * does, `rollbackDefaultTextStyle` is not needed to be called).\n */\n\n\nfunction applyDefaultTextStyle(textStyle) {\n  var textPosition = textStyle.textPosition;\n  var opt = textStyle.insideRollbackOpt;\n  var insideRollback;\n\n  if (opt && textStyle.textFill == null) {\n    var autoColor = opt.autoColor;\n    var isRectText = opt.isRectText;\n    var useInsideStyle = opt.useInsideStyle;\n    var useInsideStyleCache = useInsideStyle !== false && (useInsideStyle === true || isRectText && textPosition // textPosition can be [10, 30]\n    && typeof textPosition === 'string' && textPosition.indexOf('inside') >= 0);\n    var useAutoColorCache = !useInsideStyleCache && autoColor != null; // All of the props declared in `CACHED_LABEL_STYLE_PROPERTIES` are to be cached.\n\n    if (useInsideStyleCache || useAutoColorCache) {\n      insideRollback = {\n        textFill: textStyle.textFill,\n        textStroke: textStyle.textStroke,\n        textStrokeWidth: textStyle.textStrokeWidth\n      };\n    }\n\n    if (useInsideStyleCache) {\n      textStyle.textFill = '#fff'; // Consider text with #fff overflow its container.\n\n      if (textStyle.textStroke == null) {\n        textStyle.textStroke = autoColor;\n        textStyle.textStrokeWidth == null && (textStyle.textStrokeWidth = 2);\n      }\n    }\n\n    if (useAutoColorCache) {\n      textStyle.textFill = autoColor;\n    }\n  } // Always set `insideRollback`, so that the previous one can be cleared.\n\n\n  textStyle.insideRollback = insideRollback;\n}\n/**\n * Consider the case: in a scatter,\n * label: {\n *     normal: {position: 'inside'},\n *     emphasis: {position: 'top'}\n * }\n * In the normal state, the `textFill` will be set as '#fff' for pretty view (see\n * `applyDefaultTextStyle`), but when switching to emphasis state, the `textFill`\n * should be retured to 'autoColor', but not keep '#fff'.\n */\n\n\nfunction rollbackDefaultTextStyle(style) {\n  var insideRollback = style.insideRollback;\n\n  if (insideRollback) {\n    // Reset all of the props in `CACHED_LABEL_STYLE_PROPERTIES`.\n    style.textFill = insideRollback.textFill;\n    style.textStroke = insideRollback.textStroke;\n    style.textStrokeWidth = insideRollback.textStrokeWidth;\n    style.insideRollback = null;\n  }\n}\n\nfunction getFont(opt, ecModel) {\n  var gTextStyleModel = ecModel && ecModel.getModel('textStyle');\n  return zrUtil.trim([// FIXME in node-canvas fontWeight is before fontStyle\n  opt.fontStyle || gTextStyleModel && gTextStyleModel.getShallow('fontStyle') || '', opt.fontWeight || gTextStyleModel && gTextStyleModel.getShallow('fontWeight') || '', (opt.fontSize || gTextStyleModel && gTextStyleModel.getShallow('fontSize') || 12) + 'px', opt.fontFamily || gTextStyleModel && gTextStyleModel.getShallow('fontFamily') || 'sans-serif'].join(' '));\n}\n\nfunction animateOrSetProps(isUpdate, el, props, animatableModel, dataIndex, cb) {\n  if (typeof dataIndex === 'function') {\n    cb = dataIndex;\n    dataIndex = null;\n  } // Do not check 'animation' property directly here. Consider this case:\n  // animation model is an `itemModel`, whose does not have `isAnimationEnabled`\n  // but its parent model (`seriesModel`) does.\n\n\n  var animationEnabled = animatableModel && animatableModel.isAnimationEnabled();\n\n  if (animationEnabled) {\n    var postfix = isUpdate ? 'Update' : '';\n    var duration = animatableModel.getShallow('animationDuration' + postfix);\n    var animationEasing = animatableModel.getShallow('animationEasing' + postfix);\n    var animationDelay = animatableModel.getShallow('animationDelay' + postfix);\n\n    if (typeof animationDelay === 'function') {\n      animationDelay = animationDelay(dataIndex, animatableModel.getAnimationDelayParams ? animatableModel.getAnimationDelayParams(el, dataIndex) : null);\n    }\n\n    if (typeof duration === 'function') {\n      duration = duration(dataIndex);\n    }\n\n    duration > 0 ? el.animateTo(props, duration, animationDelay || 0, animationEasing, cb, !!cb) : (el.stopAnimation(), el.attr(props), cb && cb());\n  } else {\n    el.stopAnimation();\n    el.attr(props);\n    cb && cb();\n  }\n}\n/**\n * Update graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} [cb]\n * @example\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, dataIndex, function () { console.log('Animation done!'); });\n *     // Or\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, function () { console.log('Animation done!'); });\n */\n\n\nfunction updateProps(el, props, animatableModel, dataIndex, cb) {\n  animateOrSetProps(true, el, props, animatableModel, dataIndex, cb);\n}\n/**\n * Init graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} cb\n */\n\n\nfunction initProps(el, props, animatableModel, dataIndex, cb) {\n  animateOrSetProps(false, el, props, animatableModel, dataIndex, cb);\n}\n/**\n * Get transform matrix of target (param target),\n * in coordinate of its ancestor (param ancestor)\n *\n * @param {module:zrender/mixin/Transformable} target\n * @param {module:zrender/mixin/Transformable} [ancestor]\n */\n\n\nfunction getTransform(target, ancestor) {\n  var mat = matrix.identity([]);\n\n  while (target && target !== ancestor) {\n    matrix.mul(mat, target.getLocalTransform(), mat);\n    target = target.parent;\n  }\n\n  return mat;\n}\n/**\n * Apply transform to an vertex.\n * @param {Array.<number>} target [x, y]\n * @param {Array.<number>|TypedArray.<number>|Object} transform Can be:\n *      + Transform matrix: like [1, 0, 0, 1, 0, 0]\n *      + {position, rotation, scale}, the same as `zrender/Transformable`.\n * @param {boolean=} invert Whether use invert matrix.\n * @return {Array.<number>} [x, y]\n */\n\n\nfunction applyTransform(target, transform, invert) {\n  if (transform && !zrUtil.isArrayLike(transform)) {\n    transform = Transformable.getLocalTransform(transform);\n  }\n\n  if (invert) {\n    transform = matrix.invert([], transform);\n  }\n\n  return vector.applyTransform([], target, transform);\n}\n/**\n * @param {string} direction 'left' 'right' 'top' 'bottom'\n * @param {Array.<number>} transform Transform matrix: like [1, 0, 0, 1, 0, 0]\n * @param {boolean=} invert Whether use invert matrix.\n * @return {string} Transformed direction. 'left' 'right' 'top' 'bottom'\n */\n\n\nfunction transformDirection(direction, transform, invert) {\n  // Pick a base, ensure that transform result will not be (0, 0).\n  var hBase = transform[4] === 0 || transform[5] === 0 || transform[0] === 0 ? 1 : Math.abs(2 * transform[4] / transform[0]);\n  var vBase = transform[4] === 0 || transform[5] === 0 || transform[2] === 0 ? 1 : Math.abs(2 * transform[4] / transform[2]);\n  var vertex = [direction === 'left' ? -hBase : direction === 'right' ? hBase : 0, direction === 'top' ? -vBase : direction === 'bottom' ? vBase : 0];\n  vertex = applyTransform(vertex, transform, invert);\n  return Math.abs(vertex[0]) > Math.abs(vertex[1]) ? vertex[0] > 0 ? 'right' : 'left' : vertex[1] > 0 ? 'bottom' : 'top';\n}\n/**\n * Apply group transition animation from g1 to g2.\n * If no animatableModel, no animation.\n */\n\n\nfunction groupTransition(g1, g2, animatableModel, cb) {\n  if (!g1 || !g2) {\n    return;\n  }\n\n  function getElMap(g) {\n    var elMap = {};\n    g.traverse(function (el) {\n      if (!el.isGroup && el.anid) {\n        elMap[el.anid] = el;\n      }\n    });\n    return elMap;\n  }\n\n  function getAnimatableProps(el) {\n    var obj = {\n      position: vector.clone(el.position),\n      rotation: el.rotation\n    };\n\n    if (el.shape) {\n      obj.shape = zrUtil.extend({}, el.shape);\n    }\n\n    return obj;\n  }\n\n  var elMap1 = getElMap(g1);\n  g2.traverse(function (el) {\n    if (!el.isGroup && el.anid) {\n      var oldEl = elMap1[el.anid];\n\n      if (oldEl) {\n        var newProp = getAnimatableProps(el);\n        el.attr(getAnimatableProps(oldEl));\n        updateProps(el, newProp, animatableModel, el.dataIndex);\n      } // else {\n      //     if (el.previousProps) {\n      //         graphic.updateProps\n      //     }\n      // }\n\n    }\n  });\n}\n/**\n * @param {Array.<Array.<number>>} points Like: [[23, 44], [53, 66], ...]\n * @param {Object} rect {x, y, width, height}\n * @return {Array.<Array.<number>>} A new clipped points.\n */\n\n\nfunction clipPointsByRect(points, rect) {\n  // FIXME: this way migth be incorrect when grpahic clipped by a corner.\n  // and when element have border.\n  return zrUtil.map(points, function (point) {\n    var x = point[0];\n    x = mathMax(x, rect.x);\n    x = mathMin(x, rect.x + rect.width);\n    var y = point[1];\n    y = mathMax(y, rect.y);\n    y = mathMin(y, rect.y + rect.height);\n    return [x, y];\n  });\n}\n/**\n * @param {Object} targetRect {x, y, width, height}\n * @param {Object} rect {x, y, width, height}\n * @return {Object} A new clipped rect. If rect size are negative, return undefined.\n */\n\n\nfunction clipRectByRect(targetRect, rect) {\n  var x = mathMax(targetRect.x, rect.x);\n  var x2 = mathMin(targetRect.x + targetRect.width, rect.x + rect.width);\n  var y = mathMax(targetRect.y, rect.y);\n  var y2 = mathMin(targetRect.y + targetRect.height, rect.y + rect.height); // If the total rect is cliped, nothing, including the border,\n  // should be painted. So return undefined.\n\n  if (x2 >= x && y2 >= y) {\n    return {\n      x: x,\n      y: y,\n      width: x2 - x,\n      height: y2 - y\n    };\n  }\n}\n/**\n * @param {string} iconStr Support 'image://' or 'path://' or direct svg path.\n * @param {Object} [opt] Properties of `module:zrender/Element`, except `style`.\n * @param {Object} [rect] {x, y, width, height}\n * @return {module:zrender/Element} Icon path or image element.\n */\n\n\nfunction createIcon(iconStr, opt, rect) {\n  opt = zrUtil.extend({\n    rectHover: true\n  }, opt);\n  var style = opt.style = {\n    strokeNoScale: true\n  };\n  rect = rect || {\n    x: -1,\n    y: -1,\n    width: 2,\n    height: 2\n  };\n\n  if (iconStr) {\n    return iconStr.indexOf('image://') === 0 ? (style.image = iconStr.slice(8), zrUtil.defaults(style, rect), new ZImage(opt)) : makePath(iconStr.replace('path://', ''), opt, rect, 'center');\n  }\n}\n/**\n * Return `true` if the given line (line `a`) and the given polygon\n * are intersect.\n * Note that we do not count colinear as intersect here because no\n * requirement for that. We could do that if required in future.\n *\n * @param {number} a1x\n * @param {number} a1y\n * @param {number} a2x\n * @param {number} a2y\n * @param {Array.<Array.<number>>} points Points of the polygon.\n * @return {boolean}\n */\n\n\nfunction linePolygonIntersect(a1x, a1y, a2x, a2y, points) {\n  for (var i = 0, p2 = points[points.length - 1]; i < points.length; i++) {\n    var p = points[i];\n\n    if (lineLineIntersect(a1x, a1y, a2x, a2y, p[0], p[1], p2[0], p2[1])) {\n      return true;\n    }\n\n    p2 = p;\n  }\n}\n/**\n * Return `true` if the given two lines (line `a` and line `b`)\n * are intersect.\n * Note that we do not count colinear as intersect here because no\n * requirement for that. We could do that if required in future.\n *\n * @param {number} a1x\n * @param {number} a1y\n * @param {number} a2x\n * @param {number} a2y\n * @param {number} b1x\n * @param {number} b1y\n * @param {number} b2x\n * @param {number} b2y\n * @return {boolean}\n */\n\n\nfunction lineLineIntersect(a1x, a1y, a2x, a2y, b1x, b1y, b2x, b2y) {\n  // let `vec_m` to be `vec_a2 - vec_a1` and `vec_n` to be `vec_b2 - vec_b1`.\n  var mx = a2x - a1x;\n  var my = a2y - a1y;\n  var nx = b2x - b1x;\n  var ny = b2y - b1y; // `vec_m` and `vec_n` are parallel iff\n  //     exising `k` such that `vec_m = k · vec_n`, equivalent to `vec_m X vec_n = 0`.\n\n  var nmCrossProduct = crossProduct2d(nx, ny, mx, my);\n\n  if (nearZero(nmCrossProduct)) {\n    return false;\n  } // `vec_m` and `vec_n` are intersect iff\n  //     existing `p` and `q` in [0, 1] such that `vec_a1 + p * vec_m = vec_b1 + q * vec_n`,\n  //     such that `q = ((vec_a1 - vec_b1) X vec_m) / (vec_n X vec_m)`\n  //           and `p = ((vec_a1 - vec_b1) X vec_n) / (vec_n X vec_m)`.\n\n\n  var b1a1x = a1x - b1x;\n  var b1a1y = a1y - b1y;\n  var q = crossProduct2d(b1a1x, b1a1y, mx, my) / nmCrossProduct;\n\n  if (q < 0 || q > 1) {\n    return false;\n  }\n\n  var p = crossProduct2d(b1a1x, b1a1y, nx, ny) / nmCrossProduct;\n\n  if (p < 0 || p > 1) {\n    return false;\n  }\n\n  return true;\n}\n/**\n * Cross product of 2-dimension vector.\n */\n\n\nfunction crossProduct2d(x1, y1, x2, y2) {\n  return x1 * y2 - x2 * y1;\n}\n\nfunction nearZero(val) {\n  return val <= 1e-6 && val >= -1e-6;\n} // Register built-in shapes. These shapes might be overwirtten\n// by users, although we do not recommend that.\n\n\nregisterShape('circle', Circle);\nregisterShape('sector', Sector);\nregisterShape('ring', Ring);\nregisterShape('polygon', Polygon);\nregisterShape('polyline', Polyline);\nregisterShape('rect', Rect);\nregisterShape('line', Line);\nregisterShape('bezierCurve', BezierCurve);\nregisterShape('arc', Arc);\nexports.Z2_EMPHASIS_LIFT = Z2_EMPHASIS_LIFT;\nexports.CACHED_LABEL_STYLE_PROPERTIES = CACHED_LABEL_STYLE_PROPERTIES;\nexports.extendShape = extendShape;\nexports.extendPath = extendPath;\nexports.registerShape = registerShape;\nexports.getShapeClass = getShapeClass;\nexports.makePath = makePath;\nexports.makeImage = makeImage;\nexports.mergePath = mergePath;\nexports.resizePath = resizePath;\nexports.subPixelOptimizeLine = subPixelOptimizeLine;\nexports.subPixelOptimizeRect = subPixelOptimizeRect;\nexports.subPixelOptimize = subPixelOptimize;\nexports.setElementHoverStyle = setElementHoverStyle;\nexports.setHoverStyle = setHoverStyle;\nexports.setAsHighDownDispatcher = setAsHighDownDispatcher;\nexports.isHighDownDispatcher = isHighDownDispatcher;\nexports.getHighlightDigit = getHighlightDigit;\nexports.setLabelStyle = setLabelStyle;\nexports.modifyLabelStyle = modifyLabelStyle;\nexports.setTextStyle = setTextStyle;\nexports.setText = setText;\nexports.getFont = getFont;\nexports.updateProps = updateProps;\nexports.initProps = initProps;\nexports.getTransform = getTransform;\nexports.applyTransform = applyTransform;\nexports.transformDirection = transformDirection;\nexports.groupTransition = groupTransition;\nexports.clipPointsByRect = clipPointsByRect;\nexports.clipRectByRect = clipRectByRect;\nexports.createIcon = createIcon;\nexports.linePolygonIntersect = linePolygonIntersect;\nexports.lineLineIntersect = lineLineIntersect;"]}]}